

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#265689e3">
  <meta name="author" content="Pho3n1x">
  <meta name="keywords" content="">
  
    <meta name="description" content="Vulnerability DescriptionVMware is a provider of global desktop to data center virtualization solutions, offering products including our most familiar VMware Workstation, a desktop virtual computing s">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2022-22972(VM_access_Identity_authentication_bypass)">
<meta property="og:url" content="https://pho3n1x-web.github.io/2023/09/18/CVE-2022-22972(VM_access_%20Identity_authentication_bypass)/index.html">
<meta property="og:site_name" content="Pho3n1x&#39;s Blog">
<meta property="og:description" content="Vulnerability DescriptionVMware is a provider of global desktop to data center virtualization solutions, offering products including our most familiar VMware Workstation, a desktop virtual computing s">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918151916932.png">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918152059288.png">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918155350410.png">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918162425142.png">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918162456080.png">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918162632302.png">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918163450474.png">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918163654242.png">
<meta property="og:image" content="https://pho3n1x-web.github.io/images/image-20230918165912570.png">
<meta property="article:published_time" content="2023-09-18T07:07:18.052Z">
<meta property="article:modified_time" content="2023-09-18T15:07:26.485Z">
<meta property="article:author" content="Pho3n1x">
<meta property="article:tag" content="CVE">
<meta property="article:tag" content="代码审计">
<meta property="article:tag" content="VMware">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://pho3n1x-web.github.io/images/image-20230918151916932.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>CVE-2022-22972(VM_access_Identity_authentication_bypass) - Pho3n1x&#39;s Blog</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"pho3n1x-web.github.io","root":"/","version":"1.9.5","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":"b8740508fd1301a3ac1041c71ac2d36a","google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":true}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  
    <!-- Baidu Analytics -->
    <script async>
      if (!Fluid.ctx.dnt) {
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?b8740508fd1301a3ac1041c71ac2d36a";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
      }
    </script>
  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', '');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Pho3n1x</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/1322308.jpeg') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="CVE-2022-22972(VM_access_Identity_authentication_bypass)"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-09-18 15:07" pubdate>
          September 18, 2023 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          3.4k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          15 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">CVE-2022-22972(VM_access_Identity_authentication_bypass)</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="Vulnerability-Description"><a href="#Vulnerability-Description" class="headerlink" title="Vulnerability Description"></a>Vulnerability Description</h2><p>VMware is a provider of global desktop to data center virtualization solutions, offering products including our most familiar VMware Workstation, a desktop virtual computing software. The introduction of multiple products involved in this vulnerability is as follows:</p>
<p>VMware Workspace ONE Access is an intelligent driven digital workspace platform developed by VMware company, which enables easy and secure delivery and management of any application anytime, anywhere on any device. VMware vRealize Automation is an automated deployment solution cloud management platform. VMware Cloud Foundation is a hybrid cloud platform of VMware company. The vRealize Suite Lifecycle Manager is the vRealize Suite lifecycle and content management platform.</p>
<p>On May 18th, VMware released a notice (VMSA-2022-0014) to address two vulnerabilities in multiple VMware products, including CVE-2022-22972, which has certain flaws in identity authentication processing. Remote attackers can bypass authentication by forging relevant request information, thereby gaining administrative privileges for related applications. </p>
<h2 id="Utilization-scope"><a href="#Utilization-scope" class="headerlink" title="Utilization scope"></a>Utilization scope</h2><ul>
<li>VMware Workspace ONE Access 21.08.0.1, 21.08.0.0，20.10.0.1, 20.10.0.0</li>
<li>VMware Identity Manager（vIDM） 3.3.6, 3.3.5, 3.3.4, 3.3.3</li>
<li>VMware vRealize Automation(vIDM)  7.6</li>
<li>VMware Cloud Foundation (vIDM) 4.4, 4.3.x, 4.2.x, 4.1, 4.0.x</li>
<li>VMware Cloud Foundation (vRA) 3.x</li>
<li>vRealize Suite Lifecycle Manager(vIDM) 8.x</li>
</ul>
<h2 id="Vulnerability-Analysis"><a href="#Vulnerability-Analysis" class="headerlink" title="Vulnerability Analysis"></a>Vulnerability Analysis</h2><h4 id="Environmental-construction"><a href="#Environmental-construction" class="headerlink" title="Environmental construction"></a>Environmental construction</h4><p> Starting from the official website（ <a target="_blank" rel="noopener" href="https://customerconnect.vmware.com/downloads/details?downloadGroup=WS1A_ONPREM_210801&productId=1269">https://customerconnect.vmware.com/downloads/details?downloadGroup=WS1A_ONPREM_210801&amp;productId=1269</a> ）Download VMware Workspace ONE Access 20.10.0.0 OVA file </p>
<p> Use VMware Workstation to import OVA files and configure FQDN (set the host name to a random domain name, otherwise an error will be reported when configuring the database in the future) </p>
<p><img src="/./../images/image-20230918151916932.png" srcset="/img/loading.gif" lazyload alt="image-20230918151916932"></p>
<p> After successful import, initialization will occur</p>
<p><img src="/./../images/image-20230918152059288.png" srcset="/img/loading.gif" lazyload alt="image-20230918152059288"></p>
<p> Visit https:&#x2F;&#x2F;&lt;Domain Name: 8443&gt;and follow the prompts to configure your account and database. </p>
<p><img src="/./../images/image-20230918155350410.png" srcset="/img/loading.gif" lazyload alt="image-20230918155350410"></p>
<p>Configure remote debugging </p>
<p>To build a dynamic debugging environment, it is necessary to save the relevant source code locally and enable remote debugging using IDEA</p>
<p>The required lib file is located in the&#x2F;usr&#x2F;local&#x2F;horizon&#x2F;lib&#x2F;embeddedauthadapters directory.</p>
<p><img src="/./../images/image-20230918162425142.png" srcset="/img/loading.gif" lazyload alt="image-20230918162425142"></p>
<p> Configure remote debugging for IDEA. </p>
<p><img src="/./../images/image-20230918162456080.png" srcset="/img/loading.gif" lazyload alt="image-20230918162456080"></p>
<p> Then write the remote debugging commands in the box to&#x2F;opt&#x2F;vmware&#x2F;region&#x2F;workspace&#x2F;bin&#x2F;setenv.sh </p>
<p><img src="/./../images/image-20230918162632302.png" srcset="/img/loading.gif" lazyload alt="image-20230918162632302"></p>
<h4 id="Debugging-analysis"><a href="#Debugging-analysis" class="headerlink" title="Debugging analysis"></a>Debugging analysis</h4><p> It can be found through logs that the jar package with vulnerabilities is <code>local-password-auth-adapter-0.1.jar</code></p>
<p> According to the log records, the specific login used is the com. vmware. horizon. adapters. local. LocalPasswordAuthAdapter # login function </p>
<p><img src="/./../images/image-20230918163450474.png" srcset="/img/loading.gif" lazyload alt="image-20230918163450474"></p>
<p>After obtaining account password and other information, extract the parameter endpoint through the getLocalUrl function</p>
<p>Follow up on the com.vmware.horizon.adapters.local.LocalPasswordAuthAdapter#getLocalUrl</p>
<p><img src="/./../images/image-20230918163654242.png" srcset="/img/loading.gif" lazyload alt="image-20230918163654242"></p>
<p> In the getLocalUrl function, a special HTTPS link class will be constructed for the request, and the actual concatenation result is <code>https://&#123;host&#125;:443/SAAS/API/1.0/REST/auth/local/login</code></p>
<p> Therefore, we can find that the domain name of this request can be controlled by us </p>
<p> Then we enter the subsequent authenticate function for identity authentication </p>
<p><code>com.vmware.horizon.adapters.local.LocalPasswordService#authenticate</code></p>
<p><img src="/./../images/image-20230918165912570.png" srcset="/img/loading.gif" lazyload alt="image-20230918165912570"></p>
<p> Through debugging and judging the logic of the function, we have found that as long as the return value is 200 during a post request, the account password will be considered correct and the login will be successful </p>
<p> Based on the previous analysis of the getLocalUrl function, we know that the domain name of the request can be controlled by us. Therefore, we only need to build a service and respond with a 200 status code for any request </p>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://paper.seebug.org/2031/#_1">https://paper.seebug.org/2031/#_1</a></p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/CVE/" class="category-chain-item">CVE</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/CVE/" class="print-no-link">#CVE</a>
      
        <a href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" class="print-no-link">#代码审计</a>
      
        <a href="/tags/VMware/" class="print-no-link">#VMware</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>CVE-2022-22972(VM_access_Identity_authentication_bypass)</div>
      <div>https://pho3n1x-web.github.io/2023/09/18/CVE-2022-22972(VM_access_ Identity_authentication_bypass)/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Pho3n1x</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>September 18, 2023</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              <A HREF="HTTPS://CREATIVECOMMONS.ORG/LICENSES/BY-NC-SA/4.0/">CC BY-NC-SA 4.0</A>
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/09/18/CVE-2023-41543(JeecgBoot_sql)/" title="CVE-2023-41543(JeecgBoot Sql Injection)">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">CVE-2023-41543(JeecgBoot Sql Injection)</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/09/15/CVE-2023-41542(JeecgBoot_sql)/" title="CVE-2023-41542(JeecgBoot Sql Injection)">
                        <span class="hidden-mobile">CVE-2023-41542(JeecgBoot Sql Injection)</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        Views: 
        <span id="busuanzi_value_site_pv"></span>
        
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        Visitors: 
        <span id="busuanzi_value_site_uv"></span>
        
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
